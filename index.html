<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Modern Algorithms in the Web Cryptography API</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
  <link rel="stylesheet" href="https://w3c.github.io/webcrypto/webcrypto.css" type="text/css" />
  <style>
  var.overline {
    /* We don't use text-decoration: overline because it's rendered way too high */
    text-decoration: underline;
    text-underline-offset: -1.33ex;
    text-decoration-skip-ink: none;
    text-decoration-thickness: 1px !important;
  }
  </style>
  <script class='remove'>
  "use strict";
  // See https://github.com/w3c/respec/wiki/ for how to configure ReSpec
  var respecConfig = {
    "github": "twiss/webcrypto-modern-algos",
    "editors": [
      {
        name: "Daniel Huigens",
        url: "mailto:daniel.huigens@proton.ch",
        company: "Proton AG",
        companyURL: "https://proton.me/",
      },
      {
        name: "Filip Skokan",
        url: "mailto:panva.ip@gmail.com",
        company: "Okta",
        companyURL: "https://www.okta.com/",
      },
    ],
    "shortName": "webcrypto-modern-algos",
    "specStatus": "CG-DRAFT",
    "group": "wicg",
    "xref": ["WebIDL", "webcrypto", "infra", "html"],
    localBiblio: {
      "JWA": {
        aliasOf: "RFC7518"
      },
      // TODO: move to specref?
      "FIPS-202": {
        "title": "SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions",
        "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf",
        "publisher": "NIST",
        "date": "August 2015"
      },
      // TODO: move to specref?
      "FIPS-203": {
        "title": "Module-Lattice-Based Key-Encapsulation Mechanism Standard",
        "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf",
        "publisher": "NIST",
        "date": "August 2024"
      },
      // TODO: move to specref?
      "FIPS-204": {
        "title": "Module-Lattice-Based Digital Signature Standard",
        "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf",
        "publisher": "NIST",
        "date": "August 2024"
      },
      // TODO: move to specref?
      "FIPS-205": {
        "title": "Stateless Hash-Based Digital Signature Standard",
        "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.205.pdf",
        "publisher": "NIST",
        "date": "August 2024"
      },
      // TODO: move to specref?
      "NIST-SP800-185": {
        "title": "NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash",
        "href": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf",
        "publisher": "NIST",
        "date": "December 2016"
      },
      "draft-ietf-jose-pqc-kem-01": {
        "title": "Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE",
        "href": "https://www.ietf.org/archive/id/draft-ietf-jose-pqc-kem-01.html",
        "publisher": "IETF",
        "date": "May 2025"
      },
      "draft-ietf-cose-dilithium-07": {
        "title": "ML-DSA for JOSE and COSE",
        "href": "https://www.ietf.org/archive/id/draft-ietf-cose-dilithium-07.html",
        "publisher": "IETF",
        "date": "June 2025"
      },
      "draft-ietf-cose-sphincs-plus-05": {
        "title": "SLH-DSA for JOSE and COSE",
        "href": "https://www.ietf.org/archive/id/draft-ietf-cose-sphincs-plus-05.html",
        "publisher": "IETF",
        "date": "October 2024"
      },
    },
  };
  </script>
</head>

<body>
  <section id="abstract">
    <p>
      This specification defines a number of post-quantum secure and
      modern cryptographic algorithms for the [[webcrypto | Web Cryptography API]],
      namely ML-KEM, ML-DSA, SLH-DSA, AES-OCB, ChaCha20-Poly1305,
      SHA-3, cSHAKE, KMAC, and Argon2.
    </p>
  </section>
  <section id="sotd">
    <p>
      This is an unofficial proposal.
    </p>
  </section>
  <section id="introduction" class="informative">
    <h2>Introduction</h2>
    <p>
      This proposal aims to modernize the set of cryptographic algorithms
      available in the [[webcrypto | Web Cryptography API]], such that
      web applications can make use of post-quantum secure and
      performant cryptographic algorithms.
      To this end, the following cryptographic algorithms are added:
      <ul>
        <li><a href="#ml-kem">ML-KEM</a> [[FIPS-203]]</li>
        <li><a href="#ml-dsa">ML-DSA</a> [[FIPS-204]]</li>
        <li><a href="#slh-dsa">SLH-DSA</a> [[FIPS-205]]</li>
        <li><a href="#aes-ocb">AES-OCB</a> [[RFC7253]]</li>
        <li><a href="#chacha20-poly1305">ChaCha20-Poly1305</a> [[RFC8439]]</li>
        <li><a href="#sha3">SHA3-256, SHA3-384, and SHA3-512</a> [[FIPS-202]]</li>
        <li><a href="#cshake">cSHAKE128, cSHAKE256</a>, <a href="#kmac">KMAC128 and KMAC256</a> [[NIST-SP800-185]]</li>
        <li><a href="#argon2">Argon2d, Argon2i, and Argon2id</a> [[RFC9106]]</li>
      </ul>
    </p>
    <p>
      Additionally, this proposal introduces functions for key encapsulation and decapsulation;
      <a href="#dfn-SubtleCrypto-method-encapsulateKey">`SubtleCrypto.encapsulateKey`</a>,
      <a href="#dfn-SubtleCrypto-method-encapsulateBits">`SubtleCrypto.encapsulateBits`</a>,
      <a href="#dfn-SubtleCrypto-method-decapsulateKey">`SubtleCrypto.decapsulateKey`</a> and
      <a href="#dfn-SubtleCrypto-method-decapsulateBits">`SubtleCrypto.decapsulateBits`</a>.
    </p>
    <p>
      Additionally, this proposal also introduces the <a href="#dfn-SubtleCrypto-method-getPublicKey">`SubtleCrypto.getPublicKey`</a> function,
      which provides a convenient way to derive a public key from an asymmetric private key,
      eliminating the need to store both the public and private key separately when only the private key is needed.
    </p>
    <p>
      Finally, this proposal aims to make feature detection easier,
      by adding a <a href="#dfn-SubtleCrypto-method-supports">`SubtleCrypto.supports`</a> function,
      which can be used to detect whether a given algorithm identifier
      (including any parameters) is supported for the given operation.
    </p>
  </section>
  <section id="specification-conventions">
    <h2>Specification Conventions</h3>
    <p>
      This specification follows the <a data-cite="webcrypto#algorithm-conventions">conventions</a>
      laid out in Section 18.3 of [[webcrypto]]. None of the algorithms defined here
      are required to be implemented, but if a conforming User Agent implements an
      algorithm, it MUST implement all of the supported operations specified in this
      document, and must perform the steps to <a data-cite="webcrypto#concept-define-an-algorithm">define an algorithm</a>
      specified in section 18.4.3 of [[webcrypto]] for each of the supported operations.
    </p>
  </section>

  <section id="partial-subtlecrypto-interface">
    <h2>Partial SubtleCrypto interface</h2>
    <p>
      This section extends the {{SubtleCrypto}} interface of [[webcrypto]].
    </p>
    <pre class="idl">
[SecureContext,Exposed=(Window,Worker)]
partial interface SubtleCrypto {
  Promise&lt;EncapsulatedKey> encapsulateKey(
    AlgorithmIdentifier encapsulationAlgorithm,
    CryptoKey encapsulationKey,
    AlgorithmIdentifier sharedKeyAlgorithm,
    boolean extractable,
    sequence&lt;KeyUsage> keyUsages
  );
  Promise&lt;EncapsulatedBits> encapsulateBits(
    AlgorithmIdentifier encapsulationAlgorithm,
    CryptoKey encapsulationKey
  );

  Promise&lt;CryptoKey> decapsulateKey(
    AlgorithmIdentifier decapsulationAlgorithm,
    CryptoKey decapsulationKey,
    BufferSource ciphertext,
    AlgorithmIdentifier sharedKeyAlgorithm,
    boolean extractable,
    sequence&lt;KeyUsage> keyUsages
  );
  Promise&lt;ArrayBuffer> decapsulateBits(
    AlgorithmIdentifier decapsulationAlgorithm,
    CryptoKey decapsulationKey,
    BufferSource ciphertext
  );

  Promise&lt;CryptoKey> getPublicKey(
    CryptoKey key,
    sequence&lt;KeyUsage> keyUsages
  );

  static boolean supports(DOMString operation,
                   AlgorithmIdentifier algorithm,
                   optional unsigned long? length = null);
  static boolean supports(DOMString operation,
                   AlgorithmIdentifier algorithm,
                   AlgorithmIdentifier additionalAlgorithm);
};
    </pre>

    <section id="subtlecrypto-interface-datatypes">
      <h3>Data Types</h3>
      <section id="subtlecrypto-interface-keyformat">
        <h4>Key Formats</h4>
        <p>
          This specification replaces the definition of <a data-cite="webcrypto#dfn-KeyFormat">`KeyFormat`</a>
          in [[webcrypto]] with the following:
        </p>
        <pre class="idl">
enum KeyFormat { "raw-public", "raw-private", "raw-seed", "raw-secret", "raw", "spki", "pkcs8", "jwk" };
        </pre>
        <p>
          This specification specifies a number of new <a data-cite="webcrypto#dfn-RecognizedKeyFormats">recognized key format values</a>:
        </p>
        <dl data-dfn-for=KeyFormat>
          <dt><dfn data-idl>raw-public</dfn></dt>
          <dd>An unformatted sequence of public key bytes.</dd>
          <dt><dfn data-idl>raw-private</dfn></dt>
          <dd>An unformatted sequence of private key bytes.</dd>
          <dt><dfn data-idl>raw-seed</dfn></dt>
          <dd>An unformatted sequence of private key seed bytes.</dd>
          <dt><dfn data-idl>raw-secret</dfn></dt>
          <dd>An unformatted sequence of secret key bytes.</dd>
        </dl>
        <p>
          For all existing symmetric algorithms in [[webcrypto]],
          {{KeyFormat/"raw-secret"}} acts as an alias of {{KeyFormat/"raw"}}.
        </p>
        <p>
          For all existing asymmetric algorithms in [[webcrypto]],
          {{KeyFormat/"raw-public"}} acts as an alias of {{KeyFormat/"raw"}}.
        </p>
        <p>
          In the {{SubtleCrypto/deriveKey()}} method, in the import key step,
          {{KeyFormat/"raw-secret"}} must be used as the format instead of {{KeyFormat/"raw"}}.
        </p>
      </section>
      <section id="subtlecrypto-interface-keyusage">
        <h4>Key Usages</h4>
        <p>
          This specification replaces the definition of <a data-cite="webcrypto#dfn-KeyUsage">`KeyUsage`</a>
          in [[webcrypto]] with the following:
        </p>
        <pre class="idl">
enum KeyUsage { "encrypt", "decrypt", "sign", "verify", "deriveKey", "deriveBits", "wrapKey", "unwrapKey", "encapsulateKey", "encapsulateBits", "decapsulateKey", "decapsulateBits" };
        </pre>
        <p>
          This specification specifies a number of new <a data-cite="webcrypto#dfn-RecognizedKeyUsages">recognized key usage values</a>:
        </p>
        <dl data-dfn-for=KeyUsage>
          <dt><dfn data-idl>encapsulateKey</dfn></dt>
          <dd>Enable using the key with {{SubtleCrypto.encapsulateKey}}.</dd>
          <dt><dfn data-idl>encapsulateBits</dfn></dt>
          <dd>Enable using the key with {{SubtleCrypto.encapsulateBits}}.</dd>
          <dt><dfn data-idl>decapsulateKey</dfn></dt>
          <dd>Enable using the key with {{SubtleCrypto.decapsulateKey}}.</dd>
          <dt><dfn data-idl>decapsulateBits</dfn></dt>
          <dd>Enable using the key with {{SubtleCrypto.decapsulateBits}}.</dd>
        </dl>
      </section>
    </section>

    <section id="partial-subtlecrypto-interface-methods">
      <h3>Methods and Parameters</h3>
      <section id="SubtleCrypto-method-encapsulateKey">
        <h4>The encapsulateKey method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-encapsulateKey" data-dfn-for=SubtleCrypto data-lt="encapsulateKey">encapsulateKey(|encapsulationAlgorithm|, |encapsulationKey|, |sharedKeyAlgorithm|, |extractable|, |usages|)</dfn>
          method encapsulates a key and returns an {{EncapsulatedKey}} object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let |encapsulationAlgorithm|, |encapsulationKey|, |sharedKeyAlgorithm|,
              |extractable| and |usages| be the `encapsulationAlgorithm`, `encapsulationKey`,
              `sharedKeyAlgorithm`, `extractable` and `keyUsages` parameters passed to the
              {{SubtleCrypto/encapsulateKey()}} method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let |normalizedEncapsulationAlgorithm| be the result of
              <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              `alg` set to |encapsulationAlgorithm| and `op` set to
              "`encapsulate`".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              |normalizedEncapsulationAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |normalizedSharedKeyAlgorithm| be the result of
              <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              `alg` set to |sharedKeyAlgorithm| and `op` set to
              "`importKey`".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              |normalizedSharedKeyAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |realm| be the [= relevant realm =] of [= this =].
            </p>
          </li>
          <li>
            <p>
              Let |promise| be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return |promise| and perform the remaining steps [= in parallel =].
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              [= exception/throw =] an error,
              [= queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object,
              to reject |promise| with the returned error;
              and then <a data-cite="webcrypto#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the {{Algorithm/name}} member of
              |normalizedEncapsulationAlgorithm| is not equal to the
              {{KeyAlgorithm/name}} attribute of the
              <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
              |encapsulationKey| then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |encapsulationKey| does not contain an entry that is "`encapsulateKey`",
              then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |encapsulatedBits| be the result of performing the encapsulate operation specified by
              the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
              |encapsulationKey| using |encapsulationKey|.
            </p>
          </li>
          <li>
            <p>
              Let |sharedKey| be the result of performing the import key operation specified by
              |normalizedSharedKeyAlgorithm| using {{KeyFormat/"raw-secret"}} as
              |format|, the {{EncapsulatedBits/sharedKey}} field of
              |encapsulatedBits| as |keyData|, |sharedKeyAlgorithm| as
              |algorithm| and using
              |extractable| and |usages|.
            </p>
          </li>
          <li>
            <p>
              Let |encapsulatedKey| be a new {{EncapsulatedKey}} dictionary
              with {{EncapsulatedKey/sharedKey}} set to |sharedKey|
              and {{EncapsulatedKey/ciphertext}} set to the
              {{EncapsulatedBits/ciphertext}} field of |encapsulatedBits|.
            </p>
          </li>
          <li>
            <p>
              [= Queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of converting |encapsulatedKey| to an ECMAScript Object in |realm|,
              as defined by [[WebIDL]].
            </p>
          </li>
          <li>
            <p>
              Resolve |promise| with
              |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="SubtleCrypto-method-encapsulateBits">
        <h4>The encapsulateBits method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-encapsulateBits" data-dfn-for=SubtleCrypto data-lt="encapsulateBits">encapsulateBits(|encapsulationAlgorithm|, |encapsulationKey|)</dfn>
          method encapsulates a key and returns an {{EncapsulatedBits}} object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let |encapsulationAlgorithm| and |encapsulationKey| be the `encapsulationAlgorithm`
              and `encapsulationKey` parameters passed to the
              {{SubtleCrypto/encapsulateBits()}} method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let |normalizedEncapsulationAlgorithm| be the result of
              <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              `alg` set to |encapsulationAlgorithm| and `op` set to
              "`encapsulate`".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              |normalizedEncapsulationAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |realm| be the [= relevant realm =] of [= this =].
            </p>
          </li>
          <li>
            <p>
              Let |promise| be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return |promise| and perform the remaining steps [= in parallel =].
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              [= exception/throw =] an error,
              [= queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object,
              to reject |promise| with the returned error;
              and then <a data-cite="webcrypto#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the {{Algorithm/name}} member of
              |normalizedEncapsulationAlgorithm| is not equal to the
              {{KeyAlgorithm/name}} attribute of the
              <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
              |encapsulationKey| then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |encapsulationKey| does not contain an entry that is "`encapsulateBits`",
              then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |encapsulatedBits| be the result of performing the encapsulate operation specified by
              the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
              |encapsulationKey| using |encapsulationKey|.
            </p>
          </li>
          <li>
            <p>
              [= Queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of converting |encapsulatedBits| to an ECMAScript Object in |realm|,
              as defined by [[WebIDL]].
            </p>
          </li>
          <li>
            <p>
              Resolve |promise| with
              |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="SubtleCrypto-method-decapsulateKey">
        <h4>The decapsulateKey method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-decapsulateKey" data-dfn-for=SubtleCrypto data-lt="decapsulateKey">decapsulateKey(|decapsulationAlgorithm|, |decapsulationKey|, |ciphertext|, |sharedKeyAlgorithm|, |extractable|, |usages|)</dfn>
          method decapsulates a key and returns an {{CryptoKey}} object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let |decapsulationAlgorithm|, |decapsulationKey|, |sharedKeyAlgorithm|,
              |extractable| and |usages| be the `decapsulationAlgorithm`, `decapsulationKey`, `sharedKeyAlgorithm`, `extractable` and `keyUsages` parameters passed to the
              {{SubtleCrypto/decapsulateKey()}} method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let |ciphertext| be the result of
              [= get a copy of the buffer source |
              getting a copy of the bytes held by =] the `ciphertext` parameter passed to the
              {{SubtleCrypto/decapsulateKey()}} method.
            </p>
          </li>
          <li>
            <p>
              Let |normalizedDecapsulationAlgorithm| be the result of
              <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              `alg` set to |decapsulationAlgorithm| and `op` set to
              "`decapsulate`".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              |normalizedDecapsulationAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |normalizedSharedKeyAlgorithm| be the result of
              <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              `alg` set to |sharedKeyAlgorithm| and `op` set to
              "`importKey`".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              |normalizedSharedKeyAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |realm| be the [= relevant realm =] of [= this =].
            </p>
          </li>
          <li>
            <p>
              Let |promise| be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return |promise| and perform the remaining steps [= in parallel =].
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              [= exception/throw =] an error,
              [= queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object,
              to reject |promise| with the returned error;
              and then <a data-cite="webcrypto#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the {{Algorithm/name}} member of
              |normalizedDecapsulationAlgorithm| is not equal to the
              {{KeyAlgorithm/name}} attribute of the
              <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
              |decapsulationKey| then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |decapsulationKey| does not contain an entry that is "`decapsulateKey`",
              then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |decapsulatedBits| be the result of performing the decapsulate operation specified by
              the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of |decapsulationKey| using |decapsulationKey| and |ciphertext|.
            </p>
          </li>
          <li>
            <p>
              Let |sharedKey| be the result of performing the import key operation specified by
              |normalizedSharedKeyAlgorithm| using {{KeyFormat/"raw-secret"}} as
              |format|, the |decapsulatedBits| as |keyData|, |sharedKeyAlgorithm| as
              |algorithm| and using
              |extractable| and |usages|.
            </p>
          </li>
          <li>
            <p>
              [= Queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of converting |sharedKey| to an ECMAScript Object in |realm|, as defined by [[WebIDL]].
            </p>
          </li>
          <li>
            <p>
              Resolve |promise| with
              |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="SubtleCrypto-method-decapsulateBits">
        <h4>The decapsulateBits method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-decapsulateBits" data-dfn-for=SubtleCrypto data-lt="decapsulateBits">decapsulateBits(|decapsulationAlgorithm|, |decapsulationKey|, |ciphertext|)</dfn>
          method decapsulates a key and returns an {{ArrayBuffer}} object.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let |decapsulationAlgorithm| and |decapsulationKey| be the `decapsulationAlgorithm` and `decapsulationKey` parameters passed to the
              {{SubtleCrypto/decapsulateBits()}} method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let |ciphertext| be the result of
              [= get a copy of the buffer source |
              getting a copy of the bytes held by =] the `ciphertext` parameter passed to the
              {{SubtleCrypto/decapsulateBits()}} method.
            </p>
          </li>
          <li>
            <p>
              Let |normalizedDecapsulationAlgorithm| be the result of
              <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
              `alg` set to |decapsulationAlgorithm| and `op` set to
              "`decapsulate`".
            </p>
          </li>
          <li>
            <p>
              If an error occurred, return a Promise rejected with
              |normalizedDecapsulationAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |realm| be the [= relevant realm =] of [= this =].
            </p>
          </li>
          <li>
            <p>
              Let |promise| be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return |promise| and perform the remaining steps [= in parallel =].
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              [= exception/throw =] an error,
              [= queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object,
              to reject |promise| with the returned error;
              and then <a data-cite="webcrypto#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the {{Algorithm/name}} member of
              |normalizedDecapsulationAlgorithm| is not equal to the
              {{KeyAlgorithm/name}} attribute of the
              <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
              |decapsulationKey| then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |decapsulationKey| does not contain an entry that is "`decapsulateBits`",
              then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |decapsulatedBits| be the result of performing the decapsulate operation specified by
              the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of |decapsulationKey| using |decapsulationKey| and |ciphertext|.
            </p>
          </li>
          <li>
            <p>
              [= Queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of [= ArrayBuffer/create | creating =] an {{ArrayBuffer}}
              in |realm|, containing |decapsulatedBits|.
            </p>
          </li>
          <li>
            <p>
              Resolve |promise| with
              |result|.
            </p>
          </li>
        </ol>
      </section>

      <section id="SubtleCrypto-method-getPublicKey">
        <h4>The getPublicKey method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-getPublicKey" data-dfn-for=SubtleCrypto data-lt="getPublicKey">getPublicKey(|key|, |usages|)</dfn>
          method returns the public key corresponding to a given private key.
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              Let |key| and |usages| be the `key` and `keyUsages` parameters passed to the
              {{SubtleCrypto/getPublicKey()}} method,
              respectively.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of |key|.
            </p>
          </li>
          <li>
            <p>
              If the cryptographic algorithm identified by |algorithm|
              does not support deriving a public key from a private key,
              then return a Promise rejected with a {{NotSupportedError}}.
            </p>
          </li>
          <li>
            <p>
              Let |realm| be the [= relevant realm =] of [= this =].
            </p>
          </li>
          <li>
            <p>
              Let |promise| be a new Promise.
            </p>
          </li>
          <li>
            <p>
              Return |promise| and perform the remaining steps [= in parallel =].
            </p>
          </li>
          <li>
            <p>
              If the following steps or referenced procedures say to
              [= exception/throw =] an error,
              [= queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object,
              to reject |promise| with the returned error;
              and then <a data-cite="webcrypto#terminate-the-algorithm">terminate the algorithm</a>.
            </p>
          </li>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              If |usages| contains an entry which is not supported for a public key
              by the algorithm identified by |algorithm|,
              then [= exception/throw =] a {{SyntaxError}}.
            </p>
          </li>
          <li>
            <p>
              Let |publicKey| be a new {{CryptoKey}} representing the public key corresponding to
              the private key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key|.
            </p>
          </li>
          <li>
            <p>
              If an error occurred, then [= exception/throw =] a {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |publicKey| to {{KeyType/"public"}}.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |publicKey| to {{WindowOrWorkerGlobalScope/structuredClone()}} of |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |publicKey| to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |publicKey| to |usages|.
            </p>
          </li>
          <li>
            <p>
              [= Queue a global task =] on the <a data-cite="webcrypto#dfn-crypto-task-source">crypto task source</a>,
              given |realm|'s global object, to perform the remaining steps.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of converting |publicKey| to an ECMAScript Object in |realm|, as defined by [[WebIDL]].
            </p>
          </li>
          <li>
            <p>
              Resolve |promise| with
              |result|.
            </p>
          </li>
        </ol>
      </section>

      <section id="SubtleCrypto-method-supports">
        <h4>The supports method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports" data-dfn-for=SubtleCrypto data-lt="supports">supports(|operation|, |algorithm|, |length|)</dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified {{AlgorithmIdentifier}},
          with an optional `length` parameter to indicate the number of bits to be derived when `operation` is "`deriveBits`".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If |operation| is not one of
              "`encrypt`", "`decrypt`", "`sign`", "`verify`",
              "`digest`", "`generateKey`", "`deriveKey`", "`deriveBits`",
              "`importKey`", "`exportKey`", "`wrapKey`", "`unwrapKey`",
              "`encapsulateKey`", "`encapsulateBits`",
              "`decapsulateKey`", "`decapsulateBits`" or "`getPublicKey`",
              return false.
            </p>
          </li>
          <li>
            <p>
              Return the result of [= check support for an algorithm | checking support for an algorithm =],
              with `op` set to |operation|, `alg` set to |algorithm|,
              and `length` set to |length|.
            </p>
          </li>
        </ol>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports-additionalAlgorithm" data-dfn-for=SubtleCrypto data-lt="supports!overload-1">supports(|operation|, |algorithm|, |additionalAlgorithm|)</dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified {{AlgorithmIdentifier}}.
          The additional algorithm indicates the type of key to be derived when `operation` is "`deriveKey`",
          the type of key to be exported before wrapping when `operation` is "`wrapKey`",
          and the type of key to be imported after unwrapping when `operation` is "`unwrapKey`".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If |operation| is not one of
              "`encrypt`", "`decrypt`", "`sign`", "`verify`",
              "`digest`", "`generateKey`", "`deriveKey`", "`deriveBits`",
              "`importKey`", "`exportKey`", "`wrapKey`", "`unwrapKey`",
              "`encapsulateKey`", "`encapsulateBits`",
              "`decapsulateKey`", "`decapsulateBits`" or "`getPublicKey`",
              return false.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |operation| is "`deriveKey`", "`unwrapKey`", "`encapsulateKey`" or "`decapsulateKey`":</dt>
              <dd>
                <p>
                  If the result of [= check support for an algorithm | checking support for an algorithm =]
                  with `op` set to "`importKey`"
                  and `alg` set to |additionalAlgorithm|
                  is false,
                  return false.
                </p>
              </dd>
              <dt>If |operation| is "`wrapKey`":</dt>
              <dd>
                <p>
                  If the result of [= check support for an algorithm | checking support for an algorithm =]
                  with `op` set to "`exportKey`"
                  and `alg` set to |additionalAlgorithm|
                  is false,
                  return false.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |length| be null.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |operation| is "`deriveKey`":</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the result of [= check support for an algorithm | checking support for an algorithm =]
                      with `op` set to "`get key length`"
                      and `alg` set to |additionalAlgorithm|
                      is false,
                      return false.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |normalizedAdditionalAlgorithm| be the result of
                      <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
                      `alg` set to |additionalAlgorithm| and `op` set to
                      "`get key length`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |length| be the result of performing the get key length
                      algorithm specified by |additionalAlgorithm| using
                      |normalizedAdditionalAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set |operation| to "`deriveBits`".
                    </p>
                  </li>
                </ol>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return the result of [= check support for an algorithm | checking support for an algorithm =],
              with `op` set to |operation|, `alg` set to |algorithm|,
              and `length` set to |length|.
            </p>
          </li>
        </ol>
      </section>
    </section>

    <section id="partial-subtlecrypto-interface-checking-support-for-algorithm">
      <h3>Checking support for an algorithm</h3>
      <p>
        The <dfn id="dfn-check-support-for-algorithm">check support for an algorithm</dfn> algorithm
        defines a process for checking whether the given algorithm is supported for the given operation.
        Its input is an operation name |op|, an {{AlgorithmIdentifier}} |alg|,
        and a |length| parameter. Its output is a boolean.
        It behaves as follows:
      </p>
      <ol>
        <li>
          <p>
            If |op| is "`encapsulateKey`" or "`encapsulateBits`", set |op| to "`encapsulate`".
          </p>
        </li>
        <li>
          <p>
            If |op| is "`decapsulateKey`" or "`decapsulateBits`", set |op| to "`decapsulate`".
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>If |op| is "`getPublicKey`":</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    Let |normalizedAlgorithm| be the result of
                    <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
                    `alg` set to |alg| and `op` set to "`exportKey`".
                  </p>
                </li>
                <li>
                  <p>
                    If an error occurred, return false.
                  </p>
                </li>
                <li>
                  <p>
                    If the cryptographic algorithm identified by |normalizedAlgorithm|
                    does not support deriving a public key from a private key,
                    then return false.
                  </p>
                </li>
                <li>
                  <p>
                    Otherwise, return true.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </li>
        <li>
          <p>
            Let |normalizedAlgorithm| be the result of
            <a data-cite="webcrypto#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
            `alg` set to |alg| and `op` set to |op|.
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>If an error occurred:</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    If |op| is "`wrapKey`",
                    return the result of [= check support for an algorithm | checking support for an algorithm =]
                    with `op` set to "`encrypt`"
                    and `alg` set to |alg|.
                  </p>
                </li>
                <li>
                  <p>
                    If |op| is "`unwrapKey`",
                    return the result of [= check support for an algorithm | checking support for an algorithm =]
                    with `op` set to "`decrypt`"
                    and `alg` set to |alg|.
                  </p>
                </li>
                <li>
                  <p>
                    Otherwise, return false.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </li>
        <li>
          <p>
            If the specified operation or algorithm (or one of its parameter values)
            is expected to fail (for any key and/or data) for an implementation-specific reason
            (e.g. known nonconformance to the specification), return false.
          </p>
        </li>
        <li>
          <p>
            If |op| is "`generateKey`" or "`importKey`", let |usages| be the empty list.
          </p>
        </li>
        <li>
          <p>
            For each of the steps of the operation specified by |op|
            of the algorithm specified by |normalizedAlgorithm|:
          </p>
          <dl class="switch">
            <dt>
              If the step says to [= exception/throw =] an error:
            </dt>
            <dd>
              Return false.
            </dd>
            <dt>
              If the step says to generate a key:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step relies on an unavailable parameter, such as `key`, `plaintext` or `ciphertext`:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step says to return a value:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              Otherwise:
            </dt>
            <dd>
              Execute the step.
            </dd>
          </dl>
          <p class="note">
            The steps in the referenced algorithm may access the |normalizedAlgorithm|,
            |length|, and |usages| variables from this context.
          </p>
        </li>
        <li>
          <p>
            [= Assert =]: this step is never reached,
            because one of the steps of the operation will have said
            to return a value or throw an error, causing us to return
            true or false, respectively.
          </p>
        </li>
      </ol>
    </section>
  </section>

  <section id="encapsulation">
    <h2>Encapsulation dictionaries</h2>
    <pre class=idl>
dictionary EncapsulatedKey {
  CryptoKey sharedKey;
  ArrayBuffer ciphertext;
};

dictionary EncapsulatedBits {
  ArrayBuffer sharedKey;
  ArrayBuffer ciphertext;
};
    </pre>
    <p>
      The <dfn data-idl id="dfn-EncapsulatedKey">EncapsulatedKey</dfn> dictionary represents an
      encapsulated key comprised of a <dfn data-idl data-dfn-for=EncapsulatedKey id="dfn-EncapsulatedKey-sharedKey">sharedKey</dfn> and a <dfn data-idl data-dfn-for=EncapsulatedKey id="dfn-EncapsulatedKey-ciphertext">ciphertext</dfn>.
    </p>
    <p>
      The <dfn data-idl id="dfn-EncapsulatedBits">EncapsulatedBits</dfn> dictionary represents
      encapsulated key bits comprised of a <dfn data-idl data-dfn-for=EncapsulatedBits id="dfn-EncapsulatedBits-sharedKey">sharedKey</dfn> and a <dfn data-idl data-dfn-for=EncapsulatedBits id="dfn-EncapsulatedBits-ciphertext">ciphertext</dfn>.
    </p>
  </section>

  <section id="JsonWebKey-dictionary">
    <h2>JsonWebKey dictionary</h2>
    <pre class=idl>
dictionary JsonWebKey {
  // The following fields are defined in Section 3.1 of JSON Web Key
  DOMString kty;
  DOMString use;
  sequence&lt;DOMString> key_ops;
  DOMString alg;

  // The following fields are defined in JSON Web Key Parameters Registration
  boolean ext;

  // The following fields are defined in draft-ietf-cose-dilithium-07
  DOMString pub;
  DOMString priv;
};
    </pre>
    <p>
      This version of the <dfn data-idl id="dfn-JsonWebKey">JsonWebKey</dfn> dictionary
      provides a way to represent keys with the "AKP" key type defined in [[draft-ietf-cose-dilithium-07]].
      It may be merged into the definition of <a data-cite="webcrypto#dfn-JsonWebKey">`JsonWebKey`</a> in [[webcrypto]]
      by adding the {{JsonWebKey/pub}} and {{JsonWebKey/priv}} fields there.
    </p>
  </section>

  <section id="ml-kem">
    <h3>ML-KEM</h3>
    <section id="ml-kem-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes using ML-KEM for key encapsulation and decapsulation,
        as specified by [[FIPS-203]].
      </p>
    </section>
    <section id="ml-kem-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> for
        this algorithm are "`ML-KEM-512`", "`ML-KEM-768`" and "`ML-KEM-1024`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encapsulate</td>
            <td>None</td>
            <td>{{EncapsulatedBits}}</td>
          </tr>
          <tr>
            <td>decapsulate</td>
            <td>None</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td>{{CryptoKey}}</td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="ml-kem-operations">
      <h4>Operations</h4>
      <section id="ml-kem-operations-encapsulate">
        <h5>Encapsulate</h5>
        <ol>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"public"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Perform the encapsulation key check described in
              Section 7.2 of [[FIPS-203]] with the parameter set
              indicated by the {{Algorithm/name}} member of |algorithm|,
              using the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the <var class="overline">ek</var> input parameter.
            </p>
            <div class=note>
              <p>
                The result of this check may be cached or precomputed
                for the {{CryptoKey}} object if desirable for performance.
              </p>
            </div>
          </li>
          <li>
            <p>
              If the encapsulation key check failed, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |sharedKey| and |ciphertext| be the outputs that result
              from performing the ML-KEM.Encaps function described in
              Section 7.2 of [[FIPS-203]] with the parameter set
              indicated by the {{Algorithm/name}} member of |algorithm|,
              using the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the |ek| input parameter.
            </p>
          </li>
          <li>
            <p>
              If the ML-KEM.Encaps function returned an error, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |result| be a new {{EncapsulatedBits}}
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the {{EncapsulatedBits/sharedKey}} attribute
              of |result| to the result of [= ArrayBuffer/create | creating =]
              an {{ArrayBuffer}} containing |sharedKey|.
            </p>
          </li>
          <li>
            <p>
              Set the {{EncapsulatedBits/ciphertext}} attribute
              of |result| to the result of [= ArrayBuffer/create | creating =]
              an {{ArrayBuffer}} containing |ciphertext|.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-decapsulate">
        <h5>Decapsulate</h5>
        <ol>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Perform the decapsulation input check described in
              Section 7.3 of [[FIPS-203]] with the parameter set
              indicated by the {{Algorithm/name}} member of |algorithm|,
              using the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the <var class="overline">dk</var> input parameter, and
              |ciphertext| as the <var class="overline">c</var> input parameter.
            </p>
            <div class=note>
              <p>
                The result of the decapsulation key type check and the hash check
                may be cached or precomputed for the {{CryptoKey}} object
                if desirable for performance.
              </p>
            </div>
          </li>
          <li>
            <p>
              If the decapsulation key check failed, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |sharedKey| be the output that results
              from performing the ML-KEM.Decaps function described in
              Section 7.3 of [[FIPS-203]] with the parameter set
              indicated by the {{Algorithm/name}} member of |algorithm|,
              using the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the |dk| input parameter, and
              |ciphertext| as the |c| input parameter.
            </p>
          </li>
          <li>
            <p>
              Return |sharedKey|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-generate-key">
        <h5>Generate Key</h5>
        <ol>
          <li>
            <p>
              If |usages| contains any entry which is not
              one of "`encapsulateKey`", "`encapsulateBits`",
              "`decapsulateKey`" or "`decapsulateBits`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>

          <li>
            <p>
              Generate an ML-KEM key pair, as described in
              Section 7.1 of [[FIPS-203]], with the parameter set
              indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|.
            </p>
            <div class=note>
              <p>
                In order to be able to export the seed `(d, z)`,
                `d` and `z` need to be stored as part of the generated
                key material.
              </p>
            </div>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new {{KeyAlgorithm}} object.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to the {{Algorithm/name}} attribute of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |publicKey| be a new {{CryptoKey}}
              representing the encapsulation key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |publicKey| to "`public`".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |publicKey| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |publicKey| to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |publicKey| to be the
              <a data-cite="webcrypto#concept-usage-intersection">usage intersection</a> of
              |usages| and `[ "encapsulateKey", "encapsulateBits" ]`.
            </p>
          </li>
          <li>
            <p>
              Let |privateKey| be a new {{CryptoKey}}
              representing the decapsulation key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |privateKey| to {{KeyType/"private"}}.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |privateKey| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |privateKey| to |extractable|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |privateKey| to be the
              <a data-cite="webcrypto#concept-usage-intersection">usage intersection</a> of
              |usages| and `[ "decapsulateKey", "decapsulateBits" ]`.
            </p>
          </li>
          <li>
            <p>
              Let |result| be a new {{CryptoKeyPair}}
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the {{CryptoKeyPair/publicKey}} attribute
              of |result| to be |publicKey|.
            </p>
          </li>
          <li>
            <p>
              Set the {{CryptoKeyPair/privateKey}} attribute
              of |result| to be |privateKey|.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-import-key">
        <h5>Import Key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <li>
                      <p>
                        If |usages| contains an entry which is not
                        "`encapsulateKey`" or "`encapsulateBits`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                  <li>
                    <p>
                      Let |spki| be the result of running the
                      <a data-cite="webcrypto#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                      algorithm over |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-KEM-512`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-alg-ml-kem-512` (2.16.840.1.101.3.4.4.1).
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-KEM-768`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-alg-ml-kem-768` (2.16.840.1.101.3.4.4.2).
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-KEM-1024`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-alg-ml-kem-1024` (2.16.840.1.101.3.4.4.3).
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          [= exception/throw =] a {{NotSupportedError}}.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the `algorithm` object identifier field of the
                      `algorithm` AlgorithmIdentifier field of |spki| is
                      not equal to |expectedOid|,
                      then [= exception/throw =] a {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the `parameters` field of the `algorithm`
                      AlgorithmIdentifier field of |spki| is present,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |publicKey| be the ML-KEM public key identified by
                      the `subjectPublicKey` field of |spki|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents |publicKey|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to "`public`"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
                      slot of |key| to |extractable|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
                      |key| to |usages|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <li>
                      <p>
                        If |usages| contains an entry which is not
                        "`encapsulateKey`" or "`encapsulateBits`"
                        then [= exception/throw =] a
                        {{SyntaxError}}.
                      </p>
                    </li>
                  <li>
                    <p>
                      Let |privateKeyInfo| be the result of running the
                      <a data-cite="webcrypto#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                      algorithm over |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurs while parsing,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-KEM-512`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-alg-ml-kem-512` (2.16.840.1.101.3.4.4.1).
                        </p>
                        <p>
                          Let |asn1Structure| be the ASN.1 `ML-KEM-512-PrivateKey` structure.
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-KEM-768`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-alg-ml-kem-768` (2.16.840.1.101.3.4.4.2).
                        </p>
                        <p>
                          Let |asn1Structure| be the ASN.1 `ML-KEM-768-PrivateKey` structure.
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-KEM-1024`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-alg-ml-kem-1024` (2.16.840.1.101.3.4.4.3).
                        </p>
                        <p>
                          Let |asn1Structure| be the ASN.1 `ML-KEM-1024-PrivateKey` structure.
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          [= exception/throw =] a {{NotSupportedError}}.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the `algorithm` object identifier field of the
                      `privateKeyAlgorithm` PrivateKeyAlgorithm field of
                      |privateKeyInfo| is not equal to |expectedOid|,
                      then [= exception/throw =] a {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the `parameters` field of the
                      `privateKeyAlgorithm` PrivateKeyAlgorithmIdentifier field
                      of |privateKeyInfo| is present,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |mlKemPrivateKey| be the result of performing the
                      <a data-cite="webcrypto#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                      algorithm, with |data| as the `privateKey` field
                      of |privateKeyInfo|, |structure| as |asn1Structure|, and |exactData| set to true.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents the ML-KEM private key identified by |mlKemPrivateKey|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to {{KeyType/"private"}}
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
                      slot of |key| to |extractable|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
                      |key| to |usages|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-public"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains an entry which is not
                      "`encapsulateKey`" or "`encapsulateBits`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents the ML-KEM public key data in |data|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to {{KeyType/"public"}}
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-seed"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains an entry which is not
                      "`decapsulateKey`" or "`decapsulateBits`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of |data| is not 512
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |privateKey| be the result of performing the
                      ML-KEM.KeyGen_internal function described in
                      Section 6.1 of [[FIPS-203]] with the parameter set
                      indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
                      using the first 256 bits of |data| as |d| and
                      the last 256 bits of |data| as |z|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents the ML-KEM private key identified by |privateKey|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to {{KeyType/"private"}}
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                      <dd><p>Let |jwk| equal |keyData|.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/priv}} field of |jwk| is present
                      and if |usages| contains an entry which is not
                      "`decapsulateKey`" or "`decapsulateBits`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/priv}} field of |jwk| is not present
                      and if |usages| contains an entry which is not
                      "`encapsulateKey`" or "`encapsulateBits`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/kty}} field of |jwk| is not
                      "`AKP`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/alg}} field of |jwk| is not
                      one of the `alg` values corresponding to the
                      {{Algorithm/name}} member of |normalizedAlgorithm|
                      indicated in Section 8 of [[draft-ietf-jose-pqc-kem-01]]
                      (Figure 1 or 2), then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                    <p class="example">
                      For example, `MLKEM512` and `MLKEM512+A128KW`
                      are valid "alg" values for ML-KEM-512.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present
                      and is not equal to "`enc`", then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                      is invalid according to the requirements of JSON Web
                      Key [[JWK]], or it does not contain all of the specified |usages|
                      values,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/ext}} field of |jwk| is present and
                      has the value false and |extractable| is true,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{JsonWebKey/priv}} field of |jwk| is present:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the {{JsonWebKey/priv}} attribute of |jwk|
                              does not contain a valid base64url encoded seed
                              representing an ML-KEM private key,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let |key| be a new {{CryptoKey}} object that represents the
                              ML-KEM private key identified by interpreting the
                              {{JsonWebKey/priv}} attribute of |jwk|
                              as a base64url encoded seed.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a>
                              internal slot of |Key| to {{KeyType/"private"}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              If the {{JsonWebKey/pub}} attribute of |jwk|
                              does not contain the base64url encoded public key
                              representing the ML-KEM public key
                              corresponding to |key|,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                        </ol>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the {{JsonWebKey/pub}} attribute of |jwk|
                              does not contain a valid base64url encoded public key
                              representing an ML-KEM public key,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let |key| be a new {{CryptoKey}} object that represents the
                              ML-KEM public key identified by interpreting the
                              {{JsonWebKey/pub}} attribute of |jwk|
                              as a base64url encoded public key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a>
                              internal slot of |Key| to {{KeyType/"public"}}.
                            </p>
                          </li>
                        </ol>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} member of |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                [= exception/throw =] a
                {{NotSupportedError}}.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-kem-operations-export-key">
        <h5>Export Key</h5>
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              cannot be accessed, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-public"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing
                      the raw octets of the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-seed"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| is not "`private`", then [= exception/throw =] an {{InvalidAccessError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing the concatenation of the |d| and |z|
                      seed variables of the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                      internal slot of |key|.
                    </p>
                    <div class=note>
                      <p>
                        The |d| and |z| seed variables were sampled in the ML-KEM.KeyGen function
                        as described in Section 7.1 of [[FIPS-203]].
                      </p>
                    </div>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |jwk| be a new {{JsonWebKey}}
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `kty` attribute of |jwk| to
                      "`AKP`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `alg` attribute of |jwk| to
                      the `alg` value corresponding to the
                      {{Algorithm/name}} member of |normalizedAlgorithm|
                      indicated in Section 8 of [[draft-ietf-jose-pqc-kem-01]]
                      (Figure 1).
                    </p>
                    <p class="example">
                      For example, `MLKEM512` is the "alg" value
                      used for ML-KEM-512.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{JsonWebKey/pub}} attribute of |jwk|
                      to the base64url encoded public key corresponding
                      to the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                      internal slot of |key|.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                        of |key| is {{KeyType/"private"}}:
                      </dt>
                      <dd>
                        Set the {{JsonWebKey/priv}} attribute of |jwk|
                        to the base64url encoded seed represented by
                        the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                        internal slot of |key|.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `ext` attribute of |jwk| to the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot
                      of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |jwk|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="ml-dsa">
    <h3>ML-DSA</h3>
    <section id="ml-dsa-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes using ML-DSA for signing and verification,
        as specified by [[FIPS-204]].
      </p>
    </section>
    <section id="ml-dsa-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> for
        this algorithm are "`ML-DSA-44`", "`ML-DSA-65`" and "`ML-DSA-87`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>{{ContextParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>verify</td>
            <td>{{ContextParams}}</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="context-params">
      <h4><dfn data-idl id="dfn-ContextParams">ContextParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary ContextParams : Algorithm {
  BufferSource context;
};
      </pre>
      <p>The <dfn data-idl data-dfn-for=ContextParams id="dfn-ContextParams-context">context</dfn> member represents the optional context data to associate with the message.</p>
    </section>
    <section id="ml-dsa-operations">
      <h4>Operations</h4>
      <section id="ml-dsa-operations-sign">
        <h5>Sign</h5>
        <ol>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |context| be the {{ContextParams/context}} member of |normalizedAlgorithm|
              or the empty octet string if the {{ContextParams/context}} member of
              |normalizedAlgorithm| is not present.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of performing the ML-DSA.Sign
              signing algorithm, as specified in Section 5.2 of [[FIPS-204]],
              with the parameter set indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
              using the ML-DSA private key associated with |key| as |sk|,
              |message| as |M| and |context| as |ctx|.
            </p>
          </li>
          <li>
            <p>
              If the ML-DSA.Sign algorithm returned an error, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-verify">
        <h5>Verify</h5>
        <ol>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"public"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |context| be the {{ContextParams/context}} member of |normalizedAlgorithm|
              or the empty octet string if the {{ContextParams/context}} member of
              |normalizedAlgorithm| is not present.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of performing the ML-DSA.Verify
              verification algorithm, as specified in Section 5.3 of [[FIPS-204]],
              with the parameter set indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
              using the ML-DSA public key associated with |key| as |pk|,
              |message| as |M|, |signature| as <var></var> and |context| as |ctx|.
            </p>
          </li>
          <li>
            <p>
              If the ML-DSA.Verify algorithm returned an error, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-generate-key">
        <h5>Generate Key</h5>
        <ol>
          <li>
            <p>
              If |usages| contains a value which is not
              one of "`sign`" or "`verify`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <p>
              Generate an ML-DSA key pair, as described in
              Section 5.1 of [[FIPS-204]], with the parameter set
              indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|.
            </p>
            <div class=note>
              <p>
                In order to be able to export the seed ``,
                it needs to be stored as part of the generated
                key material.
              </p>
            </div>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new {{KeyAlgorithm}} object.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to the {{Algorithm/name}} attribute of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |publicKey| be a new {{CryptoKey}}
              representing the public key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |publicKey| to "`public`".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |publicKey| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |publicKey| to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |publicKey| to be the <a data-cite="webcrypto#concept-usage-intersection">usage intersection</a>
              of |usages| and `[ "verify" ]`.
            </p>
          </li>
          <li>
            <p>
              Let |privateKey| be a new {{CryptoKey}}
              representing the private key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |privateKey| to {{KeyType/"private"}}.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |privateKey| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |privateKey| to |extractable|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |privateKey| to be the <a data-cite="webcrypto#concept-usage-intersection">usage intersection</a>
              of |usages| and `[ "sign" ]`.
            </p>
          </li>
          <li>
            <p>
              Let |result| be a new {{CryptoKeyPair}}
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the {{CryptoKeyPair/publicKey}} attribute
              of |result| to be |publicKey|.
            </p>
          </li>
          <li>
            <p>
              Set the {{CryptoKeyPair/privateKey}} attribute
              of |result| to be |privateKey|.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-import-key">
        <h5>Import Key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"spki"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains a value which is not
                      "`verify`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |spki| be the result of running the
                      <a data-cite="webcrypto#concept-parse-a-spki">parse a subjectPublicKeyInfo</a>
                      algorithm over |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-DSA-44`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-ml-dsa-44` (2.16.840.1.101.3.4.3.17).
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-DSA-65`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-ml-dsa-65` (2.16.840.1.101.3.4.3.18).
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-DSA-87`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-ml-dsa-87` (2.16.840.1.101.3.4.3.19).
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          [= exception/throw =] a {{NotSupportedError}}.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the `algorithm` object identifier field of the
                      `algorithm` AlgorithmIdentifier field of |spki| is
                      not equal to |expectedOid|,
                      then [= exception/throw =] a {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the `parameters` field of the `algorithm`
                      AlgorithmIdentifier field of |spki| is present,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |publicKey| be the ML-DSA public key identified by
                      the `subjectPublicKey` field of |spki|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents |publicKey|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to "`public`"
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
                      slot of |key| to |extractable|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
                      |key| to |usages|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"pkcs8"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains a value which is not
                      "`sign`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |privateKeyInfo| be the result of running the
                      <a data-cite="webcrypto#concept-parse-a-privateKeyInfo">parse a privateKeyInfo</a>
                      algorithm over |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurs while parsing,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-DSA-44`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-ml-dsa-44` (2.16.840.1.101.3.4.3.17).
                        </p>
                        <p>
                          Let |asn1Structure| be the ASN.1 `ML-DSA-44-PrivateKey` structure.
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-DSA-65`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-ml-dsa-65` (2.16.840.1.101.3.4.3.18).
                        </p>
                        <p>
                          Let |asn1Structure| be the ASN.1 `ML-DSA-65-PrivateKey` structure.
                        </p>
                      </dd>
                      <dt>If the {{Algorithm/name}} member of |normalizedAlgorithm| is "`ML-DSA-87`":</dt>
                      <dd>
                        <p>
                          Let |expectedOid| be `id-ml-dsa-87` (2.16.840.1.101.3.4.3.19).
                        </p>
                        <p>
                          Let |asn1Structure| be the ASN.1 `ML-DSA-87-PrivateKey` structure.
                        </p>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <p>
                          [= exception/throw =] a {{NotSupportedError}}.
                        </p>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the `algorithm` object identifier field of the
                      `privateKeyAlgorithm` PrivateKeyAlgorithm field of
                      |privateKeyInfo| is not equal to |expectedOid|,
                      then [= exception/throw =] a {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the `parameters` field of the
                      `privateKeyAlgorithm` PrivateKeyAlgorithmIdentifier field
                      of |privateKeyInfo| is present,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |mlDsaPrivateKey| be the result of performing the
                      <a data-cite="webcrypto#concept-parse-an-asn1-structure">parse an ASN.1 structure</a>
                      algorithm, with |data| as the `privateKey` field
                      of |privateKeyInfo|, |structure| as |asn1Structure|, and |exactData| set to true.
                    </p>
                  </li>
                  <li>
                    <p>
                      If an error occurred while parsing,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents the ML-DSA private key identified by |mlDsaPrivateKey|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to {{KeyType/"private"}}
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
                      slot of |key| to |extractable|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
                      |key| to |usages|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-public"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains a value which is not
                      "`verify`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}} object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      representing the key data provided in |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to "`public`"
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-seed"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains an entry which is not
                      "`sign`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of |data| is not 256
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |privateKey| be the result of performing the
                      ML-DSA.KeyGen_internal function described in
                      Section 6.1 of [[FIPS-204]] with the parameter set
                      indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
                      using |data| as <var></var>.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      that represents the ML-DSA private key identified by |privateKey|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to {{KeyType/"private"}}
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                      <dd><p>Let |jwk| equal |keyData|.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/priv}} field is present
                      and |usages| contains a value which is not
                      "`sign`", or,
                      if the {{JsonWebKey/priv}} field is not present
                      and |usages| contains a value which is not
                      "`verify`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/kty}} field of |jwk| is not
                      "`AKP`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/alg}} field of |jwk| is not equal to
                      the {{Algorithm/name}} member of |normalizedAlgorithm|,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present
                      and is not equal to "`sig`", then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                      is invalid according to the requirements of JSON Web
                      Key [[JWK]], or it does not contain all of the specified |usages|
                      values,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/ext}} field of |jwk| is present and
                      has the value false and |extractable| is true,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{JsonWebKey/priv}} field of |jwk| is present:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the {{JsonWebKey/priv}} attribute of |jwk|
                              does not contain a valid base64url encoded seed
                              representing an ML-DSA private key,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let |key| be a new {{CryptoKey}} object that represents the
                              ML-DSA private key identified by interpreting the
                              {{JsonWebKey/priv}} attribute of |jwk|
                              as a base64url encoded seed.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a>
                              internal slot of |Key| to {{KeyType/"private"}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              If the {{JsonWebKey/pub}} attribute of |jwk|
                              does not contain the base64url encoded public key
                              representing the ML-DSA public key
                              corresponding to |key|,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                        </ol>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the {{JsonWebKey/pub}} attribute of |jwk|
                              does not contain a valid base64url encoded public key
                              representing an ML-DSA public key,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let |key| be a new {{CryptoKey}} object that represents the
                              ML-DSA public key identified by interpreting the
                              {{JsonWebKey/pub}} attribute of |jwk|
                              as a base64url encoded public key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a>
                              internal slot of |Key| to {{KeyType/"public"}}.
                            </p>
                          </li>
                        </ol>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} member of |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |key|
            </p>
          </li>
        </ol>
      </section>
      <section id="ml-dsa-operations-export-key">
        <h5>Export Key</h5>
        <ol>
          <li>
            <p>
              Let |key| be the {{CryptoKey}} to be
              exported.
            </p>
          </li>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              cannot be accessed, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If |format| is {{KeyFormat/"raw-public"}}:
              </dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing the ML-DSA
                      public key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-seed"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| is not "`private`", then [= exception/throw =] an {{InvalidAccessError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing the <var></var> seed variable
                      of the key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                      internal slot of |key|.
                    </p>
                    <div class=note>
                      <p>
                        The <var></var> seed variable was sampled in the ML-DSA.KeyGen function
                        as described in Section 5.1 of [[FIPS-204]].
                      </p>
                    </div>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |jwk| be a new {{JsonWebKey}}
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `kty` attribute of |jwk| to
                      "`AKP`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `alg` attribute of |jwk| to
                      the {{Algorithm/name}} member of |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{JsonWebKey/pub}} attribute of |jwk|
                      to the base64url encoded public key corresponding
                      to the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                      internal slot of |key|.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                        of |key| is {{KeyType/"private"}}:
                      </dt>
                      <dd>
                        Set the {{JsonWebKey/priv}} attribute of |jwk|
                        to the base64url encoded seed represented by
                        the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                        internal slot of |key|.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `ext` attribute of |jwk| to the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot
                      of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |jwk|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="slh-dsa">
    <h3>SLH-DSA</h3>
    <section id="slh-dsa-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes using SLH-DSA for signing and verification,
        as specified by [[FIPS-205]].
      </p>
    </section>
    <section id="slh-dsa-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> for
        this algorithm are "`SLH-DSA-SHA2-128s`", "`SLH-DSA-SHAKE-128s`",
        "`SLH-DSA-SHA2-128f`", "`SLH-DSA-SHAKE-128f`",
        "`SLH-DSA-SHA2-192s`", "`SLH-DSA-SHAKE-192s`",
        "`SLH-DSA-SHA2-192f`", "`SLH-DSA-SHAKE-192f`",
        "`SLH-DSA-SHA2-256s`", "`SLH-DSA-SHAKE-256s`",
        "`SLH-DSA-SHA2-256f`" and "`SLH-DSA-SHAKE-256f`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>{{ContextParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>verify</td>
            <td>{{ContextParams}}</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKeyPair}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="slh-dsa-operations">
      <h4>Operations</h4>
      <section id="slh-dsa-operations-sign">
        <h5>Sign</h5>
        <ol>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"private"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |context| be the {{ContextParams/context}} member of |normalizedAlgorithm|
              or the empty octet string if the {{ContextParams/context}} member of
              |normalizedAlgorithm| is not present.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of performing the `slh_sign`
              signing algorithm, as specified in Section 10.2.1 of [[FIPS-205]],
              with the parameter set indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
              using the SLH-DSA private key associated with |key| as |SK|,
              |message| as |M| and |context| as |ctx|.
            </p>
          </li>
          <li>
            <p>
              If the `slh_sign` algorithm returned an error, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-verify">
        <h5>Verify</h5>
        <ol>
          <li>
            <p>
              If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| is not {{KeyType/"public"}}, then [= exception/throw =] an {{InvalidAccessError}}.
            </p>
          </li>
          <li>
            <p>
              Let |context| be the {{ContextParams/context}} member of |normalizedAlgorithm|
              or the empty octet string if the {{ContextParams/context}} member of
              |normalizedAlgorithm| is not present.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of performing the `slh_verify`
              verification algorithm, as specified in Section 10.3 of [[FIPS-205]],
              with the parameter set indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
              using the SLH-DSA public key associated with |key| as |PK|,
              |message| as |M|, |signature| as |SIG| and |context| as |ctx|.
            </p>
          </li>
          <li>
            <p>
              If the `slh_verify` algorithm returned an error, return an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-generate-key">
        <h5>Generate Key</h5>
        <ol>
          <li>
            <p>
              If |usages| contains a value which is not
              one of "`sign`" or "`verify`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <p>
              Generate an SLH-DSA key pair, as described in
              Section 10.1 of [[FIPS-205]], with the parameter set
              indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new {{KeyAlgorithm}} object.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to the {{Algorithm/name}} attribute of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |publicKey| be a new {{CryptoKey}}
              representing the public key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |publicKey| to "`public`".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |publicKey| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |publicKey| to true.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |publicKey| to be the <a data-cite="webcrypto#concept-usage-intersection">usage intersection</a>
              of |usages| and `[ "verify" ]`.
            </p>
          </li>
          <li>
            <p>
              Let |privateKey| be a new {{CryptoKey}}
              representing the private key of the generated key pair.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |privateKey| to {{KeyType/"private"}}.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |privateKey| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |privateKey| to |extractable|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |privateKey| to be the <a data-cite="webcrypto#concept-usage-intersection">usage intersection</a>
              of |usages| and `[ "sign" ]`.
            </p>
          </li>
          <li>
            <p>
              Let |result| be a new {{CryptoKeyPair}}
              dictionary.
            </p>
          </li>
          <li>
            <p>
              Set the {{CryptoKeyPair/publicKey}} attribute
              of |result| to be |publicKey|.
            </p>
          </li>
          <li>
            <p>
              Set the {{CryptoKeyPair/privateKey}} attribute
              of |result| to be |privateKey|.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-import-key">
        <h5>Import Key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-public"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains a value which is not
                      "`verify`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}} object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the [= byte sequence/length =] of |keyData| is not the `pk length`
                      specified by Table 2 of [[FIPS-205]]
                      for the parameter set indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      representing the key data provided in |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to "`public`"
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-private"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If |usages| contains an entry which is not
                      "`sign`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the [= byte sequence/length =] of |keyData| is not 2 * the `pk length`
                      specified by Table 2 of [[FIPS-205]]
                      for the parameter set indicated by the {{Algorithm/name}} member of |normalizedAlgorithm|,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |key| be a new {{CryptoKey}}
                      representing the key data provided in |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| to {{KeyType/"private"}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new {{KeyAlgorithm}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} attribute of
                      |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                      <dd><p>Let |jwk| equal |keyData|.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/priv}} field is present
                      and |usages| contains a value which is not
                      "`sign`", or,
                      if the {{JsonWebKey/priv}} field is not present
                      and |usages| contains a value which is not
                      "`verify`"
                      then [= exception/throw =] a
                      {{SyntaxError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/kty}} field of |jwk| is not
                      "`AKP`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/alg}} field of |jwk| is not equal to
                      the {{Algorithm/name}} member of |normalizedAlgorithm|,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present
                      and is not equal to "`sig`", then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                      is invalid according to the requirements of JSON Web
                      Key [[JWK]], or it does not contain all of the specified |usages|
                      values,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/ext}} field of |jwk| is present and
                      has the value false and |extractable| is true,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{JsonWebKey/priv}} field of |jwk| is present:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the {{JsonWebKey/priv}} attribute of |jwk|
                              does not contain a valid base64url encoded value
                              representing an SLH-DSA private key,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let |key| be a new {{CryptoKey}} object that represents the
                              SLH-DSA private key identified by interpreting the
                              {{JsonWebKey/priv}} attribute of |jwk|
                              as a base64url encoded private key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a>
                              internal slot of |Key| to {{KeyType/"private"}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              If the {{JsonWebKey/pub}} attribute of |jwk|
                              does not contain the base64url encoded public key
                              representing the SLH-DSA public key
                              corresponding to |key|,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                        </ol>
                      </dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        <ol>
                          <li>
                            <p>
                              If the {{JsonWebKey/pub}} attribute of |jwk|
                              does not contain a valid base64url encoded public key
                              representing an SLH-DSA public key,
                              then [= exception/throw =] a {{DataError}}.
                            </p>
                          </li>
                          <li>
                            <p>
                              Let |key| be a new {{CryptoKey}} object that represents the
                              SLH-DSA public key identified by interpreting the
                              {{JsonWebKey/pub}} attribute of |jwk|
                              as a base64url encoded public key.
                            </p>
                          </li>
                          <li>
                            <p>
                              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a>
                              internal slot of |Key| to {{KeyType/"public"}}.
                            </p>
                          </li>
                        </ol>
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be a new instance of a {{KeyAlgorithm}} object.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{KeyAlgorithm/name}} attribute of
                      |algorithm| to the {{Algorithm/name}} member of |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a>
                      internal slot of |key| to |algorithm|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |key|
            </p>
          </li>
        </ol>
      </section>
      <section id="slh-dsa-operations-export-key">
        <h5>Export Key</h5>
        <ol>
          <li>
            <p>
              Let |key| be the {{CryptoKey}} to be
              exported.
            </p>
          </li>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              cannot be accessed, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If |format| is {{KeyFormat/"raw-public"}}:
              </dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| is not "`public`", then [= exception/throw =] an {{InvalidAccessError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing the SLH-DSA
                      public key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"raw-private"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                      of |key| is not "`private`", then [= exception/throw =] an {{InvalidAccessError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing the SLH-DSA
                      private key represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |jwk| be a new {{JsonWebKey}}
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `kty` attribute of |jwk| to
                      "`AKP`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `alg` attribute of |jwk| to
                      the {{Algorithm/name}} member of |normalizedAlgorithm|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{JsonWebKey/pub}} attribute of |jwk|
                      to the base64url encoded public key corresponding
                      to the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                      internal slot of |key|.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot
                        of |key| is {{KeyType/"private"}}:
                      </dt>
                      <dd>
                        Set the {{JsonWebKey/priv}} attribute of |jwk|
                        to the base64url encoded private key represented by
                        the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                        internal slot of |key|.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the `key_ops` attribute of |jwk| to the {{CryptoKey/usages}} attribute of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `ext` attribute of |jwk| to the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot
                      of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |jwk|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="aes-ocb">
    <h3>AES-OCB</h3>
    <section id="aes-ocb-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`AES-OCB`" algorithm identifier is used to perform
        authenticated encryption and decryption using AES in OCB mode,
        as described in [[RFC7253]].
      </p>
    </section>
    <section id="aes-ocb-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "`AES-OCB`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td>{{AeadParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td>{{AeadParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>{{AesKeyGenParams}}</td>
            <td>{{CryptoKey}}</td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td>{{CryptoKey}}</td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td>{{AesDerivedKeyParams}}</td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="aead-params">
      <h4><dfn data-idl id="dfn-AeadParams">AeadParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary AeadParams : Algorithm {
  required BufferSource iv;
  BufferSource additionalData;
  [EnforceRange] octet tagLength;
};
      </pre>
      <p>The <dfn data-dfn-for=AeadParams id=dfn-AeadParams-iv>iv</dfn> member represents the initialization vector to use.</p>
      <p>The <dfn data-dfn-for=AeadParams id=dfn-AeadParams-additionalData>additionalData</dfn> member represents the additional authentication data to include.</p>
      <p>The <dfn data-dfn-for=AeadParams id=dfn-AeadParams-tagLength>tagLength</dfn> member represents the desired length of the authentication tag.</p>
      <div class=note>
        <p>
          The {{AeadParams}} dictionary is identical to the {{AesGcmParams}} dictionary of [[webcrypto]],
          and the latter may be replaced by the former when merging this proposal.
        </p>
      </div>
    </section>
    <section id="aes-ocb-operations">
      <h4>Operations</h4>
      <section id="aes-ocb-operations-encrypt">
        <h5>Encrypt</h5>
        <ol>
          <li>
            <p>
              If the {{AeadParams/iv}} member of
              |normalizedAlgorithm| has a length greater than 15
              bytes,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If the {{AeadParams/tagLength}} member of
              |normalizedAlgorithm| is not present:</dt>
              <dd>Let |tagLength| be 128.</dd>
              <dt>If the {{AeadParams/tagLength}} member of
              |normalizedAlgorithm| is one of 64, 96 or 128:</dt>
              <dd>Let |tagLength| be equal to the
              {{AeadParams/tagLength}} member of
               |normalizedAlgorithm|</dd>
              <dt>Otherwise:</dt>
              <dd>
                [= exception/throw =] an
                {{OperationError}}.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |additionalData| be the {{AeadParams/additionalData}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Let |C| be the output that results from performing
              the OCB-ENCRYPT function described in Section 4.2 of
              [[RFC7253]] using AES as the block cipher, using
              the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the |K| input parameter,
              the {{AeadParams/iv}} member of |normalizedAlgorithm| as
              the |N| input parameter,
              |additionalData| as the |A| input parameter,
              |plaintext| as the |P| input parameter, and
              |tagLength| as the |TAGLEN| global parameter.
            </p>
          </li>
          <li>
            <p>
              Return |C|.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-decrypt">
        <h5>Decrypt</h5>
        <ol>
          <li>
            <p>
              If the {{AeadParams/iv}} member of
              |normalizedAlgorithm| has a length greater than 15
              bytes,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If the {{AeadParams/tagLength}} member of
              |normalizedAlgorithm| is not present:</dt>
              <dd>Let |tagLength| be 128.</dd>
              <dt>If the {{AeadParams/tagLength}} member of
              |normalizedAlgorithm| is one of 64, 96 or 128:</dt>
              <dd>Let |tagLength| be equal to the
              {{AeadParams/tagLength}} member of
               |normalizedAlgorithm|</dd>
              <dt>Otherwise:</dt>
              <dd>
                [= exception/throw =] an
                {{OperationError}}.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              If |ciphertext| has a length less than |tagLength| bits,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |additionalData| be the {{AeadParams/additionalData}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Perform the OCB-DECRYPT function described in Section 4.3 of
              [[RFC7253]] using AES as the block cipher, using
              the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the |K| input parameter,
              the {{AeadParams/iv}} member of |normalizedAlgorithm| as
              the |N| input parameter,
              |additionalData| as the |A| input parameter,
              |ciphertext| as the |C| input parameter, and
              |tagLength| as the |TAGLEN| global parameter.
            </p>
            <dl class="switch">
              <dt>If the result of the algorithm is the indication of authentication failure,
              "INVALID":</dt>
              <dd>
                [= exception/throw =] an
                {{OperationError}}
              </dd>
              <dt>Otherwise:</dt>
              <dd>Let |plaintext| be the output |P| of OCB-DECRYPT.</dd>
            </dl>
          </li>
          <li>
            <p>
              Return |plaintext|.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-generate-key">
        <h5>Generate Key</h5>
        <ol>
          <li>
            <p>
              If |usages| contains any entry which is not
              one of "`encrypt`", "`decrypt`",
              "`wrapKey`" or "`unwrapKey`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{AesKeyGenParams/length}} member of
              |normalizedAlgorithm| is not equal to one of
              128, 192 or 256,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>

          <li>
            <p>
              Generate an AES key of length
              equal to the {{AesKeyGenParams/length}} member of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |key| be a new
              {{CryptoKey}} object representing the
              generated AES key.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new
              {{AesKeyAlgorithm}}.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to "`AES-OCB`".
            </p>
          </li>
          <li>
            <p>
              Set the {{AesKeyAlgorithm/length}} attribute of
              |algorithm| to equal the
              {{AesKeyGenParams/length}} member of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |key| to be |extractable|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |key| to be |usages|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-import-key">
        <h5>Import Key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If |usages| contains an entry which is not
              one of "`encrypt`", "`decrypt`",
              "`wrapKey`" or "`unwrapKey`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-secret"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |data| be |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of |data| is not 128, 192 or 256
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                      <dd><p>Let |jwk| equal |keyData|.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/kty}} field of |jwk| is not
                      "`oct`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |jwk| does not meet the requirements of
                      Section 6.4 of JSON Web Algorithms [[JWA]],
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be the [= byte sequence =] obtained by decoding the
                      {{JsonWebKey/k}} field of |jwk|.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If |data| has length 128 bits:</dt>
                      <dd>If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                      not "`A128OCB`",
                        then [= exception/throw =] a
                        {{DataError}}.</dd>
                      <dt>If |data| has length 192 bits:</dt>
                      <dd>If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                      not "`A192OCB`",
                        then [= exception/throw =] a
                        {{DataError}}.</dd>
                      <dt>If |data| has length 256 bits:</dt>
                      <dd>If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                      not "`A256OCB`",
                        then [= exception/throw =] a
                        {{DataError}}.</dd>
                      <dt>Otherwise:</dt>
                      <dd>
                        [= exception/throw =] a
                        {{DataError}}.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                      not "`enc`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                      is invalid according to the requirements of
                      JSON Web Key [[JWK]] or
                      does not contain all of the specified |usages| values,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/ext}} field of |jwk| is present and
                      has the value false and |extractable| is true,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                [= exception/throw =] a
                {{NotSupportedError}}.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |key| be a new {{CryptoKey}}
              object representing an AES key with value |data|.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new
              {{AesKeyAlgorithm}}.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to "`AES-OCB`".
            </p>
          </li>
          <li>
            <p>
              Set the {{AesKeyAlgorithm/length}} attribute of
              |algorithm| to the length, in bits, of |data|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-export-key">
        <h5>Export Key</h5>
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              cannot be accessed, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-secret"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing
                      the raw octets of the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |jwk| be a new {{JsonWebKey}}
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `kty` attribute of |jwk| to the
                      string "`oct`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{JsonWebKey/k}} attribute of |jwk| to be a string
                      containing the raw octets of the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|, encoded according to Section 6.4 of JSON Web Algorithms [[JWA]].
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>If the {{AesKeyAlgorithm/length}} attribute of
                      |key| is 128:</dt>
                      <dd>Set the `alg` attribute of |jwk| to
                      the string "`A128OCB`".</dd>
                      <dt>If the {{AesKeyAlgorithm/length}} attribute of
                      |key| is 192:</dt>
                      <dd>Set the `alg` attribute of |jwk| to
                      the string "`A192OCB`".</dd>
                      <dt>If the {{AesKeyAlgorithm/length}} attribute of
                      |key| is 256:</dt>
                      <dd>Set the `alg` attribute of |jwk| to
                      the string "`A256OCB`".</dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the `key_ops` attribute of |jwk| to equal the
                      {{CryptoKey/usages}} attribute of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `ext` attribute of |jwk| to equal the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot
                      of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be the result of converting |jwk|
                      to an ECMAScript Object, as defined by [[WebIDL]].
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="aes-ocb-operations-get-key-length">
        <h5>Get key length</h5>
        <ol>
          <li>
            <p>
              If the {{AesDerivedKeyParams/length}} member of
              |normalizedDerivedKeyAlgorithm| is not 128, 192 or 256, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return the {{AesDerivedKeyParams/length}} member of
              |normalizedDerivedKeyAlgorithm|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section id="chacha20-poly1305">
    <h3>ChaCha20-Poly1305</h3>
    <section id="chacha20-poly1305-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`ChaCha20-Poly1305`" algorithm identifier is used to perform
        authenticated encryption and decryption using AEAD_CHACHA20_POLY1305,
        as described in [[RFC8439]].
      </p>
    </section>
    <section id="chacha20-poly1305-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "`ChaCha20-Poly1305`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td>{{AeadParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td>{{AeadParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td>{{CryptoKey}}</td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td>None</td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="chacha20-poly1305-operations">
      <h4>Operations</h4>
      <section id="chacha20-poly1305-operations-encrypt">
        <h5>Encrypt</h5>
        <ol>
          <li>
            <p>
              If the {{AeadParams/iv}} member of
              |normalizedAlgorithm| does not have a length of 12 bytes,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{AeadParams/tagLength}} member
              of |normalizedAlgorithm| is present and is not 128,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |additionalData| be the {{AeadParams/additionalData}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Let |ciphertext| be the output that results from
              performing the AEAD_CHACHA20_POLY1305 encryption algorithm
              described in Section 2.8 of [[RFC8439]], using
              the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the key input parameter,
              the {{AeadParams/iv}} member of |normalizedAlgorithm| as
              the nonce input parameter,
              |plaintext| as the plaintext input parameter, and
              |additionalData| as the additional authenticated data (AAD) input parameter.
            </p>
          </li>
          <li>
            <p>
              Return |ciphertext|.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-decrypt">
        <h5>Decrypt</h5>
        <ol>
          <li>
            <p>
              If the {{AeadParams/iv}} member of
              |normalizedAlgorithm| does not have a length of 12 bytes,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{AeadParams/tagLength}} member
              of |normalizedAlgorithm| is present and is not 128,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If |ciphertext| has a length less than 128 bits,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |additionalData| be the {{AeadParams/additionalData}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Perform the AEAD_CHACHA20_POLY1305 decryption algorithm
              described in Section 2.8 of [[RFC8439]], using
              the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
              internal slot of |key| as the key input parameter,
              the {{AeadParams/iv}} member of |normalizedAlgorithm| as
              the nonce input parameter,
              |ciphertext| as the ciphertext input parameter, and
              |additionalData| as the additional authenticated data (AAD) input parameter.
            </p>
            <dl class="switch">
              <dt>If the result of the algorithm is the indication of authentication failure:</dt>
              <dd>
                [= exception/throw =] an
                {{OperationError}}
              </dd>
              <dt>Otherwise:</dt>
              <dd>Let |plaintext| be the resulting plaintext.</dd>
            </dl>
          </li>
          <li>
            <p>
              Return |plaintext|.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-generate-key">
        <h5>Generate Key</h5>
        <ol>
          <li>
            <p>
              If |usages| contains any entry which is not
              one of "`encrypt`", "`decrypt`",
              "`wrapKey`" or "`unwrapKey`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>

          <li>
            <p>
              Generate a 256-bit key.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |key| be a new
              {{CryptoKey}} object representing the
              generated key.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new
              {{KeyAlgorithm}}.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to "`ChaCha20-Poly1305`".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |key| to be |extractable|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |key| to be |usages|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-import-key">
        <h5>Import Key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If |usages| contains an entry which is not
              one of "`encrypt`", "`decrypt`",
              "`wrapKey`" or "`unwrapKey`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-secret"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |data| be |keyData|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the length in bits of |data| is not 256
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                      <dd><p>Let |jwk| equal |keyData|.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/kty}} field of |jwk| is not
                      "`oct`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |jwk| does not meet the requirements of
                      Section 6.4 of JSON Web Algorithms [[JWA]],
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be the [= byte sequence =] obtained by decoding the
                      {{JsonWebKey/k}} field of |jwk|.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                      not "`C20P`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                      not "`enc`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                      is invalid according to the requirements of
                      JSON Web Key [[JWK]] or
                      does not contain all of the specified |usages| values,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/ext}} field of |jwk| is present and
                      has the value false and |extractable| is true,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                [= exception/throw =] a
                {{NotSupportedError}}.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |key| be a new {{CryptoKey}}
              object representing a key with value |data|.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new
              {{KeyAlgorithm}}.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to "`ChaCha20-Poly1305`".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-export-key">
        <h5>Export Key</h5>
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              cannot be accessed, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-secret"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |data| be a [= byte sequence =] containing
                      the raw octets of the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |jwk| be a new {{JsonWebKey}}
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `kty` attribute of |jwk| to the
                      string "`oct`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{JsonWebKey/k}} attribute of |jwk| to be a string
                      containing the raw octets of the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
                      |key|, encoded according to Section 6.4 of JSON Web Algorithms [[JWA]].
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `alg` attribute of |jwk| to
                      the string "`C20P`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `key_ops` attribute of |jwk| to equal the
                      {{CryptoKey/usages}} attribute of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `ext` attribute of |jwk| to equal the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot
                      of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be the result of converting |jwk|
                      to an ECMAScript Object, as defined by [[WebIDL]].
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="chacha20-poly1305-operations-get-key-length">
        <h5>Get key length</h5>
        <ol>
          <li>
            <p>
              Return 256.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="sha3">
    <h3>SHA-3</h3>
    <section id="sha3-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes the SHA-3 family of hash functions, as specified by
        [[FIPS-202]].
      </p>
    </section>
    <section id="sha3-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-sha3-256">SHA3-256</code>",
        "<code id="alg-sha3-384">SHA3-384</code>", and
        "<code id="alg-sha3-512">SHA3-512</code>" for the respective SHA-3 algorithms.
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td>None</td>
            <td>[= byte sequence =]</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="sha3-operations">
      <h4>Operations</h4>
      <section id="sha3-operations-digest">
        <h5>Digest</h5>
        <ol>
          <li>
            <dl class="switch">
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`SHA3-256`":
              </dt>
              <dd>
                Let |result| be the result of performing the SHA3-256 hash function
                defined in Section 6.1 of [[FIPS-202]] using
                |message| as the input message, |M|.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`SHA3-384`":
              </dt>
              <dd>
                Let |result| be the result of performing the SHA3-384 hash function
                defined in Section 6.1 of [[FIPS-202]] using
                |message| as the input message, |M|.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`SHA3-512`":
              </dt>
              <dd>
                Let |result| be the result of performing the SHA3-512 hash function
                defined in Section 6.1 of [[FIPS-202]] using
                |message| as the input message, |M|.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              If performing the operation results in an error, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="cshake">
    <h3>cSHAKE</h3>
    <section id="cshake-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes cSHAKE128 and cSHAKE256, as specified by
        [[NIST-SP800-185]].
      </p>
    </section>
    <section id="cshake-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-cshake128">cSHAKE128</code>" and
        "<code id="alg-cshake256">cSHAKE256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td>{{CShakeParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="cshake-params">
      <h4><dfn data-idl id="dfn-CShakeParams">CShakeParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary CShakeParams : Algorithm {
  required [EnforceRange] unsigned long length;
  BufferSource functionName;
  BufferSource customization;
};
      </pre>
      <p>The <dfn data-dfn-for=CShakeParams id=dfn-CShakeParams-length>length</dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for=CShakeParams id=dfn-CShakeParams-functionName>functionName</dfn> member represents the function name, used by NIST to define functions based on cSHAKE. When used, it should only be set to values defined by NIST.</p>
      <p>The <dfn data-dfn-for=CShakeParams id=dfn-CShakeParams-customization>customization</dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>
    <section id="cshake-operations">
      <h4>Operations</h4>
      <section id="cshake-operations-digest">
        <h5>Digest</h5>
        <ol>
          <li>
            <p>
              Let |length| be the {{CShakeParams/length}} member of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Let |functionName| be the {{CShakeParams/functionName}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <p>
              Let |customization| be the {{CShakeParams/customization}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`cSHAKE128`":
              </dt>
              <dd>
                Let |result| be the result of performing the cSHAKE128 function
                defined in Section 3 of [[NIST-SP800-185]] using
                |message| as the |X| input parameter,
                |length| as the |L| input parameter,
                |functionName| as the |N| input parameter, and
                |customization| as the |S| input parameter.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`cSHAKE256`":
              </dt>
              <dd>
                Let |result| be the result of performing the cSHAKE256 function
                defined in Section 3 of [[NIST-SP800-185]] using
                |message| as the |X| input parameter,
                |length| as the |L| input parameter,
                |functionName| as the |N| input parameter, and
                |customization| as the |S| input parameter.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              If performing the operation results in an error, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="kmac">
    <h3>KMAC</h3>
    <section id="kmac-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes KMAC128 and KMAC256, as specified by
        [[NIST-SP800-185]].
      </p>
    </section>
    <section id="kmac-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-kmac128">KMAC128</code>" and
        "<code id="alg-kmac256">KMAC256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>{{KmacParams}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>verify</td>
            <td>{{KmacParams}}</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>{{KmacKeyGenParams}}</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>{{KmacImportParams}}</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
          <tr>
            <td>get key length</td>
            <td>{{KmacImportParams}}</td>
            <td>Integer</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="kmac-keygen-params">
      <h4><dfn data-idl id="dfn-KmacKeyGenParams">KmacKeyGenParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacKeyGenParams : Algorithm {
  [EnforceRange] unsigned long length;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacKeyGenParams id=dfn-KmacKeyGenParams-length>length</dfn> member represents the length (in bits) of the key to generate. If unspecified, the recommended length will be used, which is 128 for KMAC128 and 256 for KMAC256.</p>
    </section>
    <section id="kmac-importparams">
      <h4><dfn data-idl id="dfn-KmacImportParams">KmacImportParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacImportParams : Algorithm {
  [EnforceRange] unsigned long length;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacImportParams id=dfn-KmacImportParams-length>length</dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="KmacKeyAlgorithm-dictionary">
      <h4><dfn data-idl id="dfn-KmacKeyAlgorithm">KmacKeyAlgorithm</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacKeyAlgorithm : KeyAlgorithm {
  required unsigned long length;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacKeyAlgorithm id=dfn-KmacKeyAlgorithm-length>length</dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="kmac-params">
      <h4><dfn data-idl id="dfn-KmacParams">KmacParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacParams : Algorithm {
  required [EnforceRange] unsigned long length;
  BufferSource customization;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacParams id=dfn-KmacParams-length>length</dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for=KmacParams id=dfn-KmacParams-customization>customization</dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>

    <section id="kmac-operations">
      <h4>Operations</h4>
      <section id="kmac-operations-sign">
        <h5>Sign</h5>
        <ol>
          <li>
            <p>
              Let |customization| be the {{KmacParams/customization}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC128`":
              </dt>
              <dd>
                Let |mac| be the result of performing the KMAC128 function
                defined in Section 4 of [[NIST-SP800-185]] using
                the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                internal slot of |key| as the |K| input parameter,
                |message| as the |X| input parameter,
                the {{KmacParams/length}} member of |normalizedAlgorithm| as
                the |L| input parameter, and
                |customization| as
                the |S| input parameter.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC256`":
              </dt>
              <dd>
                Let |mac| be the result of performing the KMAC256 function
                defined in Section 4 of [[NIST-SP800-185]] using
                the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                internal slot of |key| as the |K| input parameter,
                |message| as the |X| input parameter,
                the {{KmacParams/length}} member of |normalizedAlgorithm| as
                the |L| input parameter, and
                |customization| as
                the |S| input parameter.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |mac|.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-verify">
        <h5>Verify</h5>
        <ol>
          <li>
            <p>
              Let |customization| be the {{KmacParams/customization}} member of
              |normalizedAlgorithm| if present or the empty octet
              string otherwise.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC128`":
              </dt>
              <dd>
                Let |mac| be the result of performing the KMAC128 function
                defined in Section 4 of [[NIST-SP800-185]] using
                the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                internal slot of |key| as the |K| input parameter,
                |message| as the |X| input parameter,
                the {{KmacParams/length}} member of |normalizedAlgorithm| as
                the |L| input parameter, and
                |customization| as
                the |S| input parameter.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC256`":
              </dt>
              <dd>
                Let |mac| be the result of performing the KMAC256 function
                defined in Section 4 of [[NIST-SP800-185]] using
                the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a>
                internal slot of |key| as the |K| input parameter,
                |message| as the |X| input parameter,
                the {{KmacParams/length}} member of |normalizedAlgorithm| as
                the |L| input parameter, and
                |customization| as
                the |S| input parameter.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return true if |mac| is equal to |signature| and false
              otherwise.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-generate-key">
        <h5>Generate Key</h5>
        <ol>
          <li>
            <p>
              If |usages| contains any entry which is not "`sign`" or
              "`verify`", then [= exception/throw =] a {{SyntaxError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the {{KmacKeyGenParams/length}} member of
                |normalizedAlgorithm| is present:
              </dt>
              <dd>
                Let |length| be equal to the
                {{KmacKeyGenParams/length}}
                member of |normalizedAlgorithm|.
              </dd>
              <dt>
                Otherwise, if the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC128`":
              </dt>
              <dd>
                Let |length| be 128.
              </dd>
              <dt>
                Otherwise, if the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC256`":
              </dt>
              <dd>
                Let |length| be 256.
              </dd>
            </dl>
          </li>

          <li>
            <p>
              Generate a key of length |length| bits.
            </p>
          </li>
          <li>
            <p>
              If the key generation step fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |key| be a new
              {{CryptoKey}} object representing the
              generated key.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new
              {{KmacKeyAlgorithm}}.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to "`KMAC`".
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal
              slot of |key| to be |extractable|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-usages">`[[usages]]`</a> internal slot of
              |key| to be |usages|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-import-key">
        <h5>Import Key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If |usages| contains an entry which is not
              "`sign`" or "`verify`",
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-secret"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |data| be |keyData|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <dl class="switch">
                      <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                      <dd><p>Let |jwk| equal |keyData|.</p></dd>
                      <dt>Otherwise:</dt>
                      <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/kty}} field of |jwk| is not
                      "`oct`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If |jwk| does not meet the requirements of
                      Section 6.4 of JSON Web Algorithms [[JWA]],
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |data| be the [= byte sequence =] obtained by decoding the
                      {{JsonWebKey/k}} field of |jwk|.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the {{Algorithm/name}} member of
                        |normalizedAlgorithm| is a case-sensitive string match for
                        "`KMAC128`":
                      </dt>
                      <dd>
                        If the {{JsonWebKey/alg}} field of |jwk| is present
                        and is not "`K128`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </dd>
                      <dt>
                        If the {{Algorithm/name}} member of
                        |normalizedAlgorithm| is a case-sensitive string match for
                        "`KMAC256`":
                      </dt>
                      <dd>
                        If the {{JsonWebKey/alg}} field of |jwk| is present
                        and is not "`K256`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                      not "`sign`",
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                      is invalid according to the requirements of
                      JSON Web Key [[JWK]] or
                      does not contain all of the specified |usages| values,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                  <li>
                    <p>
                      If the {{JsonWebKey/ext}} field of |jwk| is present and
                      has the value false and |extractable| is true,
                      then [= exception/throw =] a
                      {{DataError}}.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                [= exception/throw =] a
                {{NotSupportedError}}.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |length| be the length in bits of |data|.
            </p>
          </li>
          <li>
            <p>
              If |length| is zero
              then [= exception/throw =] a
              {{DataError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the {{KmacImportParams/length}} member of
                |normalizedAlgorithm| is present:
              </dt>
              <dd>
                <dl class="switch">
                  <dt>
                    If the {{KmacImportParams/length}} member of
                    |normalizedAlgorithm| is greater than |length|:
                  </dt>
                  <dd>
                    [= exception/throw =] a
                    {{DataError}}.
                  </dd>
                  <dt>
                    If the {{KmacImportParams/length}} member of
                    |normalizedAlgorithm|, is less than or equal to
                    |length| minus eight:
                  </dt>
                  <dd>
                    [= exception/throw =] a
                    {{DataError}}.
                  </dd>
                  <dt>
                    Otherwise:
                  </dt>
                  <dd>
                    Set |length| equal to the {{KmacImportParams/length}}
                    member of |normalizedAlgorithm|.
                  </dd>
                </dl>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |key| be a new {{CryptoKey}}
              object representing an KMAC key with the first |length|
              bits of |data|.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new
              {{KmacKeyAlgorithm}}.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to "`KMAC`".
            </p>
          </li>
          <li>
            <p>
              Set the {{KmacKeyAlgorithm/length}} attribute of
              |algorithm| to |length|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-export-key">
        <h5>Export Key</h5>
        <ol>
          <li>
            <p>
              If the underlying cryptographic key material represented by the <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              cannot be accessed, then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Let |bits| be the raw bits of the key represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of
              |key|.
            </p>
          </li>
          <li>
            <p>
              Let |data| be an <a data-cite="webcrypto#byte-sequence-containing">byte sequence containing</a> |bits|.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |format| is {{KeyFormat/"raw-secret"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |result| be |data|.
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
              <dd>
                <ol>
                  <li>
                    <p>
                      Let |jwk| be a new {{JsonWebKey}}
                      dictionary.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `kty` attribute of |jwk| to the
                      string "`oct`".
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the {{JsonWebKey/k}} attribute of |jwk| to be a string
                      containing |data|, encoded according to Section 6.4 of JSON Web Algorithms [[JWA]].
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |algorithm| be the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal slot of
                      |key|.
                    </p>
                  </li>
                  <li>
                    <dl class="switch">
                      <dt>
                        If the {{Algorithm/name}} member of
                        |normalizedAlgorithm| is a case-sensitive string match for
                        "`KMAC128`":
                      </dt>
                      <dd>Set the `alg` attribute of |jwk| to
                        the string "`K128`".</dd>
                      <dt>
                        If the {{Algorithm/name}} member of
                        |normalizedAlgorithm| is a case-sensitive string match for
                        "`KMAC256`":
                      </dt>
                      <dd>Set the `alg` attribute of |jwk| to
                        the string "`K256`".</dd>
                    </dl>
                  </li>
                  <li>
                    <p>
                      Set the `key_ops` attribute of |jwk| to equal the
                      {{CryptoKey/usages}} attribute of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Set the `ext` attribute of |jwk| to equal the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot
                      of |key|.
                    </p>
                  </li>
                  <li>
                    <p>
                      Let |result| be the result of converting |jwk|
                      to an ECMAScript Object, as defined by [[WebIDL]].
                    </p>
                  </li>
                </ol>
              </dd>
              <dt>Otherwise:</dt>
              <dd>
                <p>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="kmac-operations-get-key-length">
        <h5>Get key length</h5>
        <ol>
          <li>
            <dl class="switch">
              <dt>
                If the {{KmacImportParams/length}} member of
                |normalizedAlgorithm| is present:
              </dt>
              <dd>
                Let |length| be equal to the
                {{KmacImportParams/length}}
                member of |normalizedAlgorithm|.
              </dd>
              <dt>
                Otherwise, if the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC128`":
              </dt>
              <dd>
                Let |length| be 128.
              </dd>
              <dt>
                Otherwise, if the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`KMAC256`":
              </dt>
              <dd>
                Let |length| be 256.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return |length|.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>
  <section id="argon2">
    <h3>Argon2</h3>
    <section id="argon2-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes the Argon2 function for password hashing and key derivation,
        as defined in [[RFC9106]].
      </p>
    </section>
    <section id="argon2-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="webcrypto#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-argon2d">Argon2d</code>",
        "<code id="alg-argon2i">Argon2i</code>", and
        "<code id="alg-argon2id">Argon2id</code>" for the respective Argon2 types.
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="webcrypto#supported-operations">Operation</a></th>
            <th><a data-cite="webcrypto#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="webcrypto#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td>{{Argon2Params}}</td>
            <td>[= byte sequence =]</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>Get key length</td>
            <td>None</td>
            <td>null</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="argon2-params">
      <h4><dfn data-idl id="dfn-Argon2Params">Argon2Params</dfn> dictionary</h4>
      <pre class=idl>
dictionary Argon2Params : Algorithm {
  required BufferSource nonce;
  required [EnforceRange] unsigned long parallelism;
  required [EnforceRange] unsigned long memory;
  required [EnforceRange] unsigned long passes;
  [EnforceRange] octet version;
  BufferSource secretValue;
  BufferSource associatedData;
};
      </pre>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-nonce>nonce</dfn> member represents the nonce, which is a salt for password hashing applications.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-parallelism>parallelism</dfn> member represents the degree of parallelism.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-memory>memory</dfn> member represents the memory size in kibibytes. It must be at least 8 times the degree of parallelism.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-passes>passes</dfn> member represents the number of passes.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-version>version</dfn> member represents the version number. The default and currently only defined version is 19 (0x13).</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-secretValue>secretValue</dfn> member represents the optional secret value.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-associatedData>associatedData</dfn> member represents the optional associated data.</p>
      <p class="note">
        For the recommended values of the parameters, see section 4 of [[RFC9106]].
      </p>
    </section>
    <section id="argon2-operations">
      <h4>Operations</h4>
      <section id="argon2-operations-derive-bits">
        <h5>Derive Bits</h5>
        <ol>
          <li>
            <p>
              If |length| is null, or is less than 32 (4*8), then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{Argon2Params/version}} member
              of |normalizedAlgorithm| is present and is not 19 (0x13),
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{Argon2Params/parallelism}} member of |normalizedAlgorithm| is zero,
              or greater than 16777215 (2^24-1),
              then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{Argon2Params/memory}} member of |normalizedAlgorithm| is less than
              8 times the {{Argon2Params/parallelism}} member of |normalizedAlgorithm|,
              then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              If the {{Argon2Params/passes}} member of |normalizedAlgorithm| is zero,
              then [= exception/throw =] an {{OperationError}}.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`Argon2d`":
              </dt>
              <dd>
                Let |type| be 0.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`Argon2i`":
              </dt>
              <dd>
                Let |type| be 1.
              </dd>
              <dt>
                If the {{Algorithm/name}} member of
                |normalizedAlgorithm| is a case-sensitive string match for
                "`Argon2id`":
              </dt>
              <dd>
                Let |type| be 2.
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Let |secretValue| be the {{Argon2Params/secretValue}} member of
              |normalizedAlgorithm|, if present.
            </p>
          </li>
          <li>
            <p>
              Let |associatedData| be the {{Argon2Params/associatedData}} member of
              |normalizedAlgorithm|, if present.
            </p>
          </li>
          <li>
            <p>
              Let |result| be the result of performing the Argon2 function defined
              in Section 3 of [[RFC9106]] using
              the password represented by <a data-cite="webcrypto#dfn-CryptoKey-slot-handle">`[[handle]]`</a> internal slot of |key|
              as the message, |P|,
              the {{Argon2Params/nonce}} attribute of
              |normalizedAlgorithm| as the nonce, |S|,
              the value of the {{Argon2Params/parallelism}} attribute
              of |normalizedAlgorithm| as the degree of parallelism, |p|,
              the value of the {{Argon2Params/memory}} attribute
              of |normalizedAlgorithm| as the memory size, |m|,
              the value of the {{Argon2Params/passes}} attribute
              of |normalizedAlgorithm| as the number of passes, |t|,
              0x13 as the version number, |v|,
              |secretValue| (if present) as the secret value, |K|,
              |associatedData| (if present) as the associated data, |X|,
              |type| as the type, |y|, and
              |length| divided by 8 as the tag length, |T|.
            </p>
          </li>
          <li>
            <p>
              If the key derivation operation fails,
              then [= exception/throw =] an
              {{OperationError}}.
            </p>
          </li>
          <li>
            <p>
              Return |result|.
            </p>
          </li>
        </ol>
      </section>
      <section id="argon2-operations-import-key">
        <h5>Import key</h5>
        <ol>
          <li>
            <p>Let |keyData| be the key data to be imported.</p>
          </li>
          <li>
            <p>
              If |format| is not {{KeyFormat/"raw-secret"}}, [= exception/throw =] a {{NotSupportedError}}
            </p>
          </li>
          <li>
            <p>
              If |usages| contains a value that is not
              "`deriveKey`"  or "`deriveBits`", then
              [= exception/throw =] a {{SyntaxError}}.
            </p>
          </li>
          <li>
            <p>
              If |extractable| is not `false`,
              then [= exception/throw =] a
              {{SyntaxError}}.
            </p>
          </li>
          <li>
            <p>
              Let |key| be a new {{CryptoKey}}
              representing |keyData|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-type">`[[type]]`</a> internal slot of
              |key| to {{KeyType/"secret"}}.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-extractable">`[[extractable]]`</a> internal slot of
              |key| to `false`.
            </p>
          </li>
          <li>
            <p>
              Let |algorithm| be a new {{KeyAlgorithm}}
              object.
            </p>
          </li>
          <li>
            <p>
              Set the {{KeyAlgorithm/name}} attribute of
              |algorithm| to the {{Algorithm/name}} member of
              |normalizedAlgorithm|.
            </p>
          </li>
          <li>
            <p>
              Set the <a data-cite="webcrypto#dfn-CryptoKey-slot-algorithm">`[[algorithm]]`</a> internal
              slot of |key| to |algorithm|.
            </p>
          </li>
          <li>
            <p>
              Return |key|.
            </p>
          </li>
        </ol>
      </section>
      <section id="argon2-operations-get-key-length">
        <h5>Get key length</h5>
        <ol>
          <li>
            <p>
              Return null.
            </p>
          </li>
        </ol>
      </section>
    </section>
  </section>

  <section>
    <h2>Usage Example</h2>
    <p>
      This example derives a key from a password using Argon2, if available, or PBKDF2, otherwise;
      and then encrypts and decrypts some text with it using AES-OCB, if available, and AES-GCM, otherwise.
    </p>
    <pre class="example js" title="Encrypt some data using a key derived from a password">
      const password = 'correct horse battery staple';
      const derivationAlg =
        SubtleCrypto.supports?.('importKey', 'Argon2id') ?
          'Argon2id' :
          'PBKDF2';
      const encryptionAlg =
        SubtleCrypto.supports?.('importKey', 'AES-OCB') ?
          'AES-OCB' :
          'AES-GCM';
      const passwordKey = await crypto.subtle.importKey(
        derivationAlg === 'Argon2id' ? 'raw-secret' : 'raw',
        new TextEncoder().encode(password),
        derivationAlg,
        /* extractable: */ false,
        ['deriveKey']
      );
      const nonce = crypto.getRandomValues(new Uint8Array(16));
      const derivationParams =
        derivationAlg === 'Argon2id' ?
          {
            nonce,
            parallelism: 4,
            memory: 2 ** 21,
            passes: 1
          } :
          {
            salt: nonce,
            iterations: 100_000,
            hash: 'SHA-256'
          };
      const key = await crypto.subtle.deriveKey(
        {
          name: derivationAlg,
          ...derivationParams
        },
        passwordKey,
        {
          name: encryptionAlg,
          length: 256
        },
        /* extractable: */ false,
        ['encrypt', 'decrypt']
      );
      const plaintext = 'Hello, world!';
      const iv = crypto.getRandomValues(new Uint8Array(16));
      const encrypted = await crypto.subtle.encrypt(
        { name: encryptionAlg, iv },
        key,
        new TextEncoder().encode(plaintext)
      );
      // Store the derivation and encryption algorithm and parameters
      // as well as the ciphertext (e.g. in IndexedDB or a database),
      // and retrieve them later. Then, derive the key using the
      // original parameters and the password. Here we immediately
      // use the same key object to decrypt again.
      const decrypted = new TextDecoder().decode(await crypto.subtle.decrypt(
        { name: encryptionAlg, iv },
        key,
        encrypted
      ));
    </pre>
  </section>

  <section id="jwk-mapping" class="appendix informative">
    <h2>Mapping between JSON Web Key / JSON Web Algorithm</h2>
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting JWK.
    </p>
    <h3>Algorithm mappings</h3>
    <table>
      <thead>
        <tr>
          <th scope="col">JSON Web Key</th>
          <th scope="col">AlgorithmIdentifier</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "A128OCB" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "AES-OCB",
length: 128 }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "A192OCB" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "AES-OCB",
length: 192 }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "A256OCB" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "AES-OCB",
length: 256 }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "C20P" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "ChaCha20-Poly1305" }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "K128" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "KMAC128" }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "K256" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "KMAC256" }
</pre>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="todo">TODO: register A128OCB, A192OCB, A256OCB, C20P, K128 and K256(?) with IANA in the JSON Web Signature and Encryption Algorithms registry.</div>
    <div class="todo">TODO: register encapsulateKey, encapsulateBits, decapsulateKey and decapsulateBits with IANA in the JSON Web Key Operations registry.</div>
  </section>

  <section id="pkcs8-mapping" class="appendix informative">
    <h2>Mapping between Algorithm and PKCS#8 PrivateKeyInfo</h2>
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting PKCS#8 PrivateKeyInfo.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">privateKeyAlgorithm</th>
          <th scope="col">privateKey format</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-ml-dsa-44 (2.16.840.1.101.3.4.3.17)</td>
          <td>ML-DSA-44-PrivateKey</td>
          <td>
            "`ML-DSA-44`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-65 (2.16.840.1.101.3.4.3.18)</td>
          <td>ML-DSA-65-PrivateKey</td>
          <td>
            "`ML-DSA-65`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-87 (2.16.840.1.101.3.4.3.19)</td>
          <td>ML-DSA-87-PrivateKey</td>
          <td>
            "`ML-DSA-87`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-512 (2.16.840.1.101.3.4.4.1)</td>
          <td>ML-KEM-512-PrivateKey</td>
          <td>
            "`ML-KEM-512`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-768 (2.16.840.1.101.3.4.4.2)</td>
          <td>ML-KEM-768-PrivateKey</td>
          <td>
            "`ML-KEM-768`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-1024 (2.16.840.1.101.3.4.4.3)</td>
          <td>ML-KEM-1024-PrivateKey</td>
          <td>
            "`ML-KEM-1024`"
          </td>
          <td>
            TODO
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="spki-mapping" class="appendix informative" >
    <h2>Mapping between Algorithm and SubjectPublicKeyInfo</h2>
    <p class="norm">
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting SPKI.
    </p>
    <table>
      <thead>
        <tr>
          <th scope="col">Algorithm OID</th>
          <th scope="col">subjectPublicKey ASN.1 structure</th>
          <th scope="col">AlgorithmIdentifier</th>
          <th scope="col">Reference</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id-ml-dsa-44 (2.16.840.1.101.3.4.3.17)</td>
          <td>BIT STRING</td>
          <td>
            "`ML-DSA-44`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-65 (2.16.840.1.101.3.4.3.18)</td>
          <td>BIT STRING</td>
          <td>
            "`ML-DSA-65`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-ml-dsa-87 (2.16.840.1.101.3.4.3.19)</td>
          <td>BIT STRING</td>
          <td>
            "`ML-DSA-87`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-512 (2.16.840.1.101.3.4.4.1)</td>
          <td>BIT STRING</td>
          <td>
            "`ML-KEM-512`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-768 (2.16.840.1.101.3.4.4.2)</td>
          <td>BIT STRING</td>
          <td>
            "`ML-KEM-768`"
          </td>
          <td>
            TODO
          </td>
        </tr>
        <tr>
          <td>id-alg-ml-kem-1024 (2.16.840.1.101.3.4.4.3)</td>
          <td>BIT STRING</td>
          <td>
            "`ML-KEM-1024`"
          </td>
          <td>
            TODO
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section id="conformance"></section>
</body>

</html>
