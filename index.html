<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Modern Algorithms in the Web Cryptography API</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
  <script class='remove'>
  "use strict";
  // See https://github.com/w3c/respec/wiki/ for how to configure ReSpec
  var respecConfig = {
    "github": "twiss/webcrypto-modern-algos",
    "editors": [
      {
        name: "Daniel Huigens",
        url: "mailto:daniel.huigens@proton.ch",
        company: "Proton AG",
        companyURL: "https://proton.me/",
      },
    ],
    "shortName": "webcrypto-modern-algos",
    "specStatus": "CG-DRAFT",
    "group": "wicg",
    "xref": ["WebIDL", "WebCryptoAPI", "infra"],
    localBiblio: {
      "JWA": {
        aliasOf: "RFC7518"
      },
      // TODO: move to specref?
      "FIPS-202": {
        "title": "SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions",
        "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf",
        "publisher": "NIST",
        "date": "August 2015"
      },
      // TODO: move to specref?
      "NIST-SP800-185": {
        "title": "NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash",
        "href": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf",
        "publisher": "NIST",
        "date": "December 2016"
      },
    },
  };
  </script>
</head>

<body>
  <section id="abstract">
    <p>
      This specification defines a number of modern cryptographic algorithms
      for the [[[WebCryptoAPI]]], namely AES-OCB, ChaCha20-Poly1305, SHA-3, cSHAKE, KMAC, and Argon2.
    </p>
  </section>
  <section id="sotd">
    <p>
      This is an unofficial proposal.
    </p>
  </section>
  <section id="introduction" class="informative">
    <h2>Introduction</h2>
    <p>
      This proposal aims to modernize the set of cryptographic algorithms
      available in the [[[WebCryptoAPI]]], such that web applications can
      make use of the most secure and performant options available.
      To this end, the following cryptographic algorithms are added:
      <ul>
        <li>AES-OCB [[RFC7253]]</li>
        <li>ChaCha20-Poly1305 [[RFC8439]]</li>
        <li>SHA3-256, SHA3-384, and SHA3-512 [[FIPS-202]]</li>
        <li>cSHAKE128, cSHAKE256, KMAC128 and KMAC256 [[NIST-SP800-185]]</li>
        <li>Argon2d, Argon2i, and Argon2id [[RFC9106]]</li>
      </ul>
    </p>
    <p>
      Additionally, this proposal aims to make feature detection easier,
      by adding a `crypto.subtle.supports(operation, algorithm)` function,
      which can be used to detect whether a given algorithm identifier
      (including any parameters) is supported for the given operation.
    </p>
  </section>
  <section id="specification-conventions">
    <h2>Specification Conventions</h3>
    <p>
      This specification follows the <a data-cite="WebCryptoAPI#algorithm-conventions">conventions</a>
      laid out in Section 18.3 of [[WebCryptoAPI]]. None of the algorithms defined here
      are required to be implemented, but if a conforming User Agent implements an
      algorithm, it MUST implement all of the supported operations specified in this
      document, and must perform the steps to <a data-cite="WebCryptoAPI#concept-define-an-algorithm">define an algorithm</a>
      specified in section 18.4.3 of [[WebCryptoAPI]] for each of the supported operations.
    </p>
  </section>
  <section id="terminology">
    <h2>Terminology</h2>
    <p>
      An <dfn id="dfn-octet-string">octet string</dfn> is an ordered sequence of zero or more
      integers, each in the range 0 to 255 inclusive.
    </p>
    <p>
      When this specification states to supply the <dfn id="concept-contents-of-arraybuffer">
      contents of an ArrayBuffer</dfn> named |data| to an underlying cryptographic
      implementation, the User Agent shall supply a contiguous sequence of bytes that is equal
      to the result of
      [= get a copy of the buffer source | getting a copy of the bytes =]
      held |data|.
    </p>
  </section>

  <section id="partial-subtlecrypto-interface">
    <h2>Partial SubtleCrypto interface</h2>
    <p>
      This section extends the {{SubtleCrypto}} interface of [[WebCryptoAPI]].
    </p>
    <pre class="idl">
[SecureContext,Exposed=(Window,Worker)]
partial interface SubtleCrypto {
  boolean supports(DOMString operation,
                   AlgorithmIdentifier algorithm,
                   optional unsigned long? length = null);
  boolean supports(DOMString operation,
                   AlgorithmIdentifier algorithm,
                   AlgorithmIdentifier additionalAlgorithm);
};
    </pre>

    <section id="partial-subtlecrypto-interface-methods">
      <h3>Methods and Parameters</h3>
      <section id="SubtleCrypto-method-supports">
        <h4>The supports method</h4>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports" data-dfn-for=SubtleCrypto data-lt="supports">supports(|operation|, |algorithm|, |length|)</dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified {{AlgorithmIdentifier}},
          with an optional `length` parameter to indicate the number of bits to be derived when `operation` is "`deriveBits`".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If |operation| is not one of
              "`encrypt`", "`decrypt`", "`sign`", "`verify`",
              "`digest`", "`generateKey`", "`deriveKey`", "`deriveBits`",
              "`importKey`", "`exportKey`", "`wrapKey`" or "`unwrapKey`",
              return false.
            </p>
          </li>
          <li>
            <p>
              Return the result of [= check support for an algorithm | checking support for an algorithm =],
              with `op` set to |operation|, `alg` set to |algorithm|,
              and `length` set to |length|.
            </p>
          </li>
        </ol>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports-additionalAlgorithm" data-dfn-for=SubtleCrypto data-lt="supports!overload-1">supports(|operation|, |algorithm|, |additionalAlgorithm|)</dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified {{AlgorithmIdentifier}}s.
          The additional algorithm indicates the type of key to be derived when `operation` is "`deriveKey`",
          the type of key to be exported before wrapping when `operation` is "`wrapKey`",
          and the type of key to be imported after unwrapping when `operation` is "`unwrapKey`".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If |operation| is not one of
              "`encrypt`", "`decrypt`", "`sign`", "`verify`",
              "`digest`", "`generateKey`", "`deriveKey`", "`deriveBits`",
              "`importKey`", "`exportKey`", "`wrapKey`" or "`unwrapKey`",
              return false.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If |operation| is "`deriveKey`":</dt>
              <dd>
                <p>
                  If the result of [= check support for an algorithm | checking support for an algorithm =]
                  with `op` set to "`importKey`"
                  and `alg` set to |additionalAlgorithm|
                  is false, or
                  the result of [= check support for an algorithm | checking support for an algorithm =]
                  with `op` set to "`get key length`"
                  and `alg` set to |additionalAlgorithm|
                  is false,
                  return false.
                </p>
              </dd>
              <dt>If |operation| is "`wrapKey`":</dt>
              <dd>
                <p>
                  If the result of [= check support for an algorithm | checking support for an algorithm =]
                  with `op` set to "`exportKey`"
                  and `alg` set to |additionalAlgorithm|
                  is false,
                  return false.
                </p>
              </dd>
              <dt>If |operation| is "`unwrapKey`":</dt>
              <dd>
                <p>
                  If the result of [= check support for an algorithm | checking support for an algorithm =]
                  with `op` set to "`importKey`"
                  and `alg` set to |additionalAlgorithm|
                  is false,
                  return false.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return the result of [= check support for an algorithm | checking support for an algorithm =],
              with `op` set to |operation| and `alg` set to |algorithm|.
            </p>
          </li>
        </ol>
      </section>
    </section>

    <section id="partial-subtlecrypto-interface-checking-support-for-algorithm">
      <h3>Checking support for an algorithm</h3>
      <p>
        The <dfn id="dfn-check-support-for-algorithm">check support for an algorithm</dfn> algorithm
        defines a process for checking whether the given algorithm is supported for the given operation.
        Its input is an operation name |op|, an {{AlgorithmIdentifier}} |alg|,
        and an optional |length| parameter. Its output is a boolean.
        It behaves as follows:
      </p>
      <ol>
        <li>
          <p>
            If |op| is "`deriveKey`", set |op| is "`deriveBits`".
          </p>
        </li>
        <li>
          <p>
            Let |normalizedAlgorithm| be the result of
            <a data-cite="WebCryptoAPI#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
            `alg` set to |alg| and `op` set to |op|.
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>If an error occurred:</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    If |op| is "`wrapKey`",
                    return the result of [= check support for an algorithm | checking support for an algorithm =]
                    with `op` set to "`encrypt`"
                    and `alg` set to |alg|.
                  </p>
                </li>
                <li>
                  <p>
                    If |op| is "`unwrapKey`",
                    return the result of [= check support for an algorithm | checking support for an algorithm =]
                    with `op` set to "`decrypt`"
                    and `alg` set to |alg|.
                  </p>
                </li>
                <li>
                  <p>
                    Otherwise, return false.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </li>
        <li>
          <p>
            If the specified operation or algorithm (or one of its parameter values)
            is expected to fail (for any key and/or data) for an implementation-specific reason
            (e.g. known nonconformance to the specification), return false.
          </p>
        </li>
        <li>
          <p>
            If |op| is "`generateKey`" or "`importKey`", let |usages| be the empty list.
          </p>
        </li>
        <li>
          <p>
            For each of the steps of the operation specified by |op|
            of the algorithm specified by |normalizedAlgorithm|:
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>
              If the step says to [= exception/throw =] an error:
            </dt>
            <dd>
              Return false.
            </dd>
            <dt>
              If the step says to generate a key:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step relies on an unavailable parameter, such as `key`, `plaintext` or `ciphertext`:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step says to return a value:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              Otherwise:
            </dt>
            <dd>
              Execute the step.
            </dd>
          </dl>
          <p class="note">
            The steps in the referenced algorithm may access the |normalizedAlgorithm|,
            |length|, and |usages| variables from this context.
          </p>
        </li>
        <li>
          <p>
            [= Assert =]: this step is never reached,
            because one of the steps of the operation will have said
            to return a value or throw an error, causing us to return
            true or false, respectively.
          </p>
        </li>
      </ol>
    </section>
  </section>

  <section id="aes-ocb">
    <h3>AES-OCB</h3>
    <section id="aes-ocb-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`AES-OCB`" algorithm identifier is used to perform
        authenticated encryption and decryption using AES in OCB mode,
        as described in [[RFC7253]].
      </p>
    </section>
    <section id="aes-ocb-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "`AES-OCB`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td>{{AeadParams}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td>{{AeadParams}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>{{AesKeyGenParams}}</td>
            <td>{{CryptoKey}}</td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td>{{CryptoKey}}</td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td>{{AesDerivedKeyParams}}</td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="aead-params">
      <h4><dfn data-idl id="dfn-AeadParams">AeadParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary AeadParams : Algorithm {
  required BufferSource iv;
  BufferSource additionalData;
  [EnforceRange] octet tagLength;
};
      </pre>
      <p>The <dfn data-dfn-for=AeadParams id=dfn-AeadParams-iv>iv</dfn> member represents the initialization vector to use.</p>
      <p>The <dfn data-dfn-for=AeadParams id=dfn-AeadParams-additionalData>additionalData</dfn> member represents the additional authentication data to include.</p>
      <p>The <dfn data-dfn-for=AeadParams id=dfn-AeadParams-tagLength>tagLength</dfn> member represents the desired length of the authentication tag.</p>
      <div class=note>
        <p>
          The {{AeadParams}} dictionary is identical to the {{AesGcmParams}} dictionary of [[WebCryptoAPI]],
          and the latter may be replaced by the former when merging this proposal.
        </p>
      </div>
    </section>
    <section id="aes-ocb-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Encrypt</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the {{AeadParams/iv}} member of
                |normalizedAlgorithm| has a length greater than 15
                bytes,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If the {{AeadParams/tagLength}} member of
                |normalizedAlgorithm| is not present:</dt>
                <dd>Let |tagLength| be 128.</dd>
                <dt>If the {{AeadParams/tagLength}} member of
                |normalizedAlgorithm| is one of 64, 96 or 128:</dt>
                <dd>Let |tagLength| be equal to the
                {{AeadParams/tagLength}} member of
                 |normalizedAlgorithm|</dd>
                <dt>Otherwise:</dt>
                <dd>
                  [= exception/throw =] an
                  {{OperationError}}.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let |additionalData| be <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{AeadParams/additionalData}} member of
                |normalizedAlgorithm| if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Let |C| be the output that results from performing
                the OCB-ENCRYPT function described in Section 4.2 of
                [[RFC7253]] using AES as the block cipher, using
                the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                internal slot of |key| as the |K| input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{AeadParams/iv}} member of |normalizedAlgorithm| as
                the |N| input parameter, <a href="#concept-contents-of-arraybuffer">the contents of
                |additionalData|</a> as the |A| input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of
                |plaintext|</a> as the |P| input parameter, and
                |tagLength| as the |TAGLEN| global parameter.
              </p>
            </li>
            <li>
              <p>
                Return the result of [= ArrayBuffer/create | creating =]
                an {{ArrayBuffer}} containing |C|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Decrypt</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>If the {{AeadParams/tagLength}} member of
                |normalizedAlgorithm| is not present:</dt>
                <dd>Let |tagLength| be 128.</dd>
                <dt>If the {{AeadParams/tagLength}} member of
                |normalizedAlgorithm| is one of 64, 96 or 128:</dt>
                <dd>Let |tagLength| be equal to the
                {{AeadParams/tagLength}} member of
                 |normalizedAlgorithm|</dd>
                <dt>Otherwise:</dt>
                <dd>
                  [= exception/throw =] an
                  {{OperationError}}.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If |ciphertext| has a length less than |tagLength| bits,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{AeadParams/iv}} member of
                |normalizedAlgorithm| has a length greater than 15
                bytes,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |additionalData| be <a href="#concept-contents-of-arraybuffer">the contents</a> of the {{AeadParams/additionalData}} member of
                |normalizedAlgorithm| if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Perform the OCB-DECRYPT function described in Section 4.3 of
                [[RFC7253]] using AES as the block cipher, using
                the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                internal slot of |key| as the |K| input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{AeadParams/iv}} member of |normalizedAlgorithm| as
                the |N| input parameter, <a href="#concept-contents-of-arraybuffer">the contents of
                |additionalData|</a> as the |A| input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of
                |ciphertext|</a> as the |C| input parameter, and
                |tagLength| as the |TAGLEN| global parameter.
              </p>
              <dl class="switch">
                <dt>If the result of the algorithm is the indication of authentication failure,
                "INVALID":</dt>
                <dd>
                  [= exception/throw =] an
                  {{OperationError}}
                </dd>
                <dt>Otherwise:</dt>
                <dd>Let |plaintext| be the output |P| of OCB-DECRYPT.</dd>
              </dl>
            </li>
            <li>
              <p>
                Return the result of [= ArrayBuffer/create | creating =]
                an {{ArrayBuffer}} containing |plaintext|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains any entry which is not
                one of "`encrypt`", "`decrypt`",
                "`wrapKey`" or "`unwrapKey`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{AesKeyGenParams/length}} member of
                |normalizedAlgorithm| is not equal to one of
                128, 192 or 256,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>

            <li>
              <p>
                Generate an AES key of length
                equal to the {{AesKeyGenParams/length}} member of
                |normalizedAlgorithm|.
              </p>
            </li>
            <li>
              <p>
                If the key generation step fails,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |key| be a new
                {{CryptoKey}} object representing the
                generated AES key.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new
                {{AesKeyAlgorithm}}.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`AES-OCB`".
              </p>
            </li>
            <li>
              <p>
                Set the {{AesKeyAlgorithm/length}} attribute of
                |algorithm| to equal the
                {{AesKeyGenParams/length}} member of
                |normalizedAlgorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |key| to be |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |key| to be |usages|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains an entry which is not
                one of "`encrypt`", "`decrypt`",
                "`wrapKey`" or "`unwrapKey`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |data| be the [= octet string =] contained in |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the length in bits of |data| is not 128, 192 or 256
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`oct`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |jwk| does not meet the requirements of
                        Section 6.4 of JSON Web Algorithms [[JWA]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be the [= octet string =] obtained by decoding the
                        {{JsonWebKey/k}} field of |jwk|.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If |data| has length 128 bits:</dt>
                        <dd>If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                        not "`A128OCB`",
                          then [= exception/throw =] a
                          {{DataError}}.</dd>
                        <dt>If |data| has length 192 bits:</dt>
                        <dd>If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                        not "`A192OCB`",
                          then [= exception/throw =] a
                          {{DataError}}.</dd>
                        <dt>If |data| has length 256 bits:</dt>
                        <dd>If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                        not "`A256OCB`",
                          then [= exception/throw =] a
                          {{DataError}}.</dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          [= exception/throw =] a
                          {{DataError}}.
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                        not "`enc`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of
                        JSON Web Key [[JWK]] or
                        does not contain all of the specified |usages| values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let |key| be a new `{{CryptoKey}}`
                object representing an AES key with value |data|.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new
                {{AesKeyAlgorithm}}.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`AES-OCB`".
              </p>
            </li>
            <li>
              <p>
                Set the {{AesKeyAlgorithm/length}} attribute of
                |algorithm| to the length, in bits, of |data|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |data| be the raw octets of the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of [= ArrayBuffer/create | creating =]
                        an {{ArrayBuffer}} containing |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to the
                        string "`oct`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/k}} attribute of |jwk| to be a string
                        containing the raw octets of the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|, encoded according to Section 6.4 of JSON Web Algorithms [[JWA]].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the {{AesKeyAlgorithm/length}} attribute of
                        |key| is 128:</dt>
                        <dd>Set the `alg` attribute of |jwk| to
                        the string "`A128OCB`".</dd>
                        <dt>If the {{AesKeyAlgorithm/length}} attribute of
                        |key| is 192:</dt>
                        <dd>Set the `alg` attribute of |jwk| to
                        the string "`A192OCB`".</dd>
                        <dt>If the {{AesKeyAlgorithm/length}} attribute of
                        |key| is 256:</dt>
                        <dd>Set the `alg` attribute of |jwk| to
                        the string "`A256OCB`".</dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to equal the
                        {{CryptoKey/usages}} attribute of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to equal the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the {{AesDerivedKeyParams/length}} member of
                |normalizedDerivedKeyAlgorithm| is not 128, 192 or 256, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Return the {{AesDerivedKeyParams/length}} member of
                |normalizedDerivedKeyAlgorithm|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="chacha20-poly1305">
    <h3>ChaCha20-Poly1305</h3>
    <section id="chacha20-poly1305-description" class="informative">
      <h4>Description</h4>
      <p>
        The "`ChaCha20-Poly1305`" algorithm identifier is used to perform
        authenticated encryption and decryption using AEAD_CHACHA20_POLY1305,
        as described in [[RFC8439]].
      </p>
    </section>
    <section id="chacha20-poly1305-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "`ChaCha20-Poly1305`".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td>{{AeadParams}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td>{{AeadParams}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td>{{CryptoKey}}</td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td>None</td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="chacha20-poly1305-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Encrypt</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the {{AeadParams/iv}} member of
                |normalizedAlgorithm| does not have a length of 12 bytes,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{AeadParams/tagLength}} member
                of |normalizedAlgorithm| is present and is not 128,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |additionalData| be <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{AeadParams/additionalData}} member of
                |normalizedAlgorithm| if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Let |ciphertext| be the output that results from
                performing the AEAD_CHACHA20_POLY1305 encryption algorithm
                described in Section 2.8 of [[RFC8439]], using
                the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                internal slot of |key| as the key input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{AeadParams/iv}} member of |normalizedAlgorithm| as
                the nonce input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of
                |plaintext|</a> as the plaintext input parameter, and
                <a href="#concept-contents-of-arraybuffer">the contents of
                |additionalData|</a> as the additional authenticated data (AAD) input parameter.
              </p>
            </li>
            <li>
              <p>
                Return the result of [= ArrayBuffer/create | creating =]
                an {{ArrayBuffer}} containing |ciphertext|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Decrypt</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>If the {{AeadParams/tagLength}} member of
                |normalizedAlgorithm| is not present:</dt>
                <dd>Let |tagLength| be 128.</dd>
                <dt>If the {{AeadParams/tagLength}} member of
                |normalizedAlgorithm| is one of 64, 96 or 128:</dt>
                <dd>Let |tagLength| be equal to the
                {{AeadParams/tagLength}} member of
                 |normalizedAlgorithm|</dd>
                <dt>Otherwise:</dt>
                <dd>
                  [= exception/throw =] an
                  {{OperationError}}.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If |ciphertext| has a length less than |tagLength| bits,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{AeadParams/iv}} member of
                |normalizedAlgorithm| has a length greater than 15
                bytes,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |additionalData| be <a href="#concept-contents-of-arraybuffer">the contents</a> of the {{AeadParams/additionalData}} member of
                |normalizedAlgorithm| if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Perform the AEAD_CHACHA20_POLY1305 decryption algorithm
                described in Section 2.8 of [[RFC8439]], using
                the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                internal slot of |key| as the key input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{AeadParams/iv}} member of |normalizedAlgorithm| as
                the nonce input parameter,
                <a href="#concept-contents-of-arraybuffer">the contents of
                |ciphertext|</a> as the ciphertext input parameter, and
                <a href="#concept-contents-of-arraybuffer">the contents of
                |additionalData|</a> as the additional authenticated data (AAD) input parameter.
              </p>
              <dl class="switch">
                <dt>If the result of the algorithm is the indication of authentication failure:</dt>
                <dd>
                  [= exception/throw =] an
                  {{OperationError}}
                </dd>
                <dt>Otherwise:</dt>
                <dd>Let |plaintext| be the resulting plaintext.</dd>
              </dl>
            </li>
            <li>
              <p>
                Return the result of [= ArrayBuffer/create | creating =]
                an {{ArrayBuffer}} containing |plaintext|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains any entry which is not
                one of "`encrypt`", "`decrypt`",
                "`wrapKey`" or "`unwrapKey`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>

            <li>
              <p>
                Generate a 256-bit key.
              </p>
            </li>
            <li>
              <p>
                If the key generation step fails,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |key| be a new
                {{CryptoKey}} object representing the
                generated key.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new
                {{KeyAlgorithm}}.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`ChaCha20-Poly1305`".
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |key| to be |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |key| to be |usages|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains an entry which is not
                one of "`encrypt`", "`decrypt`",
                "`wrapKey`" or "`unwrapKey`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |data| be the [= octet string =] contained in |keyData|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the length in bits of |data| is not 256
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`oct`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |jwk| does not meet the requirements of
                        Section 6.4 of JSON Web Algorithms [[JWA]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be the [= octet string =] obtained by decoding the
                        {{JsonWebKey/k}} field of |jwk|.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/alg}} field of |jwk| is present, and is
                        not "`CC20P1305`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                        not "`enc`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of
                        JSON Web Key [[JWK]] or
                        does not contain all of the specified |usages| values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let |key| be a new `{{CryptoKey}}`
                object representing a key with value |data|.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new
                {{KeyAlgorithm}}.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`ChaCha20-Poly1305`".
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |data| be the raw octets of the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of [= ArrayBuffer/create | creating =]
                        an {{ArrayBuffer}} containing |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to the
                        string "`oct`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/k}} attribute of |jwk| to be a string
                        containing the raw octets of the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                        |key|, encoded according to Section 6.4 of JSON Web Algorithms [[JWA]].
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `alg` attribute of |jwk| to
                        the string "`CC20P1305`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to equal the
                        {{CryptoKey/usages}} attribute of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to equal the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <p>
                Return 256.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="sha3">
    <h3>SHA-3</h3>
    <section id="sha3-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes the SHA-3 family of hash functions, as specified by
        [[FIPS-202]].
      </p>
    </section>
    <section id="sha3-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-sha3-256">SHA3-256</code>",
        "<code id="alg-sha3-384">SHA3-384</code>", and
        "<code id="alg-sha3-512">SHA3-512</code>" for the respective SHA-3 algorithms.
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td>None</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="sha3-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Digest</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`SHA3-256`":
                </dt>
                <dd>
                  Let |result| be the result of performing the SHA3-256 hash function
                  defined in Section 6.1 of [[FIPS-202]] using
                  |message| as the input message, |M|.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`SHA3-384`":
                </dt>
                <dd>
                  Let |result| be the result of performing the SHA3-384 hash function
                  defined in Section 6.1 of [[FIPS-202]] using
                  |message| as the input message, |M|.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`SHA3-512`":
                </dt>
                <dd>
                  Let |result| be the result of performing the SHA3-512 hash function
                  defined in Section 6.1 of [[FIPS-202]] using
                  |message| as the input message, |M|.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If performing the operation results in an error, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Return a new ArrayBuffer containing |result|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="cshake">
    <h3>cSHAKE</h3>
    <section id="cshake-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes cSHAKE128 and cSHAKE256, as specified by
        [[NIST-SP800-185]].
      </p>
    </section>
    <section id="cshake-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-cshake128">cSHAKE128</code>" and
        "<code id="alg-cshake256">cSHAKE256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td>{{CShakeParams}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="cshake-params">
      <h4><dfn data-idl id="dfn-CShakeParams">CShakeParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary CShakeParams : Algorithm {
  required [EnforceRange] unsigned long length;
  BufferSource functionName;
  BufferSource customization;
};
      </pre>
      <p>The <dfn data-dfn-for=CShakeParams id=dfn-CShakeParams-length>length</dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for=CShakeParams id=dfn-CShakeParams-functionName>functionName</dfn> member represents the function name, used by NIST to define functions based on cSHAKE. When used, it should only be set to values defined by NIST.</p>
      <p>The <dfn data-dfn-for=CShakeParams id=dfn-CShakeParams-customization>customization</dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>
    <section id="cshake-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Digest</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`cSHAKE128`":
                </dt>
                <dd>
                  Let |result| be the result of performing the cSHAKE128 function
                  defined in Section 3 of [[NIST-SP800-185]] using
                  |message| as the |X| input parameter,
                  the {{CShakeParams/length}} member of |normalizedAlgorithm| as
                  the |L| input parameter,
                  <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{CShakeParams/functionName}} member of |normalizedAlgorithm| as
                  the |N| input parameter, and
                  <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{CShakeParams/customization}} member of |normalizedAlgorithm| as
                  the |S| input parameter.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`cSHAKE256`":
                </dt>
                <dd>
                  Let |result| be the result of performing the cSHAKE256 function
                  defined in Section 3 of [[NIST-SP800-185]] using
                  |message| as the |X| input parameter,
                  the {{CShakeParams/length}} member of |normalizedAlgorithm| as
                  the |L| input parameter,
                  <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{CShakeParams/functionName}} member of |normalizedAlgorithm| as
                  the |N| input parameter, and
                  <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{CShakeParams/customization}} member of |normalizedAlgorithm| as
                  the |S| input parameter.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If performing the operation results in an error, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Return a new ArrayBuffer containing |result|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="kmac">
    <h3>KMAC</h3>
    <section id="kmac-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes KMAC128 and KMAC256, as specified by
        [[NIST-SP800-185]].
      </p>
    </section>
    <section id="kmac-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-kmac128">KMAC128</code>" and
        "<code id="alg-kmac256">KMAC256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td>{{KmacParams}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>verify</td>
            <td>{{KmacParams}}</td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>{{KmacKeyGenParams}}</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>{{KmacImportParams}}</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
          <tr>
            <td>get key length</td>
            <td>{{KmacImportParams}}</td>
            <td>Integer</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="kmac-keygen-params">
      <h4><dfn data-idl id="dfn-KmacKeyGenParams">KmacKeyGenParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacKeyGenParams : Algorithm {
  [EnforceRange] unsigned long length;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacKeyGenParams id=dfn-KmacKeyGenParams-length>length</dfn> member represents the length (in bits) of the key to generate. If unspecified, the recommended length will be used, which is 128 for KMAC128 and 256 for KMAC256.</p>
    </section>
    <section id="kmac-importparams">
      <h4><dfn data-idl id="dfn-KmacImportParams">KmacImportParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacImportParams : Algorithm {
  [EnforceRange] unsigned long length;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacImportParams id=dfn-KmacImportParams-length>length</dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="KmacKeyAlgorithm-dictionary">
      <h4><dfn data-idl id="dfn-KmacKeyAlgorithm">KmacKeyAlgorithm</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacKeyAlgorithm : KeyAlgorithm {
  required unsigned long length;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacKeyAlgorithm id=dfn-KmacKeyAlgorithm-length>length</dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="kmac-params">
      <h4><dfn data-idl id="dfn-KmacParams">KmacParams</dfn> dictionary</h4>
      <pre class=idl>
dictionary KmacParams : Algorithm {
  required [EnforceRange] unsigned long length;
  BufferSource customization;
};
      </pre>
      <p>The <dfn data-dfn-for=KmacParams id=dfn-KmacParams-length>length</dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for=KmacParams id=dfn-KmacParams-customization>customization</dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>

    <section id="kmac-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Sign</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let |customization| be the <a href="#concept-contents-of-arraybuffer">contents of</a> the {{KmacParams/customization}} member of
                |normalizedAlgorithm| if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC128`":
                </dt>
                <dd>
                  Let |mac| be the result of performing the KMAC128 function
                  defined in Section 4 of [[NIST-SP800-185]] using
                  the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                  internal slot of |key| as the |K| input parameter,
                  |message| as the |X| input parameter,
                  the {{KmacParams/length}} member of |normalizedAlgorithm| as
                  the |L| input parameter, and
                  |customization| as
                  the |S| input parameter.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC256`":
                </dt>
                <dd>
                  Let |mac| be the result of performing the KMAC256 function
                  defined in Section 4 of [[NIST-SP800-185]] using
                  the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                  internal slot of |key| as the |K| input parameter,
                  |message| as the |X| input parameter,
                  the {{KmacParams/length}} member of |normalizedAlgorithm| as
                  the |L| input parameter, and
                  |customization| as
                  the |S| input parameter.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return the result of [= ArrayBuffer/create | creating =]
                an {{ArrayBuffer}} containing |mac|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Verify</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let |customization| be the <a href="#concept-contents-of-arraybuffer">contents of</a> the {{KmacParams/customization}} member of
                |normalizedAlgorithm| if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC128`":
                </dt>
                <dd>
                  Let |mac| be the result of performing the KMAC128 function
                  defined in Section 4 of [[NIST-SP800-185]] using
                  the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                  internal slot of |key| as the |K| input parameter,
                  |message| as the |X| input parameter,
                  the {{KmacParams/length}} member of |normalizedAlgorithm| as
                  the |L| input parameter, and
                  |customization| as
                  the |S| input parameter.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC256`":
                </dt>
                <dd>
                  Let |mac| be the result of performing the KMAC256 function
                  defined in Section 4 of [[NIST-SP800-185]] using
                  the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a>
                  internal slot of |key| as the |K| input parameter,
                  |message| as the |X| input parameter,
                  the {{KmacParams/length}} member of |normalizedAlgorithm| as
                  the |L| input parameter, and
                  |customization| as
                  the |S| input parameter.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return true if |mac| is equal to |signature| and false
                otherwise.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |usages| contains any entry which is not "`sign`" or
                "`verify`", then [= exception/throw =] a {{SyntaxError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the {{KmacKeyGenParams/length}} member of
                  |normalizedAlgorithm| is present:
                </dt>
                <dd>
                  Let |length| be equal to the
                  {{KmacKeyGenParams/length}}
                  member of |normalizedAlgorithm|.
                </dd>
                <dt>
                  Otherwise, if the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC128`":
                </dt>
                <dd>
                  Let |length| be 128.
                </dd>
                <dt>
                  Otherwise, if the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC256`":
                </dt>
                <dd>
                  Let |length| be 256.
                </dd>
              </dl>
            </li>

            <li>
              <p>
                Generate a key of length |length| bits.
              </p>
            </li>
            <li>
              <p>
                If the key generation step fails,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |key| be a new
                {{CryptoKey}} object representing the
                generated key.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new
                {{KmacKeyAlgorithm}}.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`KMAC`".
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal
                slot of |key| to be |extractable|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-usages">[[\usages]]</a> internal slot of
                |key| to be |usages|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let |keyData| be the key data to be imported.</p>
            </li>
            <li>
              <p>
                If |usages| contains an entry which is not
                "`sign`" or "`verify`",
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |data| be the [= octet string =] contained in |keyData|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If |keyData| is a {{JsonWebKey}} dictionary:</dt>
                        <dd><p>Let |jwk| equal |keyData|.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p>[= exception/Throw =] a {{DataError}}.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/kty}} field of |jwk| is not
                        "`oct`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If |jwk| does not meet the requirements of
                        Section 6.4 of JSON Web Algorithms [[JWA]],
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |data| be the [= octet string =] obtained by decoding the
                        {{JsonWebKey/k}} field of |jwk|.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the {{Algorithm/name}} member of
                          |normalizedAlgorithm| is a case-sensitive string match for
                          "`KMAC128`":
                        </dt>
                        <dd>
                          If the {{JsonWebKey/alg}} field of |jwk| is present
                          and is not "`K128`",
                          then [= exception/throw =] a
                          {{DataError}}.
                        </dd>
                        <dt>
                          If the {{Algorithm/name}} member of
                          |normalizedAlgorithm| is a case-sensitive string match for
                          "`KMAC256`":
                        </dt>
                        <dd>
                          If the {{JsonWebKey/alg}} field of |jwk| is present
                          and is not "`K256`",
                          then [= exception/throw =] a
                          {{DataError}}.
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If |usages| is non-empty and the {{JsonWebKey/use}} field of |jwk| is present and is
                        not "`sign`",
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/key_ops}} field of |jwk| is present, and
                        is invalid according to the requirements of
                        JSON Web Key [[JWK]] or
                        does not contain all of the specified |usages| values,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the {{JsonWebKey/ext}} field of |jwk| is present and
                        has the value false and |extractable| is true,
                        then [= exception/throw =] a
                        {{DataError}}.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  [= exception/throw =] a
                  {{NotSupportedError}}.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let |length| be equivalent to the length, in octets, of
                |data|, multiplied by 8.
              </p>
            </li>
            <li>
              <p>
                If |length| is zero
                then [= exception/throw =] a
                {{DataError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the {{KmacImportParams/length}} member of
                  |normalizedAlgorithm| is present:
                </dt>
                <dd>
                  <dl class="switch">
                    <dt>
                      If the {{KmacImportParams/length}} member of
                      |normalizedAlgorithm| is greater than |length|:
                    </dt>
                    <dd>
                      [= exception/throw =] a
                      {{DataError}}.
                    </dd>
                    <dt>
                      If the {{KmacImportParams/length}} member of
                      |normalizedAlgorithm|, is less than or equal to
                      |length| minus eight:
                    </dt>
                    <dd>
                      [= exception/throw =] a
                      {{DataError}}.
                    </dd>
                    <dt>
                      Otherwise:
                    </dt>
                    <dd>
                      Set |length| equal to the {{KmacImportParams/length}}
                      member of |normalizedAlgorithm|.
                    </dd>
                  </dl>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let |key| be a new `{{CryptoKey}}`
                object representing an KMAC key with the first |length|
                bits of |data|.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new
                {{KmacKeyAlgorithm}}.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to "`KMAC`".
              </p>
            </li>
            <li>
              <p>
                Set the {{KmacKeyAlgorithm/length}} attribute of
                |algorithm| to |length|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                cannot be accessed, then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Let |bits| be the raw bits of the key represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of
                |key|.
              </p>
            </li>
            <li>
              <p>
                Let |data| be an <a data-cite="WebCryptoAPI#octet-string-containing">octet string containing</a> |bits|.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If |format| is {{KeyFormat/"raw"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |result| be the result of [= ArrayBuffer/create | creating =]
                        an {{ArrayBuffer}} containing |data|.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If |format| is {{KeyFormat/"jwk"}}:</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let |jwk| be a new {{JsonWebKey}}
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `kty` attribute of |jwk| to the
                        string "`oct`".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the {{JsonWebKey/k}} attribute of |jwk| to be a string
                        containing |data|, encoded according to Section 6.4 of JSON Web Algorithms [[JWA]].
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |algorithm| be the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal slot of
                        |key|.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the {{Algorithm/name}} member of
                          |normalizedAlgorithm| is a case-sensitive string match for
                          "`KMAC128`":
                        </dt>
                        <dd>Set the `alg` attribute of |jwk| to
                          the string "`K128`".</dd>
                        <dt>
                          If the {{Algorithm/name}} member of
                          |normalizedAlgorithm| is a case-sensitive string match for
                          "`KMAC256`":
                        </dt>
                        <dd>Set the `alg` attribute of |jwk| to
                          the string "`K256`".</dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the `key_ops` attribute of |jwk| to equal the
                        {{CryptoKey/usages}} attribute of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the `ext` attribute of |jwk| to equal the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot
                        of |key|.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let |result| be the result of converting |jwk|
                        to an ECMAScript Object, as defined by [[WebIDL]].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    [= exception/throw =] a
                    {{NotSupportedError}}.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |result|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>
                  If the {{KmacImportParams/length}} member of
                  |normalizedAlgorithm| is present:
                </dt>
                <dd>
                  Let |length| be equal to the
                  {{KmacImportParams/length}}
                  member of |normalizedAlgorithm|.
                </dd>
                <dt>
                  Otherwise, if the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC128`":
                </dt>
                <dd>
                  Let |length| be 128.
                </dd>
                <dt>
                  Otherwise, if the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`KMAC256`":
                </dt>
                <dd>
                  Let |length| be 256.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return |length|.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="argon2">
    <h3>Argon2</h3>
    <section id="argon2-description" class="informative">
      <h4>Description</h4>
      <p>
        This describes the Argon2 function for password hashing and key derivation,
        as defined in [[RFC9106]].
      </p>
    </section>
    <section id="argon2-registration">
      <h4>Registration</h4>
      <p>
        The <a data-cite="WebCryptoAPI#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-argon2d">Argon2d</code>",
        "<code id="alg-argon2i">Argon2i</code>", and
        "<code id="alg-argon2id">Argon2id</code>" for the respective Argon2 types.
      </p>
      <table>
        <thead>
          <tr>
            <th><a data-cite="WebCryptoAPI#supported-operations">Operation</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-specific-params">Parameters</a></th>
            <th><a data-cite="WebCryptoAPI#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td>{{Argon2Params}}</td>
            <td>{{ArrayBuffer}}</td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td>{{CryptoKey}}</td>
          </tr>
          <tr>
            <td>Get key length</td>
            <td>None</td>
            <td>null</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="argon2-params">
      <h4><dfn data-idl id="dfn-Argon2Params">Argon2Params</dfn> dictionary</h4>
      <pre class=idl>
dictionary Argon2Params : Algorithm {
  required BufferSource nonce;
  required [EnforceRange] unsigned long parallelism;
  required [EnforceRange] unsigned long memory;
  required [EnforceRange] unsigned long passes;
  [EnforceRange] octet version;
  BufferSource secretValue;
  BufferSource associatedData;
};
      </pre>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-nonce>nonce</dfn> member represents the nonce, which is a salt for password hashing applications.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-parallelism>parallelism</dfn> member represents the degree of parallelism.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-memory>memory</dfn> member represents the memory size in kibibytes. It must be at least 8 times the degree of parallelism.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-passes>passes</dfn> member represents the number of passes.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-version>version</dfn> member represents the version number. The default and currently only defined version is 19 (0x13).</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-secretValue>secretValue</dfn> member represents the optional secret value.</p>
      <p>The <dfn data-dfn-for=Argon2Params id=dfn-Argon2Params-associatedData>associatedData</dfn> member represents the optional associated data.</p>
      <p class="note">
        For the recommended values of the parameters, see section 4 of [[RFC9106]].
      </p>
    </section>
    <section id="argon2-operations">
      <h4>Operations</h4>
      <dl>
        <dt>Derive Bits</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |length| is null, or is less than 32 (4*8), then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{Argon2Params/version}} member
                of |normalizedAlgorithm| is present and is not 19 (0x13),
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{Argon2Params/parallelism}} member of |normalizedAlgorithm| is zero,
                or greater than 16777215 (2^24-1),
                then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{Argon2Params/memory}} member of |normalizedAlgorithm| is less than
                8 times the {{Argon2Params/parallelism}} member of |normalizedAlgorithm|,
                then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                If the {{Argon2Params/passes}} member of |normalizedAlgorithm| is zero,
                then [= exception/throw =] an {{OperationError}}.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`Argon2d`":
                </dt>
                <dd>
                  Let |type| be 0.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`Argon2i`":
                </dt>
                <dd>
                  Let |type| be 1.
                </dd>
                <dt>
                  If the {{Algorithm/name}} member of
                  |normalizedAlgorithm| is a case-sensitive string match for
                  "`Argon2id`":
                </dt>
                <dd>
                  Let |type| be 2.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let |secretValue| be <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{Argon2Params/secretValue}} member of
                |normalizedAlgorithm|, if present.
              </p>
            </li>
            <li>
              <p>
                Let |associatedData| be <a href="#concept-contents-of-arraybuffer">the contents of</a> the {{Argon2Params/associatedData}} member of
                |normalizedAlgorithm|, if present.
              </p>
            </li>
            <li>
              <p>
                Let |result| be the result of performing the Argon2 function defined
                in Section 3 of [[RFC9106]] using
                the password represented by <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-handle">[[\handle]]</a> internal slot of |key|
                as the message, |P|, <a href="#concept-contents-of-arraybuffer">the
                contents of</a> the {{Argon2Params/nonce}} attribute of
                |normalizedAlgorithm| as the nonce, |S|,
                the value of the {{Argon2Params/parallelism}} attribute
                of |normalizedAlgorithm| as the degree of parallelism, |p|,
                the value of the {{Argon2Params/memory}} attribute
                of |normalizedAlgorithm| as the memory size, |m|,
                the value of the {{Argon2Params/passes}} attribute
                of |normalizedAlgorithm| as the number of passes, |t|,
                0x13 as the version number, |v|,
                |secretValue| (if present) as the secret value, |K|,
                |associatedData| (if present) as the associated data, |X|,
                |type| as the type, |y|, and
                |length| divided by 8 as the tag length, |T|.
              </p>
            </li>
            <li>
              <p>
                If the key derivation operation fails,
                then [= exception/throw =] an
                {{OperationError}}.
              </p>
            </li>
            <li>
              <p>
                Return |result|
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If |format| is not {{KeyFormat/"raw"}}, [= exception/throw =] a {{NotSupportedError}}
              </p>
            </li>
            <li>
              <p>
                If |usages| contains a value that is not
                "`deriveKey`"  or "`deriveBits`", then
                [= exception/throw =] a {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                If |extractable| is not `false`,
                then [= exception/throw =] a
                {{SyntaxError}}.
              </p>
            </li>
            <li>
              <p>
                Let |key| be a new {{CryptoKey}}
                representing |keyData|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-type">[[\type]]</a> internal slot of
                |key| to {{KeyType/"secret"}}.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-extractable">[[\extractable]]</a> internal slot of
                |key| to `false`.
              </p>
            </li>
            <li>
              <p>
                Let |algorithm| be a new {{KeyAlgorithm}}
                object.
              </p>
            </li>
            <li>
              <p>
                Set the {{KeyAlgorithm/name}} attribute of
                |algorithm| to the {{Algorithm/name}} member of
                |normalizedAlgorithm|.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-cite="WebCryptoAPI#dfn-CryptoKey-slot-algorithm">[[\algorithm]]</a> internal
                slot of |key| to |algorithm|.
              </p>
            </li>
            <li>
              <p>
                Return |key|.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <p>
                Return null.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section>
    <h2>Usage Example</h2>
    <p>
      This example derives a key from a password using Argon2, if available, or PBKDF2, otherwise;
      and then encrypts and decrypts some text with it using AES-OCB, if available, and AES-GCM, otherwise.
    </p>
    <pre class="example js" title="Encrypt some data using a key derived from a password">
      const password = 'correct horse battery staple';
      const derivationAlg =
        crypto.subtle.supports?.('importKey', 'Argon2id') ?
          'Argon2id' :
          'PBKDF2';
      const encryptionAlg =
        crypto.subtle.supports?.('importKey', 'AES-OCB') ?
          'AES-OCB' :
          'AES-GCM';
      const passwordKey = await crypto.subtle.importKey(
        'raw',
        new TextEncoder().encode(password),
        derivationAlg,
        /* extractable: */ false,
        ['deriveKey']
      );
      const nonce = crypto.getRandomValues(new Uint8Array(16));
      const derivationParams =
        derivationAlg === 'Argon2id' ?
          {
            nonce,
            parallelism: 4,
            memory: 2 ** 21,
            passes: 1
          } :
          {
            salt: nonce,
            iterations: 100_000,
            hash: 'SHA-256'
          };
      const key = await crypto.subtle.deriveKey(
        {
          name: derivationAlg,
          ...derivationParams
        },
        passwordKey,
        {
          name: encryptionAlg,
          length: 256
        },
        /* extractable: */ false,
        ['encrypt', 'decrypt']
      );
      const plaintext = 'Hello, world!';
      const iv = crypto.getRandomValues(new Uint8Array(16));
      const encrypted = await crypto.subtle.encrypt(
        { name: encryptionAlg, iv },
        key,
        new TextEncoder().encode(plaintext)
      );
      // Store the derivation and encryption algorithm and parameters
      // as well as the ciphertext (e.g. in IndexedDB or a database),
      // and retrieve them later. Then, derive the key using the
      // original parameters and the password. Here we immediately
      // use the same key object to decrypt again.
      const decrypted = new TextDecoder().decode(await crypto.subtle.decrypt(
        { name: encryptionAlg, iv },
        key,
        encrypted
      ));
    </pre>
  </section>

  <section id="jwk-mapping" class="appendix informative">
    <h2>Mapping between JSON Web Key / JSON Web Algorithm</h2>
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting JWK.
    </p>
    <h3>Algorithm mappings</h3>
    <table>
      <thead>
        <tr>
          <th scope="col">JSON Web Key</th>
          <th scope="col">AlgorithmIdentifier</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "A128OCB" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "AES-OCB",
length: 128 }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "A192OCB" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "AES-OCB",
length: 192 }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "A256OCB" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "AES-OCB",
length: 256 }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "CC20P1305" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "ChaCha20-Poly1305" }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "K128" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "KMAC128" }
</pre>
          </td>
        </tr>
        <tr>
          <td>
<pre class=js>
{ kty: "oct",
alg: "K256" }
</pre>
          </td>
          <td>
<pre class=js>
{ name: "KMAC256" }
</pre>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="todo">TODO: register A128OCB, A192OCB, A256OCB, CC20P1305, K128 and K256(?) with IANA in the JSON Web Signature and Encryption Algorithms registry.</div>
  </section>

  <section id="conformance"></section>
</body>

</html>
