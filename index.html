<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 35.1.2">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000;color:var(--text,#000)}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;background:var(--def-border,#8ccbf2);color:#fff;color:var(--defrow-border,#fff);font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none;color:inherit}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
<title>Modern Algorithms in the Web Cryptography API</title>
  
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
  

<meta name="color-scheme" content="light">
<meta name="description" content="This specification defines a number of modern cryptographic algorithms
      for the Web Cryptography API, namely AES-OCB, ChaCha20-Poly1305, SHA-3, cSHAKE, KMAC, and Argon2.">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "github": "twiss/webcrypto-modern-algos",
  "editors": [
    {
      "name": "Daniel Huigens",
      "url": "mailto:daniel.huigens@proton.ch",
      "company": "Proton AG",
      "companyURL": "https://proton.me/"
    }
  ],
  "shortName": "webcrypto-modern-algos",
  "specStatus": "CG-DRAFT",
  "group": "wicg",
  "xref": [
    "WebIDL",
    "WebCryptoAPI",
    "infra"
  ],
  "localBiblio": {
    "JWA": {
      "aliasOf": "RFC7518"
    },
    "FIPS-202": {
      "title": "SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions",
      "href": "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf",
      "publisher": "NIST",
      "date": "August 2015",
      "id": "fips-202"
    },
    "NIST-SP800-185": {
      "title": "NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash",
      "href": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf",
      "publisher": "NIST",
      "date": "December 2016",
      "id": "nist-sp800-185"
    }
  },
  "publishISODate": "2024-09-17T00:00:00.000Z",
  "generatedSubtitle": "Draft Community Group Report 17 September 2024"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-draft"></head>

<body class="h-entry" data-cite="WEBIDL WebIDL WebCryptoAPI infra"><div class="head">
    
    <h1 id="title" class="title">Modern Algorithms in the Web Cryptography API</h1> 
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Draft Community Group Report</a>
      <time class="dt-published" datetime="2024-09-17">17 September 2024</time>
    </p>
    <dl>
      
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/webcrypto-modern-algos/">https://www.w3.org/webcrypto-modern-algos/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://twiss.github.io/webcrypto-modern-algos/">https://twiss.github.io/webcrypto-modern-algos/</a></dd>
      
      
      
      
      <dt>Editor:</dt><dd class="editor p-author h-card vcard">
    <a class="ed_mailto u-email email p-name" href="mailto:daniel.huigens@proton.ch">Daniel Huigens</a> (<a class="p-org org h-org" href="https://proton.me/">Proton AG</a>)
  </dd>
      
      
      <dt>Feedback:</dt><dd>
        <a href="https://github.com/twiss/webcrypto-modern-algos/">GitHub twiss/webcrypto-modern-algos</a>
        (<a href="https://github.com/twiss/webcrypto-modern-algos/pulls/">pull requests</a>,
        <a href="https://github.com/twiss/webcrypto-modern-algos/issues/new/choose">new issue</a>,
        <a href="https://github.com/twiss/webcrypto-modern-algos/issues/">open issues</a>)
      </dd>
      
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/policies/#copyright">Copyright</a>
          ©
          2024
          
          the Contributors to the Modern Algorithms in the Web Cryptography API
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/wicg">Web Platform Incubator Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2>
    <p>
      This specification defines a number of modern cryptographic algorithms
      for the <cite><a data-matched-text="[[[WebCryptoAPI]]]" href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a></cite>, namely AES-OCB, ChaCha20-Poly1305, SHA-3, cSHAKE, KMAC, and Argon2.
    </p>
  </section>
  <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/wicg">Web Platform Incubator Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>
            there is a limited opt-out and other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
    <p>
      This is an unofficial proposal.
    </p>
  <p>
    <a href="https://github.com/twiss/webcrypto-modern-algos/issues/">GitHub Issues</a> are preferred for
          discussion of this specification.
        
    
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#specification-conventions"><bdi class="secno">2. </bdi>Specification Conventions</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">3. </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#partial-subtlecrypto-interface"><bdi class="secno">4. </bdi>Partial SubtleCrypto interface</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#partial-subtlecrypto-interface-methods"><bdi class="secno">4.1 </bdi>Methods and Parameters</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#SubtleCrypto-method-supports"><bdi class="secno">4.1.1 </bdi>The supports method</a></li></ol></li><li class="tocline"><a class="tocxref" href="#partial-subtlecrypto-interface-checking-support-for-algorithm"><bdi class="secno">4.2 </bdi>Checking support for an algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#aes-ocb"><bdi class="secno">5. </bdi>AES-OCB</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#aes-ocb-description"><bdi class="secno">5.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-registration"><bdi class="secno">5.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#aead-params"><bdi class="secno">5.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="AeadParams" data-dfn-for=""><code>AeadParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#aes-ocb-operations"><bdi class="secno">5.4 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305"><bdi class="secno">6. </bdi>ChaCha20-Poly1305</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-description"><bdi class="secno">6.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-registration"><bdi class="secno">6.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#chacha20-poly1305-operations"><bdi class="secno">6.3 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#sha3"><bdi class="secno">7. </bdi>SHA-3</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#sha3-description"><bdi class="secno">7.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#sha3-registration"><bdi class="secno">7.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#sha3-operations"><bdi class="secno">7.3 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#cshake"><bdi class="secno">8. </bdi>cSHAKE</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#cshake-description"><bdi class="secno">8.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#cshake-registration"><bdi class="secno">8.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#cshake-params"><bdi class="secno">8.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="CShakeParams" data-dfn-for=""><code>CShakeParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#cshake-operations"><bdi class="secno">8.4 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#kmac"><bdi class="secno">9. </bdi>KMAC</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#kmac-description"><bdi class="secno">9.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#kmac-registration"><bdi class="secno">9.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#kmac-keygen-params"><bdi class="secno">9.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacKeyGenParams" data-dfn-for=""><code>KmacKeyGenParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#kmac-importparams"><bdi class="secno">9.4 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacImportParams" data-dfn-for=""><code>KmacImportParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#KmacKeyAlgorithm-dictionary"><bdi class="secno">9.5 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacKeyAlgorithm" data-dfn-for=""><code>KmacKeyAlgorithm</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#kmac-params"><bdi class="secno">9.6 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="KmacParams" data-dfn-for=""><code>KmacParams</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#kmac-operations"><bdi class="secno">9.7 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#argon2"><bdi class="secno">10. </bdi>Argon2</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#argon2-description"><bdi class="secno">10.1 </bdi>Description</a></li><li class="tocline"><a class="tocxref" href="#argon2-registration"><bdi class="secno">10.2 </bdi>Registration</a></li><li class="tocline"><a class="tocxref" href="#argon2-params"><bdi class="secno">10.3 </bdi><span data-idl="dictionary" data-export="" data-dfn-type="dictionary" data-title="Argon2Params" data-dfn-for=""><code>Argon2Params</code></span> dictionary</a></li><li class="tocline"><a class="tocxref" href="#argon2-operations"><bdi class="secno">10.4 </bdi>Operations</a></li></ol></li><li class="tocline"><a class="tocxref" href="#usage-example"><bdi class="secno">11. </bdi>Usage Example</a></li><li class="tocline"><a class="tocxref" href="#jwk-mapping"><bdi class="secno">A. </bdi>Mapping between JSON Web Key / JSON Web Algorithm</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#algorithm-mappings"><bdi class="secno">A.1 </bdi>Algorithm mappings</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">B. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">C. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">C.1 </bdi>Normative references</a></li></ol></li></ol></nav>
  <section id="introduction" class="informative"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      This proposal aims to modernize the set of cryptographic algorithms
      available in the <cite><a data-matched-text="[[[WebCryptoAPI]]]" href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a></cite>, such that web applications can
      make use of the most secure and performant options available.
      To this end, the following cryptographic algorithms are added:
      </p><ul>
        <li><a href="#aes-ocb">AES-OCB</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>]</li>
        <li><a href="#chacha20-poly1305">ChaCha20-Poly1305</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>]</li>
        <li><a href="#sha3">SHA3-256, SHA3-384, and SHA3-512</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>]</li>
        <li><a href="#cshake">cSHAKE128, cSHAKE256</a>, <a href="#kmac">KMAC128 and KMAC256</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>]</li>
        <li><a href="#argon2">Argon2d, Argon2i, and Argon2id</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>]</li>
      </ul>
    <p></p>
    <p>
      Additionally, this proposal aims to make feature detection easier,
      by adding a <a href="#dfn-SubtleCrypto-method-supports" id="ref-for-dfn-SubtleCrypto-method-supports-1"><code>SubtleCrypto.supports</code></a> function,
      which can be used to detect whether a given algorithm identifier
      (including any parameters) is supported for the given operation.
    </p>
  </section>
  <section id="specification-conventions"><div class="header-wrapper"><h2 id="x2-specification-conventions"><bdi class="secno">2. </bdi>Specification Conventions</h2><a class="self-link" href="#specification-conventions" aria-label="Permalink for Section 2."></a></div>
    
    <p>
      This specification follows the <a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-conventions">conventions</a>
      laid out in Section 18.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcryptoapi" title="Web Cryptography API">WebCryptoAPI</a></cite>]. None of the algorithms defined here
      are required to be implemented, but if a conforming User Agent implements an
      algorithm, it <em class="rfc2119">MUST</em> implement all of the supported operations specified in this
      document, and must perform the steps to <a href="https://www.w3.org/TR/WebCryptoAPI/#concept-define-an-algorithm">define an algorithm</a>
      specified in section 18.4.3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcryptoapi" title="Web Cryptography API">WebCryptoAPI</a></cite>] for each of the supported operations.
    </p>
  </section>
  <section id="terminology"><div class="header-wrapper"><h2 id="x3-terminology"><bdi class="secno">3. </bdi>Terminology</h2><a class="self-link" href="#terminology" aria-label="Permalink for Section 3."></a></div>
    
    <p>
      An <dfn id="dfn-octet-string" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">octet string</dfn> is an ordered sequence of zero or more
      integers, each in the range 0 to 255 inclusive.
    </p>
    <p>
      When this specification states to supply the <dfn id="concept-contents-of-arraybuffer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
      contents of an ArrayBuffer</dfn> named <var>data</var> to an underlying cryptographic
      implementation, the User Agent shall supply a contiguous sequence of bytes that is equal
      to the result of
      <a data-link-type="dfn|abstract-op" data-lt="get a copy of the buffer source" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy">getting a copy of the bytes</a>
      held <var>data</var>.
    </p>
  </section>

  <section id="partial-subtlecrypto-interface"><div class="header-wrapper"><h2 id="x4-partial-subtlecrypto-interface"><bdi class="secno">4. </bdi>Partial SubtleCrypto interface</h2><a class="self-link" href="#partial-subtlecrypto-interface" aria-label="Permalink for Section 4."></a></div>
    
    <p>
      This section extends the <a data-link-type="idl" data-lt="SubtleCrypto" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto"><code>SubtleCrypto</code></a> interface of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcryptoapi" title="Web Cryptography API">WebCryptoAPI</a></cite>].
    </p>
    <pre class="idl def" id="webidl-1336939281"><span class="idlHeader"><a class="self-link" href="#webidl-1336939281">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-subtlecrypto-partial-1" data-title="SubtleCrypto">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext">SecureContext</a></span>,<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window,Worker)</span>]
partial interface <a data-idl="partial" data-link-type="interface" data-title="SubtleCrypto" class="idlID" data-dfn-for="SubtleCrypto" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-SubtleCrypto">SubtleCrypto</a> {<span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-supports-operation-algorithm-length" data-title="supports" data-dfn-for="SubtleCrypto">
  static<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-supports" id="ref-for-dfn-SubtleCrypto-method-supports-2"><code>supports</code></a>(<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">operation</span>,<span class="idlType">
                   <a data-link-type="idl" data-type="typedef" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">algorithm</span>,
                   optional<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a>?</span> <span class="idlParamName">length</span> = null);</span><span data-idl="" class="idlMethod" id="idl-def-subtlecrypto-supports!overload-1" data-title="supports!overload-1" data-dfn-for="SubtleCrypto">
  static<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <a class="internalDFN idlName" data-link-type="method" href="#dfn-SubtleCrypto-method-supports-additionalAlgorithm" id="ref-for-dfn-SubtleCrypto-method-supports-additionalAlgorithm-1"><code>supports</code></a>(<span class="idlType"><a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <span class="idlParamName">operation</span>,<span class="idlType">
                   <a data-link-type="idl" data-type="typedef" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">algorithm</span>,<span class="idlType">
                   <a data-link-type="idl" data-type="typedef" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithmidentifier">AlgorithmIdentifier</a></span> <span class="idlParamName">additionalAlgorithm</span>);</span>
};</span></code></pre>

    <section id="partial-subtlecrypto-interface-methods"><div class="header-wrapper"><h3 id="x4-1-methods-and-parameters"><bdi class="secno">4.1 </bdi>Methods and Parameters</h3><a class="self-link" href="#partial-subtlecrypto-interface-methods" aria-label="Permalink for Section 4.1"></a></div>
      
      <section id="SubtleCrypto-method-supports"><div class="header-wrapper"><h4 id="x4-1-1-the-supports-method"><bdi class="secno">4.1.1 </bdi>The supports method</h4><a class="self-link" href="#SubtleCrypto-method-supports" aria-label="Permalink for Section 4.1.1"></a></div>
        
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports" data-dfn-for="SubtleCrypto" data-lt="supports(operation, algorithm, length)|supports()|supports(operation, algorithm)" data-export="" data-dfn-type="method" data-idl="operation" data-title="supports(operation, algorithm, length)" data-type="boolean" data-local-lt="SubtleCrypto.supports|SubtleCrypto.supports()|supports" tabindex="0" aria-haspopup="dialog"><code>supports(<var>operation</var>, <var>algorithm</var>, <var>length</var>)</code></dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified <a data-link-type="idl" data-lt="AlgorithmIdentifier" data-type="typedef" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithmidentifier"><code>AlgorithmIdentifier</code></a>,
          with an optional <code>length</code> parameter to indicate the number of bits to be derived when <code>operation</code> is "<code>deriveBits</code>".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If <var>operation</var> is not one of
              "<code>encrypt</code>", "<code>decrypt</code>", "<code>sign</code>", "<code>verify</code>",
              "<code>digest</code>", "<code>generateKey</code>", "<code>deriveKey</code>", "<code>deriveBits</code>",
              "<code>importKey</code>", "<code>exportKey</code>", "<code>wrapKey</code>" or "<code>unwrapKey</code>",
              return false.
            </p>
          </li>
          <li>
            <p>
              Return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-1">checking support for an algorithm</a>,
              with <code>op</code> set to <var>operation</var>, <code>alg</code> set to <var>algorithm</var>,
              and <code>length</code> set to <var>length</var>.
            </p>
          </li>
        </ol>
        <p>
          The <dfn id="dfn-SubtleCrypto-method-supports-additionalAlgorithm" data-dfn-for="SubtleCrypto" data-lt="supports(operation, algorithm, additionalAlgorithm)|supports!overload-1()|supports!overload-1(operation, algorithm, additionalAlgorithm)" data-export="" data-dfn-type="method" data-idl="operation" data-title="supports(operation, algorithm, additionalAlgorithm)" data-type="boolean" data-local-lt="SubtleCrypto.supports!overload-1|SubtleCrypto.supports!overload-1()|supports!overload-1" tabindex="0" aria-haspopup="dialog"><code>supports(<var>operation</var>, <var>algorithm</var>, <var>additionalAlgorithm</var>)</code></dfn>
          method returns a boolean indicating whether the implementation
          supports the given operation using the specified <a data-link-type="idl" data-lt="AlgorithmIdentifier" data-type="typedef" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithmidentifier"><code>AlgorithmIdentifier</code></a>.
          The additional algorithm indicates the type of key to be derived when <code>operation</code> is "<code>deriveKey</code>",
          the type of key to be exported before wrapping when <code>operation</code> is "<code>wrapKey</code>",
          and the type of key to be imported after unwrapping when <code>operation</code> is "<code>unwrapKey</code>".
          It behaves as follows:
        </p>
        <ol>
          <li>
            <p>
              If <var>operation</var> is not one of
              "<code>encrypt</code>", "<code>decrypt</code>", "<code>sign</code>", "<code>verify</code>",
              "<code>digest</code>", "<code>generateKey</code>", "<code>deriveKey</code>", "<code>deriveBits</code>",
              "<code>importKey</code>", "<code>exportKey</code>", "<code>wrapKey</code>" or "<code>unwrapKey</code>",
              return false.
            </p>
          </li>
          <li>
            <dl class="switch">
              <dt>If <var>operation</var> is "<code>deriveKey</code>":</dt>
              <dd>
                <p>
                  If the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-2">checking support for an algorithm</a>
                  with <code>op</code> set to "<code>importKey</code>"
                  and <code>alg</code> set to <var>additionalAlgorithm</var>
                  is false, or
                  the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-3">checking support for an algorithm</a>
                  with <code>op</code> set to "<code>get key length</code>"
                  and <code>alg</code> set to <var>additionalAlgorithm</var>
                  is false,
                  return false.
                </p>
              </dd>
              <dt>If <var>operation</var> is "<code>wrapKey</code>":</dt>
              <dd>
                <p>
                  If the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-4">checking support for an algorithm</a>
                  with <code>op</code> set to "<code>exportKey</code>"
                  and <code>alg</code> set to <var>additionalAlgorithm</var>
                  is false,
                  return false.
                </p>
              </dd>
              <dt>If <var>operation</var> is "<code>unwrapKey</code>":</dt>
              <dd>
                <p>
                  If the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-5">checking support for an algorithm</a>
                  with <code>op</code> set to "<code>importKey</code>"
                  and <code>alg</code> set to <var>additionalAlgorithm</var>
                  is false,
                  return false.
                </p>
              </dd>
            </dl>
          </li>
          <li>
            <p>
              Return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-6">checking support for an algorithm</a>,
              with <code>op</code> set to <var>operation</var> and <code>alg</code> set to <var>algorithm</var>.
            </p>
          </li>
        </ol>
      </section>
    </section>

    <section id="partial-subtlecrypto-interface-checking-support-for-algorithm"><div class="header-wrapper"><h3 id="x4-2-checking-support-for-an-algorithm"><bdi class="secno">4.2 </bdi>Checking support for an algorithm</h3><a class="self-link" href="#partial-subtlecrypto-interface-checking-support-for-algorithm" aria-label="Permalink for Section 4.2"></a></div>
      
      <p>
        The <dfn id="dfn-check-support-for-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">check support for an algorithm</dfn> algorithm
        defines a process for checking whether the given algorithm is supported for the given operation.
        Its input is an operation name <var>op</var>, an <a data-link-type="idl" data-lt="AlgorithmIdentifier" data-type="typedef" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithmidentifier"><code>AlgorithmIdentifier</code></a> <var>alg</var>,
        and an optional <var>length</var> parameter. Its output is a boolean.
        It behaves as follows:
      </p>
      <ol>
        <li>
          <p>
            If <var>op</var> is "<code>deriveKey</code>", set <var>op</var> is "<code>deriveBits</code>".
          </p>
        </li>
        <li>
          <p>
            Let <var>normalizedAlgorithm</var> be the result of
            <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-normalize-an-algorithm">normalizing an algorithm</a>, with
            <code>alg</code> set to <var>alg</var> and <code>op</code> set to <var>op</var>.
          </p>
        </li>
        <li>
          <dl class="switch">
            <dt>If an error occurred:</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    If <var>op</var> is "<code>wrapKey</code>",
                    return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-7">checking support for an algorithm</a>
                    with <code>op</code> set to "<code>encrypt</code>"
                    and <code>alg</code> set to <var>alg</var>.
                  </p>
                </li>
                <li>
                  <p>
                    If <var>op</var> is "<code>unwrapKey</code>",
                    return the result of <a data-link-type="dfn|abstract-op" data-lt="check support for an algorithm" href="#dfn-check-support-for-algorithm" class="internalDFN" id="ref-for-dfn-check-support-for-algorithm-8">checking support for an algorithm</a>
                    with <code>op</code> set to "<code>decrypt</code>"
                    and <code>alg</code> set to <var>alg</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Otherwise, return false.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </li>
        <li>
          <p>
            If the specified operation or algorithm (or one of its parameter values)
            is expected to fail (for any key and/or data) for an implementation-specific reason
            (e.g. known nonconformance to the specification), return false.
          </p>
        </li>
        <li>
          <p>
            If <var>op</var> is "<code>generateKey</code>" or "<code>importKey</code>", let <var>usages</var> be the empty list.
          </p>
        </li>
        <li>
          <p>
            For each of the steps of the operation specified by <var>op</var>
            of the algorithm specified by <var>normalizedAlgorithm</var>:
          </p>
          <dl class="switch">
            <dt>
              If the step says to <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an error:
            </dt>
            <dd>
              Return false.
            </dd>
            <dt>
              If the step says to generate a key:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step relies on an unavailable parameter, such as <code>key</code>, <code>plaintext</code> or <code>ciphertext</code>:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              If the step says to return a value:
            </dt>
            <dd>
              Return true.
            </dd>
            <dt>
              Otherwise:
            </dt>
            <dd>
              Execute the step.
            </dd>
          </dl>
          <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><p class="">
            The steps in the referenced algorithm may access the <var>normalizedAlgorithm</var>,
            <var>length</var>, and <var>usages</var> variables from this context.
          </p></div>
        </li>
        <li>
          <p>
            <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://infra.spec.whatwg.org/#assert">Assert</a>: this step is never reached,
            because one of the steps of the operation will have said
            to return a value or throw an error, causing us to return
            true or false, respectively.
          </p>
        </li>
      </ol>
    </section>
  </section>

  <section id="aes-ocb"><div class="header-wrapper"><h2 id="x5-aes-ocb"><bdi class="secno">5. </bdi>AES-OCB</h2><a class="self-link" href="#aes-ocb" aria-label="Permalink for Section 5."></a></div>
    
    <section id="aes-ocb-description" class="informative"><div class="header-wrapper"><h3 id="x5-1-description"><bdi class="secno">5.1 </bdi>Description</h3><a class="self-link" href="#aes-ocb-description" aria-label="Permalink for Section 5.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>AES-OCB</code>" algorithm identifier is used to perform
        authenticated encryption and decryption using AES in OCB mode,
        as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>].
      </p>
    </section>
    <section id="aes-ocb-registration"><div class="header-wrapper"><h3 id="x5-2-registration"><bdi class="secno">5.2 </bdi>Registration</h3><a class="self-link" href="#aes-ocb-registration" aria-label="Permalink for Section 5.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "<code>AES-OCB</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-1"><code>AeadParams</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-2"><code>AeadParams</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td><a data-link-type="idl" data-lt="AesKeyGenParams" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams"><code>AesKeyGenParams</code></a></td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td><a data-link-type="idl" data-lt="AesDerivedKeyParams" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams"><code>AesDerivedKeyParams</code></a></td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="aead-params"><div class="header-wrapper"><h3 id="x5-3-aeadparams-dictionary"><bdi class="secno">5.3 </bdi><dfn data-idl="dictionary" id="dfn-AeadParams" data-export="" data-dfn-type="dictionary" data-title="AeadParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>AeadParams</code></dfn> dictionary</h3><a class="self-link" href="#aead-params" aria-label="Permalink for Section 5.3"></a></div>
      
      <pre class="idl def" id="webidl-1353594407"><span class="idlHeader"><a class="self-link" href="#webidl-1353594407">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-aeadparams" data-title="AeadParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-AeadParams" id="ref-for-dfn-AeadParams-3"><code>AeadParams</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-aeadparams-iv" data-title="iv" data-dfn-for="AeadParams">
  required<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-AeadParams-iv" id="ref-for-dfn-AeadParams-iv-1"><code>iv</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-aeadparams-additionaldata" data-title="additionalData" data-dfn-for="AeadParams"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-AeadParams-additionalData" id="ref-for-dfn-AeadParams-additionalData-1"><code>additionalData</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-aeadparams-taglength" data-title="tagLength" data-dfn-for="AeadParams">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-octet">octet</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-AeadParams-tagLength" id="ref-for-dfn-AeadParams-tagLength-1"><code>tagLength</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="AeadParams" id="dfn-AeadParams-iv" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="iv" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>iv</code></dfn> member represents the initialization vector to use.</p>
      <p>The <dfn data-dfn-for="AeadParams" id="dfn-AeadParams-additionalData" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="additionalData" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>additionalData</code></dfn> member represents the additional authentication data to include.</p>
      <p>The <dfn data-dfn-for="AeadParams" id="dfn-AeadParams-tagLength" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="tagLength" data-type="octet" tabindex="0" aria-haspopup="dialog"><code>tagLength</code></dfn> member represents the desired length of the authentication tag.</p>
      <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><div class="">
        <p>
          The <a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-4"><code>AeadParams</code></a> dictionary is identical to the <a data-link-type="idl" data-lt="AesGcmParams" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesGcmParams"><code>AesGcmParams</code></a> dictionary of [<cite><a class="bibref" data-link-type="biblio" href="#bib-webcryptoapi" title="Web Cryptography API">WebCryptoAPI</a></cite>],
          and the latter may be replaced by the former when merging this proposal.
        </p>
      </div></div>
    </section>
    <section id="aes-ocb-operations"><div class="header-wrapper"><h3 id="x5-4-operations"><bdi class="secno">5.4 </bdi>Operations</h3><a class="self-link" href="#aes-ocb-operations" aria-label="Permalink for Section 5.4"></a></div>
      
      <dl>
        <dt>Encrypt</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-2"><code>iv</code></a> member of
                <var>normalizedAlgorithm</var> has a length greater than 15
                bytes,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-2"><code>tagLength</code></a> member of
                <var>normalizedAlgorithm</var> is not present:</dt>
                <dd>Let <var>tagLength</var> be 128.</dd>
                <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-3"><code>tagLength</code></a> member of
                <var>normalizedAlgorithm</var> is one of 64, 96 or 128:</dt>
                <dd>Let <var>tagLength</var> be equal to the
                <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-4"><code>tagLength</code></a> member of
                 <var>normalizedAlgorithm</var></dd>
                <dt>Otherwise:</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                  <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let <var>additionalData</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-1">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-2"><code>additionalData</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Let <var>C</var> be the output that results from performing
                the OCB-ENCRYPT function described in Section 4.2 of
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>] using AES as the block cipher, using
                the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                internal slot of <var>key</var> as the <var>K</var> input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-2">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-3"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
                the <var>N</var> input parameter, <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-3">the contents of
                <var>additionalData</var></a> as the <var>A</var> input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-4">the contents of
                <var>plaintext</var></a> as the <var>P</var> input parameter, and
                <var>tagLength</var> as the <var>TAGLEN</var> global parameter.
              </p>
            </li>
            <li>
              <p>
                Return the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>C</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Decrypt</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-4"><code>iv</code></a> member of
                <var>normalizedAlgorithm</var> has a length greater than 15
                bytes,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-5"><code>tagLength</code></a> member of
                <var>normalizedAlgorithm</var> is not present:</dt>
                <dd>Let <var>tagLength</var> be 128.</dd>
                <dt>If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-6"><code>tagLength</code></a> member of
                <var>normalizedAlgorithm</var> is one of 64, 96 or 128:</dt>
                <dd>Let <var>tagLength</var> be equal to the
                <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-7"><code>tagLength</code></a> member of
                 <var>normalizedAlgorithm</var></dd>
                <dt>Otherwise:</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                  <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If <var>ciphertext</var> has a length less than <var>tagLength</var> bits,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>additionalData</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-5">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-3"><code>additionalData</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Perform the OCB-DECRYPT function described in Section 4.3 of
                [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7253" title="The OCB Authenticated-Encryption Algorithm">RFC7253</a></cite>] using AES as the block cipher, using
                the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                internal slot of <var>key</var> as the <var>K</var> input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-6">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-5"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
                the <var>N</var> input parameter, <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-7">the contents of
                <var>additionalData</var></a> as the <var>A</var> input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-8">the contents of
                <var>ciphertext</var></a> as the <var>C</var> input parameter, and
                <var>tagLength</var> as the <var>TAGLEN</var> global parameter.
              </p>
              <dl class="switch">
                <dt>If the result of the algorithm is the indication of authentication failure,
                "INVALID":</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                  <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>
                </dd>
                <dt>Otherwise:</dt>
                <dd>Let <var>plaintext</var> be the output <var>P</var> of OCB-DECRYPT.</dd>
              </dl>
            </li>
            <li>
              <p>
                Return the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>plaintext</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains any entry which is not
                one of "<code>encrypt</code>", "<code>decrypt</code>",
                "<code>wrapKey</code>" or "<code>unwrapKey</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length"><code>length</code></a> member of
                <var>normalizedAlgorithm</var> is not equal to one of
                128, 192 or 256,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>

            <li>
              <p>
                Generate an AES key of length
                equal to the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length"><code>length</code></a> member of
                <var>normalizedAlgorithm</var>.
              </p>
            </li>
            <li>
              <p>
                If the key generation step fails,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new
                <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object representing the
                generated AES key.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new
                <a data-link-type="idl" data-lt="AesKeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm"><code>AesKeyAlgorithm</code></a>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>AES-OCB</code>".
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                <var>algorithm</var> to equal the
                <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyGenParams-length"><code>length</code></a> member of
                <var>normalizedAlgorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>key</var> to be <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>key</var> to be <var>usages</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains an entry which is not
                one of "<code>encrypt</code>", "<code>decrypt</code>",
                "<code>wrapKey</code>" or "<code>unwrapKey</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>data</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-octet-string" class="internalDFN" id="ref-for-dfn-octet-string-1">octet string</a> contained in <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the length in bits of <var>data</var> is not 128, 192 or 256
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>oct</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>jwk</var> does not meet the requirements of
                        Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-octet-string" class="internalDFN" id="ref-for-dfn-octet-string-2">octet string</a> obtained by decoding the
                        <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-k"><code>k</code></a> field of <var>jwk</var>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If <var>data</var> has length 128 bits:</dt>
                        <dd>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-alg"><code>alg</code></a> field of <var>jwk</var> is present, and is
                        not "<code>A128OCB</code>",
                          then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                          <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</dd>
                        <dt>If <var>data</var> has length 192 bits:</dt>
                        <dd>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-alg"><code>alg</code></a> field of <var>jwk</var> is present, and is
                        not "<code>A192OCB</code>",
                          then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                          <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</dd>
                        <dt>If <var>data</var> has length 256 bits:</dt>
                        <dd>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-alg"><code>alg</code></a> field of <var>jwk</var> is present, and is
                        not "<code>A256OCB</code>",
                          then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                          <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</dd>
                        <dt>Otherwise:</dt>
                        <dd>
                          <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                          <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present and is
                        not "<code>enc</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of
                        JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>] or
                        does not contain all of the specified <var>usages</var> values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new <code>{{CryptoKey}}</code>
                object representing an AES key with value <var>data</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new
                <a data-link-type="idl" data-lt="AesKeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm"><code>AesKeyAlgorithm</code></a>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>AES-OCB</code>".
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                <var>algorithm</var> to the length, in bits, of <var>data</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>data</var> be the raw octets of the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                        an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to the
                        string "<code>oct</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-k"><code>k</code></a> attribute of <var>jwk</var> to be a string
                        containing the raw octets of the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>].
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                        <var>key</var> is 128:</dt>
                        <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                        the string "<code>A128OCB</code>".</dd>
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                        <var>key</var> is 192:</dt>
                        <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                        the string "<code>A192OCB</code>".</dd>
                        <dt>If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesKeyAlgorithm-length"><code>length</code></a> attribute of
                        <var>key</var> is 256:</dt>
                        <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                        the string "<code>A256OCB</code>".</dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the
                        <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length"><code>length</code></a> member of
                <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Return the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-AesDerivedKeyParams-length"><code>length</code></a> member of
                <var>normalizedDerivedKeyAlgorithm</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="chacha20-poly1305"><div class="header-wrapper"><h2 id="x6-chacha20-poly1305"><bdi class="secno">6. </bdi>ChaCha20-Poly1305</h2><a class="self-link" href="#chacha20-poly1305" aria-label="Permalink for Section 6."></a></div>
    
    <section id="chacha20-poly1305-description" class="informative"><div class="header-wrapper"><h3 id="x6-1-description"><bdi class="secno">6.1 </bdi>Description</h3><a class="self-link" href="#chacha20-poly1305-description" aria-label="Permalink for Section 6.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The "<code>ChaCha20-Poly1305</code>" algorithm identifier is used to perform
        authenticated encryption and decryption using AEAD_CHACHA20_POLY1305,
        as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>].
      </p>
    </section>
    <section id="chacha20-poly1305-registration"><div class="header-wrapper"><h3 id="x6-2-registration"><bdi class="secno">6.2 </bdi>Registration</h3><a class="self-link" href="#chacha20-poly1305-registration" aria-label="Permalink for Section 6.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm name</a> for
        this algorithm is "<code>ChaCha20-Poly1305</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>encrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-5"><code>AeadParams</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>decrypt</td>
            <td><a data-link-type="idl" data-lt="AeadParams" href="#dfn-AeadParams" class="internalDFN" id="ref-for-dfn-AeadParams-6"><code>AeadParams</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
         <tr>
           <td>importKey</td>
           <td>None</td>
           <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
         </tr>
         <tr>
           <td>exportKey</td>
           <td>None</td>
           <td>object</td>
         </tr>
         <tr>
           <td>get key length</td>
           <td>None</td>
           <td>Integer</td>
         </tr>
        </tbody>
      </table>
    </section>
    <section id="chacha20-poly1305-operations"><div class="header-wrapper"><h3 id="x6-3-operations"><bdi class="secno">6.3 </bdi>Operations</h3><a class="self-link" href="#chacha20-poly1305-operations" aria-label="Permalink for Section 6.3"></a></div>
      
      <dl>
        <dt>Encrypt</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-6"><code>iv</code></a> member of
                <var>normalizedAlgorithm</var> does not have a length of 12 bytes,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-8"><code>tagLength</code></a> member
                of <var>normalizedAlgorithm</var> is present and is not 128,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>additionalData</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-9">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-4"><code>additionalData</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Let <var>ciphertext</var> be the output that results from
                performing the AEAD_CHACHA20_POLY1305 encryption algorithm
                described in Section 2.8 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>], using
                the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                internal slot of <var>key</var> as the key input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-10">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-7"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
                the nonce input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-11">the contents of
                <var>plaintext</var></a> as the plaintext input parameter, and
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-12">the contents of
                <var>additionalData</var></a> as the additional authenticated data (AAD) input parameter.
              </p>
            </li>
            <li>
              <p>
                Return the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>ciphertext</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Decrypt</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-8"><code>iv</code></a> member of
                <var>normalizedAlgorithm</var> does not have a length of 12 bytes,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-AeadParams-tagLength" class="internalDFN" id="ref-for-dfn-AeadParams-tagLength-9"><code>tagLength</code></a> member
                of <var>normalizedAlgorithm</var> is present and is not 128,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If <var>ciphertext</var> has a length less than 128 bits,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>additionalData</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-13">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-additionalData" class="internalDFN" id="ref-for-dfn-AeadParams-additionalData-5"><code>additionalData</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Perform the AEAD_CHACHA20_POLY1305 decryption algorithm
                described in Section 2.8 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8439" title="ChaCha20 and Poly1305 for IETF Protocols">RFC8439</a></cite>], using
                the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                internal slot of <var>key</var> as the key input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-14">the contents of</a> the <a data-link-type="idl" href="#dfn-AeadParams-iv" class="internalDFN" id="ref-for-dfn-AeadParams-iv-9"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as
                the nonce input parameter,
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-15">the contents of
                <var>ciphertext</var></a> as the ciphertext input parameter, and
                <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-16">the contents of
                <var>additionalData</var></a> as the additional authenticated data (AAD) input parameter.
              </p>
              <dl class="switch">
                <dt>If the result of the algorithm is the indication of authentication failure:</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                  <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>
                </dd>
                <dt>Otherwise:</dt>
                <dd>Let <var>plaintext</var> be the resulting plaintext.</dd>
              </dl>
            </li>
            <li>
              <p>
                Return the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>plaintext</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains any entry which is not
                one of "<code>encrypt</code>", "<code>decrypt</code>",
                "<code>wrapKey</code>" or "<code>unwrapKey</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>

            <li>
              <p>
                Generate a 256-bit key.
              </p>
            </li>
            <li>
              <p>
                If the key generation step fails,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new
                <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object representing the
                generated key.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new
                <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>ChaCha20-Poly1305</code>".
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>key</var> to be <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>key</var> to be <var>usages</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains an entry which is not
                one of "<code>encrypt</code>", "<code>decrypt</code>",
                "<code>wrapKey</code>" or "<code>unwrapKey</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>data</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-octet-string" class="internalDFN" id="ref-for-dfn-octet-string-3">octet string</a> contained in <var>keyData</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the length in bits of <var>data</var> is not 256
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>oct</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>jwk</var> does not meet the requirements of
                        Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-octet-string" class="internalDFN" id="ref-for-dfn-octet-string-4">octet string</a> obtained by decoding the
                        <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-k"><code>k</code></a> field of <var>jwk</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-alg"><code>alg</code></a> field of <var>jwk</var> is present, and is
                        not "<code>CC20P1305</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present and is
                        not "<code>enc</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of
                        JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>] or
                        does not contain all of the specified <var>usages</var> values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new <code>{{CryptoKey}}</code>
                object representing a key with value <var>data</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new
                <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>ChaCha20-Poly1305</code>".
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>data</var> be the raw octets of the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                        an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to the
                        string "<code>oct</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-k"><code>k</code></a> attribute of <var>jwk</var> to be a string
                        containing the raw octets of the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                        <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>].
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>alg</code> attribute of <var>jwk</var> to
                        the string "<code>CC20P1305</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the
                        <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <p>
                Return 256.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="sha3"><div class="header-wrapper"><h2 id="x7-sha-3"><bdi class="secno">7. </bdi>SHA-3</h2><a class="self-link" href="#sha3" aria-label="Permalink for Section 7."></a></div>
    
    <section id="sha3-description" class="informative"><div class="header-wrapper"><h3 id="x7-1-description"><bdi class="secno">7.1 </bdi>Description</h3><a class="self-link" href="#sha3-description" aria-label="Permalink for Section 7.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes the SHA-3 family of hash functions, as specified by
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>].
      </p>
    </section>
    <section id="sha3-registration"><div class="header-wrapper"><h3 id="x7-2-registration"><bdi class="secno">7.2 </bdi>Registration</h3><a class="self-link" href="#sha3-registration" aria-label="Permalink for Section 7.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-sha3-256">SHA3-256</code>",
        "<code id="alg-sha3-384">SHA3-384</code>", and
        "<code id="alg-sha3-512">SHA3-512</code>" for the respective SHA-3 algorithms.
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="sha3-operations"><div class="header-wrapper"><h3 id="x7-3-operations"><bdi class="secno">7.3 </bdi>Operations</h3><a class="self-link" href="#sha3-operations" aria-label="Permalink for Section 7.3"></a></div>
      
      <dl>
        <dt>Digest</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>SHA3-256</code>":
                </dt>
                <dd>
                  Let <var>result</var> be the result of performing the SHA3-256 hash function
                  defined in Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>] using
                  <var>message</var> as the input message, <var>M</var>.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>SHA3-384</code>":
                </dt>
                <dd>
                  Let <var>result</var> be the result of performing the SHA3-384 hash function
                  defined in Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>] using
                  <var>message</var> as the input message, <var>M</var>.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>SHA3-512</code>":
                </dt>
                <dd>
                  Let <var>result</var> be the result of performing the SHA3-512 hash function
                  defined in Section 6.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-202" title="SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions">FIPS-202</a></cite>] using
                  <var>message</var> as the input message, <var>M</var>.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If performing the operation results in an error, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Return a new ArrayBuffer containing <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="cshake"><div class="header-wrapper"><h2 id="x8-cshake"><bdi class="secno">8. </bdi>cSHAKE</h2><a class="self-link" href="#cshake" aria-label="Permalink for Section 8."></a></div>
    
    <section id="cshake-description" class="informative"><div class="header-wrapper"><h3 id="x8-1-description"><bdi class="secno">8.1 </bdi>Description</h3><a class="self-link" href="#cshake-description" aria-label="Permalink for Section 8.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes cSHAKE128 and cSHAKE256, as specified by
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>].
      </p>
    </section>
    <section id="cshake-registration"><div class="header-wrapper"><h3 id="x8-2-registration"><bdi class="secno">8.2 </bdi>Registration</h3><a class="self-link" href="#cshake-registration" aria-label="Permalink for Section 8.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-cshake128">cSHAKE128</code>" and
        "<code id="alg-cshake256">cSHAKE256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>digest</td>
            <td><a data-link-type="idl" data-lt="CShakeParams" href="#dfn-CShakeParams" class="internalDFN" id="ref-for-dfn-CShakeParams-1"><code>CShakeParams</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="cshake-params"><div class="header-wrapper"><h3 id="x8-3-cshakeparams-dictionary"><bdi class="secno">8.3 </bdi><dfn data-idl="dictionary" id="dfn-CShakeParams" data-export="" data-dfn-type="dictionary" data-title="CShakeParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>CShakeParams</code></dfn> dictionary</h3><a class="self-link" href="#cshake-params" aria-label="Permalink for Section 8.3"></a></div>
      
      <pre class="idl def" id="webidl-1097481639"><span class="idlHeader"><a class="self-link" href="#webidl-1097481639">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-cshakeparams" data-title="CShakeParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-CShakeParams" id="ref-for-dfn-CShakeParams-2"><code>CShakeParams</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-cshakeparams-length" data-title="length" data-dfn-for="CShakeParams">
  required<span class="idlType"> [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-CShakeParams-length" id="ref-for-dfn-CShakeParams-length-1"><code>length</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-cshakeparams-functionname" data-title="functionName" data-dfn-for="CShakeParams"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-CShakeParams-functionName" id="ref-for-dfn-CShakeParams-functionName-1"><code>functionName</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-cshakeparams-customization" data-title="customization" data-dfn-for="CShakeParams"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-CShakeParams-customization" id="ref-for-dfn-CShakeParams-customization-1"><code>customization</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="CShakeParams" id="dfn-CShakeParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for="CShakeParams" id="dfn-CShakeParams-functionName" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="functionName" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>functionName</code></dfn> member represents the function name, used by NIST to define functions based on cSHAKE. When used, it should only be set to values defined by NIST.</p>
      <p>The <dfn data-dfn-for="CShakeParams" id="dfn-CShakeParams-customization" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="customization" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>customization</code></dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>
    <section id="cshake-operations"><div class="header-wrapper"><h3 id="x8-4-operations"><bdi class="secno">8.4 </bdi>Operations</h3><a class="self-link" href="#cshake-operations" aria-label="Permalink for Section 8.4"></a></div>
      
      <dl>
        <dt>Digest</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>length</var> be the <a data-link-type="idl" href="#dfn-CShakeParams-length" class="internalDFN" id="ref-for-dfn-CShakeParams-length-2"><code>length</code></a> member of
                <var>normalizedAlgorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>functionName</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-17">the contents of</a> the <a data-link-type="idl" href="#dfn-CShakeParams-functionName" class="internalDFN" id="ref-for-dfn-CShakeParams-functionName-2"><code>functionName</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <p>
                Let <var>customization</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-18">the contents of</a> the <a data-link-type="idl" href="#dfn-CShakeParams-customization" class="internalDFN" id="ref-for-dfn-CShakeParams-customization-2"><code>customization</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>cSHAKE128</code>":
                </dt>
                <dd>
                  Let <var>result</var> be the result of performing the cSHAKE128 function
                  defined in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                  <var>message</var> as the <var>X</var> input parameter,
                  <var>length</var> as the <var>L</var> input parameter,
                  <var>functionName</var> as the <var>N</var> input parameter, and
                  <var>customization</var> as the <var>S</var> input parameter.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>cSHAKE256</code>":
                </dt>
                <dd>
                  Let <var>result</var> be the result of performing the cSHAKE256 function
                  defined in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                  <var>message</var> as the <var>X</var> input parameter,
                  <var>length</var> as the <var>L</var> input parameter,
                  <var>functionName</var> as the <var>N</var> input parameter, and
                  <var>customization</var> as the <var>S</var> input parameter.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                If performing the operation results in an error, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Return a new ArrayBuffer containing <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="kmac"><div class="header-wrapper"><h2 id="x9-kmac"><bdi class="secno">9. </bdi>KMAC</h2><a class="self-link" href="#kmac" aria-label="Permalink for Section 9."></a></div>
    
    <section id="kmac-description" class="informative"><div class="header-wrapper"><h3 id="x9-1-description"><bdi class="secno">9.1 </bdi>Description</h3><a class="self-link" href="#kmac-description" aria-label="Permalink for Section 9.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes KMAC128 and KMAC256, as specified by
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>].
      </p>
    </section>
    <section id="kmac-registration"><div class="header-wrapper"><h3 id="x9-2-registration"><bdi class="secno">9.2 </bdi>Registration</h3><a class="self-link" href="#kmac-registration" aria-label="Permalink for Section 9.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-kmac128">KMAC128</code>" and
        "<code id="alg-kmac256">KMAC256</code>".
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>sign</td>
            <td><a data-link-type="idl" data-lt="KmacParams" href="#dfn-KmacParams" class="internalDFN" id="ref-for-dfn-KmacParams-1"><code>KmacParams</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>verify</td>
            <td><a data-link-type="idl" data-lt="KmacParams" href="#dfn-KmacParams" class="internalDFN" id="ref-for-dfn-KmacParams-2"><code>KmacParams</code></a></td>
            <td>boolean</td>
          </tr>
          <tr>
            <td>generateKey</td>
            <td><a data-link-type="idl" data-lt="KmacKeyGenParams" href="#dfn-KmacKeyGenParams" class="internalDFN" id="ref-for-dfn-KmacKeyGenParams-1"><code>KmacKeyGenParams</code></a></td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td><a data-link-type="idl" data-lt="KmacImportParams" href="#dfn-KmacImportParams" class="internalDFN" id="ref-for-dfn-KmacImportParams-1"><code>KmacImportParams</code></a></td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>exportKey</td>
            <td>None</td>
            <td>object</td>
          </tr>
          <tr>
            <td>get key length</td>
            <td><a data-link-type="idl" data-lt="KmacImportParams" href="#dfn-KmacImportParams" class="internalDFN" id="ref-for-dfn-KmacImportParams-2"><code>KmacImportParams</code></a></td>
            <td>Integer</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="kmac-keygen-params"><div class="header-wrapper"><h3 id="x9-3-kmackeygenparams-dictionary"><bdi class="secno">9.3 </bdi><dfn data-idl="dictionary" id="dfn-KmacKeyGenParams" data-export="" data-dfn-type="dictionary" data-title="KmacKeyGenParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacKeyGenParams</code></dfn> dictionary</h3><a class="self-link" href="#kmac-keygen-params" aria-label="Permalink for Section 9.3"></a></div>
      
      <pre class="idl def" id="webidl-1224700284"><span class="idlHeader"><a class="self-link" href="#webidl-1224700284">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmackeygenparams" data-title="KmacKeyGenParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacKeyGenParams" id="ref-for-dfn-KmacKeyGenParams-2"><code>KmacKeyGenParams</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmackeygenparams-length" data-title="length" data-dfn-for="KmacKeyGenParams">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacKeyGenParams-length" id="ref-for-dfn-KmacKeyGenParams-length-1"><code>length</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacKeyGenParams" id="dfn-KmacKeyGenParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the length (in bits) of the key to generate. If unspecified, the recommended length will be used, which is 128 for KMAC128 and 256 for KMAC256.</p>
    </section>
    <section id="kmac-importparams"><div class="header-wrapper"><h3 id="x9-4-kmacimportparams-dictionary"><bdi class="secno">9.4 </bdi><dfn data-idl="dictionary" id="dfn-KmacImportParams" data-export="" data-dfn-type="dictionary" data-title="KmacImportParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacImportParams</code></dfn> dictionary</h3><a class="self-link" href="#kmac-importparams" aria-label="Permalink for Section 9.4"></a></div>
      
      <pre class="idl def" id="webidl-745655368"><span class="idlHeader"><a class="self-link" href="#webidl-745655368">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmacimportparams" data-title="KmacImportParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacImportParams" id="ref-for-dfn-KmacImportParams-3"><code>KmacImportParams</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmacimportparams-length" data-title="length" data-dfn-for="KmacImportParams">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacImportParams-length" id="ref-for-dfn-KmacImportParams-length-1"><code>length</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacImportParams" id="dfn-KmacImportParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="KmacKeyAlgorithm-dictionary"><div class="header-wrapper"><h3 id="x9-5-kmackeyalgorithm-dictionary"><bdi class="secno">9.5 </bdi><dfn data-idl="dictionary" id="dfn-KmacKeyAlgorithm" data-export="" data-dfn-type="dictionary" data-title="KmacKeyAlgorithm" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacKeyAlgorithm</code></dfn> dictionary</h3><a class="self-link" href="#KmacKeyAlgorithm-dictionary" aria-label="Permalink for Section 9.5"></a></div>
      
      <pre class="idl def" id="webidl-28722634"><span class="idlHeader"><a class="self-link" href="#webidl-28722634">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmackeyalgorithm" data-title="KmacKeyAlgorithm">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacKeyAlgorithm" id="ref-for-dfn-KmacKeyAlgorithm-1"><code>KmacKeyAlgorithm</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm">KeyAlgorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmackeyalgorithm-length" data-title="length" data-dfn-for="KmacKeyAlgorithm">
  required<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacKeyAlgorithm-length" id="ref-for-dfn-KmacKeyAlgorithm-length-1"><code>length</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacKeyAlgorithm" id="dfn-KmacKeyAlgorithm-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the length (in bits) of the key.</p>
    </section>
    <section id="kmac-params"><div class="header-wrapper"><h3 id="x9-6-kmacparams-dictionary"><bdi class="secno">9.6 </bdi><dfn data-idl="dictionary" id="dfn-KmacParams" data-export="" data-dfn-type="dictionary" data-title="KmacParams" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>KmacParams</code></dfn> dictionary</h3><a class="self-link" href="#kmac-params" aria-label="Permalink for Section 9.6"></a></div>
      
      <pre class="idl def" id="webidl-1848208597"><span class="idlHeader"><a class="self-link" href="#webidl-1848208597">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-kmacparams" data-title="KmacParams">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-KmacParams" id="ref-for-dfn-KmacParams-3"><code>KmacParams</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-kmacparams-length" data-title="length" data-dfn-for="KmacParams">
  required<span class="idlType"> [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacParams-length" id="ref-for-dfn-KmacParams-length-1"><code>length</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-kmacparams-customization" data-title="customization" data-dfn-for="KmacParams"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-KmacParams-customization" id="ref-for-dfn-KmacParams-customization-1"><code>customization</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="KmacParams" id="dfn-KmacParams-length" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="length" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>length</code></dfn> member represents the requested output length in bits.</p>
      <p>The <dfn data-dfn-for="KmacParams" id="dfn-KmacParams-customization" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="customization" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>customization</code></dfn> member represents the customization string. The application selects this string to define a variant of the function.</p>
    </section>

    <section id="kmac-operations"><div class="header-wrapper"><h3 id="x9-7-operations"><bdi class="secno">9.7 </bdi>Operations</h3><a class="self-link" href="#kmac-operations" aria-label="Permalink for Section 9.7"></a></div>
      
      <dl>
        <dt>Sign</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>customization</var> be the <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-19">contents of</a> the <a data-link-type="idl" href="#dfn-KmacParams-customization" class="internalDFN" id="ref-for-dfn-KmacParams-customization-2"><code>customization</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC128</code>":
                </dt>
                <dd>
                  Let <var>mac</var> be the result of performing the KMAC128 function
                  defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                  the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                  internal slot of <var>key</var> as the <var>K</var> input parameter,
                  <var>message</var> as the <var>X</var> input parameter,
                  the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-2"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                  the <var>L</var> input parameter, and
                  <var>customization</var> as
                  the <var>S</var> input parameter.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC256</code>":
                </dt>
                <dd>
                  Let <var>mac</var> be the result of performing the KMAC256 function
                  defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                  the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                  internal slot of <var>key</var> as the <var>K</var> input parameter,
                  <var>message</var> as the <var>X</var> input parameter,
                  the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-3"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                  the <var>L</var> input parameter, and
                  <var>customization</var> as
                  the <var>S</var> input parameter.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>mac</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Verify</dt>
        <dd>
          <ol>
            <li>
              <p>
                Let <var>customization</var> be the <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-20">contents of</a> the <a data-link-type="idl" href="#dfn-KmacParams-customization" class="internalDFN" id="ref-for-dfn-KmacParams-customization-3"><code>customization</code></a> member of
                <var>normalizedAlgorithm</var> if present or the empty octet
                string otherwise.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC128</code>":
                </dt>
                <dd>
                  Let <var>mac</var> be the result of performing the KMAC128 function
                  defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                  the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                  internal slot of <var>key</var> as the <var>K</var> input parameter,
                  <var>message</var> as the <var>X</var> input parameter,
                  the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-4"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                  the <var>L</var> input parameter, and
                  <var>customization</var> as
                  the <var>S</var> input parameter.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC256</code>":
                </dt>
                <dd>
                  Let <var>mac</var> be the result of performing the KMAC256 function
                  defined in Section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-nist-sp800-185" title="NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash">NIST-SP800-185</a></cite>] using
                  the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a>
                  internal slot of <var>key</var> as the <var>K</var> input parameter,
                  <var>message</var> as the <var>X</var> input parameter,
                  the <a data-link-type="idl" href="#dfn-KmacParams-length" class="internalDFN" id="ref-for-dfn-KmacParams-length-5"><code>length</code></a> member of <var>normalizedAlgorithm</var> as
                  the <var>L</var> input parameter, and
                  <var>customization</var> as
                  the <var>S</var> input parameter.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return true if <var>mac</var> is equal to <var>signature</var> and false
                otherwise.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Generate Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>usages</var> contains any entry which is not "<code>sign</code>" or
                "<code>verify</code>", then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" href="#dfn-KmacKeyGenParams-length" class="internalDFN" id="ref-for-dfn-KmacKeyGenParams-length-2"><code>length</code></a> member of
                  <var>normalizedAlgorithm</var> is present:
                </dt>
                <dd>
                  Let <var>length</var> be equal to the
                  <a data-link-type="idl" href="#dfn-KmacKeyGenParams-length" class="internalDFN" id="ref-for-dfn-KmacKeyGenParams-length-3"><code>length</code></a>
                  member of <var>normalizedAlgorithm</var>.
                </dd>
                <dt>
                  Otherwise, if the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC128</code>":
                </dt>
                <dd>
                  Let <var>length</var> be 128.
                </dd>
                <dt>
                  Otherwise, if the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC256</code>":
                </dt>
                <dd>
                  Let <var>length</var> be 256.
                </dd>
              </dl>
            </li>

            <li>
              <p>
                Generate a key of length <var>length</var> bits.
              </p>
            </li>
            <li>
              <p>
                If the key generation step fails,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new
                <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a> object representing the
                generated key.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new
                <a data-link-type="idl" data-lt="KmacKeyAlgorithm" href="#dfn-KmacKeyAlgorithm" class="internalDFN" id="ref-for-dfn-KmacKeyAlgorithm-2"><code>KmacKeyAlgorithm</code></a>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>KMAC</code>".
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal
                slot of <var>key</var> to be <var>extractable</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages">[[usages]]</a> internal slot of
                <var>key</var> to be <var>usages</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import Key</dt>
        <dd>
          <ol>
            <li>
              <p>Let <var>keyData</var> be the key data to be imported.</p>
            </li>
            <li>
              <p>
                If <var>usages</var> contains an entry which is not
                "<code>sign</code>" or "<code>verify</code>",
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>data</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-octet-string" class="internalDFN" id="ref-for-dfn-octet-string-5">octet string</a> contained in <var>keyData</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <dl class="switch">
                        <dt>If <var>keyData</var> is a <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a> dictionary:</dt>
                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>
                        <dt>Otherwise:</dt>
                        <dd><p><a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">Throw</a> a <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.</p></dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-kty"><code>kty</code></a> field of <var>jwk</var> is not
                        "<code>oct</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If <var>jwk</var> does not meet the requirements of
                        Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>],
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>data</var> be the <a data-link-type="dfn|abstract-op" href="#dfn-octet-string" class="internalDFN" id="ref-for-dfn-octet-string-6">octet string</a> obtained by decoding the
                        <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-k"><code>k</code></a> field of <var>jwk</var>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                          <var>normalizedAlgorithm</var> is a case-sensitive string match for
                          "<code>KMAC128</code>":
                        </dt>
                        <dd>
                          If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-alg"><code>alg</code></a> field of <var>jwk</var> is present
                          and is not "<code>K128</code>",
                          then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                          <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                        </dd>
                        <dt>
                          If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                          <var>normalizedAlgorithm</var> is a case-sensitive string match for
                          "<code>KMAC256</code>":
                        </dt>
                        <dd>
                          If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-alg"><code>alg</code></a> field of <var>jwk</var> is present
                          and is not "<code>K256</code>",
                          then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                          <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                        </dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        If <var>usages</var> is non-empty and the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-use"><code>use</code></a> field of <var>jwk</var> is present and is
                        not "<code>sign</code>",
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-key_ops"><code>key_ops</code></a> field of <var>jwk</var> is present, and
                        is invalid according to the requirements of
                        JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwk" title="JSON Web Key (JWK)">JWK</a></cite>] or
                        does not contain all of the specified <var>usages</var> values,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                    <li>
                      <p>
                        If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-ext"><code>ext</code></a> field of <var>jwk</var> is present and
                        has the value false and <var>extractable</var> is true,
                        then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                        <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                  <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let <var>length</var> be equivalent to the length, in octets, of
                <var>data</var>, multiplied by 8.
              </p>
            </li>
            <li>
              <p>
                If <var>length</var> is zero
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-2"><code>length</code></a> member of
                  <var>normalizedAlgorithm</var> is present:
                </dt>
                <dd>
                  <dl class="switch">
                    <dt>
                      If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-3"><code>length</code></a> member of
                      <var>normalizedAlgorithm</var> is greater than <var>length</var>:
                    </dt>
                    <dd>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </dd>
                    <dt>
                      If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-4"><code>length</code></a> member of
                      <var>normalizedAlgorithm</var>, is less than or equal to
                      <var>length</var> minus eight:
                    </dt>
                    <dd>
                      <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                      <a data-link-type="idl" data-lt="DataError" data-type="exception" href="https://webidl.spec.whatwg.org/#dataerror"><code>DataError</code></a>.
                    </dd>
                    <dt>
                      Otherwise:
                    </dt>
                    <dd>
                      Set <var>length</var> equal to the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-5"><code>length</code></a>
                      member of <var>normalizedAlgorithm</var>.
                    </dd>
                  </dl>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new <code>{{CryptoKey}}</code>
                object representing an KMAC key with the first <var>length</var>
                bits of <var>data</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new
                <a data-link-type="idl" data-lt="KmacKeyAlgorithm" href="#dfn-KmacKeyAlgorithm" class="internalDFN" id="ref-for-dfn-KmacKeyAlgorithm-3"><code>KmacKeyAlgorithm</code></a>.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to "<code>KMAC</code>".
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" href="#dfn-KmacKeyAlgorithm-length" class="internalDFN" id="ref-for-dfn-KmacKeyAlgorithm-length-2"><code>length</code></a> attribute of
                <var>algorithm</var> to <var>length</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Export Key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If the underlying cryptographic key material represented by the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                cannot be accessed, then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>bits</var> be the raw bits of the key represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of
                <var>key</var>.
              </p>
            </li>
            <li>
              <p>
                Let <var>data</var> be an <a href="https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing">octet string containing</a> <var>bits</var>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>result</var> be the result of <a data-link-type="dfn|abstract-op" data-lt="create" data-type="dfn" href="https://webidl.spec.whatwg.org/#arraybuffer-create">creating</a>
                        an <a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a> containing <var>data</var>.
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>If <var>format</var> is "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-jwk"><code>jwk</code></a>":</dt>
                <dd>
                  <ol>
                    <li>
                      <p>
                        Let <var>jwk</var> be a new <a data-link-type="idl" data-lt="JsonWebKey" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-JsonWebKey"><code>JsonWebKey</code></a>
                        dictionary.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>kty</code> attribute of <var>jwk</var> to the
                        string "<code>oct</code>".
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-jsonwebkey-k"><code>k</code></a> attribute of <var>jwk</var> to be a string
                        containing <var>data</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class="bibref" data-link-type="biblio" href="#bib-jwa" title="JSON Web Algorithms (JWA)">JWA</a></cite>].
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>algorithm</var> be the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal slot of
                        <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <dl class="switch">
                        <dt>
                          If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                          <var>normalizedAlgorithm</var> is a case-sensitive string match for
                          "<code>KMAC128</code>":
                        </dt>
                        <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                          the string "<code>K128</code>".</dd>
                        <dt>
                          If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                          <var>normalizedAlgorithm</var> is a case-sensitive string match for
                          "<code>KMAC256</code>":
                        </dt>
                        <dd>Set the <code>alg</code> attribute of <var>jwk</var> to
                          the string "<code>K256</code>".</dd>
                      </dl>
                    </li>
                    <li>
                      <p>
                        Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the
                        <a data-link-type="idl" data-type="attribute" href="https://www.w3.org/TR/WebCryptoAPI/#dom-cryptokey-usages"><code>usages</code></a> attribute of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot
                        of <var>key</var>.
                      </p>
                    </li>
                    <li>
                      <p>
                        Let <var>result</var> be the result of converting <var>jwk</var>
                        to an ECMAScript Object, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-webidl" title="Web IDL Standard">WebIDL</a></cite>].
                      </p>
                    </li>
                  </ol>
                </dd>
                <dt>Otherwise:</dt>
                <dd>
                  <p>
                    <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                    <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>.
                  </p>
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>result</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-6"><code>length</code></a> member of
                  <var>normalizedAlgorithm</var> is present:
                </dt>
                <dd>
                  Let <var>length</var> be equal to the
                  <a data-link-type="idl" href="#dfn-KmacImportParams-length" class="internalDFN" id="ref-for-dfn-KmacImportParams-length-7"><code>length</code></a>
                  member of <var>normalizedAlgorithm</var>.
                </dd>
                <dt>
                  Otherwise, if the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC128</code>":
                </dt>
                <dd>
                  Let <var>length</var> be 128.
                </dd>
                <dt>
                  Otherwise, if the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>KMAC256</code>":
                </dt>
                <dd>
                  Let <var>length</var> be 256.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Return <var>length</var>.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>
  <section id="argon2"><div class="header-wrapper"><h2 id="x10-argon2"><bdi class="secno">10. </bdi>Argon2</h2><a class="self-link" href="#argon2" aria-label="Permalink for Section 10."></a></div>
    
    <section id="argon2-description" class="informative"><div class="header-wrapper"><h3 id="x10-1-description"><bdi class="secno">10.1 </bdi>Description</h3><a class="self-link" href="#argon2-description" aria-label="Permalink for Section 10.1"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This describes the Argon2 function for password hashing and key derivation,
        as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>].
      </p>
    </section>
    <section id="argon2-registration"><div class="header-wrapper"><h3 id="x10-2-registration"><bdi class="secno">10.2 </bdi>Registration</h3><a class="self-link" href="#argon2-registration" aria-label="Permalink for Section 10.2"></a></div>
      
      <p>
        The <a href="https://www.w3.org/TR/WebCryptoAPI/#recognized-algorithm-name">recognized algorithm names</a> are
        "<code id="alg-argon2d">Argon2d</code>",
        "<code id="alg-argon2i">Argon2i</code>", and
        "<code id="alg-argon2id">Argon2id</code>" for the respective Argon2 types.
      </p>
      <table>
        <thead>
          <tr>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#supported-operations">Operation</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-specific-params">Parameters</a></th>
            <th><a href="https://www.w3.org/TR/WebCryptoAPI/#algorithm-result">Result</a></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>deriveBits</td>
            <td><a data-link-type="idl" data-lt="Argon2Params" href="#dfn-Argon2Params" class="internalDFN" id="ref-for-dfn-Argon2Params-1"><code>Argon2Params</code></a></td>
            <td><a data-link-type="idl" data-lt="ArrayBuffer" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><code>ArrayBuffer</code></a></td>
          </tr>
          <tr>
            <td>importKey</td>
            <td>None</td>
            <td><a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a></td>
          </tr>
          <tr>
            <td>Get key length</td>
            <td>None</td>
            <td>null</td>
          </tr>
        </tbody>
      </table>
    </section>
    <section id="argon2-params"><div class="header-wrapper"><h3 id="x10-3-argon2params-dictionary"><bdi class="secno">10.3 </bdi><dfn data-idl="dictionary" id="dfn-Argon2Params" data-export="" data-dfn-type="dictionary" data-title="Argon2Params" data-dfn-for="" tabindex="0" aria-haspopup="dialog"><code>Argon2Params</code></dfn> dictionary</h3><a class="self-link" href="#argon2-params" aria-label="Permalink for Section 10.3"></a></div>
      
      <pre class="idl def" id="webidl-1006558199"><span class="idlHeader"><a class="self-link" href="#webidl-1006558199">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-argon2params" data-title="Argon2Params">dictionary <a class="internalDFN idlID" data-link-type="dictionary" href="#dfn-Argon2Params" id="ref-for-dfn-Argon2Params-2"><code>Argon2Params</code></a> : <span class="idlSuperclass"><a data-link-type="idl" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-Algorithm">Algorithm</a></span> {<span data-idl="" class="idlMember" id="idl-def-argon2params-nonce" data-title="nonce" data-dfn-for="Argon2Params">
  required<span class="idlType"> <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-nonce" id="ref-for-dfn-Argon2Params-nonce-1"><code>nonce</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-parallelism" data-title="parallelism" data-dfn-for="Argon2Params">
  required<span class="idlType"> [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-parallelism" id="ref-for-dfn-Argon2Params-parallelism-1"><code>parallelism</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-memory" data-title="memory" data-dfn-for="Argon2Params">
  required<span class="idlType"> [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-memory" id="ref-for-dfn-Argon2Params-memory-1"><code>memory</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-passes" data-title="passes" data-dfn-for="Argon2Params">
  required<span class="idlType"> [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>] <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long">unsigned long</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-passes" id="ref-for-dfn-Argon2Params-passes-1"><code>passes</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-version" data-title="version" data-dfn-for="Argon2Params">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange">EnforceRange</a></span>]<span class="idlType"> <a data-link-type="idl" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-octet">octet</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-version" id="ref-for-dfn-Argon2Params-version-1"><code>version</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-secretvalue" data-title="secretValue" data-dfn-for="Argon2Params"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-secretValue" id="ref-for-dfn-Argon2Params-secretValue-1"><code>secretValue</code></a>;</span><span data-idl="" class="idlMember" id="idl-def-argon2params-associateddata" data-title="associatedData" data-dfn-for="Argon2Params"><span class="idlType">
  <a data-link-type="idl" data-type="typedef" href="https://webidl.spec.whatwg.org/#BufferSource">BufferSource</a></span> <a class="internalDFN idlName" data-link-type="dict-member" href="#dfn-Argon2Params-associatedData" id="ref-for-dfn-Argon2Params-associatedData-1"><code>associatedData</code></a>;</span>
};</span></code></pre>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-nonce" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="nonce" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>nonce</code></dfn> member represents the nonce, which is a salt for password hashing applications.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-parallelism" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="parallelism" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>parallelism</code></dfn> member represents the degree of parallelism.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-memory" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="memory" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>memory</code></dfn> member represents the memory size in kibibytes. It must be at least 8 times the degree of parallelism.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-passes" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="passes" data-type="unsigned long" tabindex="0" aria-haspopup="dialog"><code>passes</code></dfn> member represents the number of passes.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-version" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="version" data-type="octet" tabindex="0" aria-haspopup="dialog"><code>version</code></dfn> member represents the version number. The default and currently only defined version is 19 (0x13).</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-secretValue" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="secretValue" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>secretValue</code></dfn> member represents the optional secret value.</p>
      <p>The <dfn data-dfn-for="Argon2Params" id="dfn-Argon2Params-associatedData" data-export="" data-dfn-type="dict-member" data-idl="field" data-title="associatedData" data-type="BufferSource" tabindex="0" aria-haspopup="dialog"><code>associatedData</code></dfn> member represents the optional associated data.</p>
      <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span></div><p class="">
        For the recommended values of the parameters, see section 4 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>].
      </p></div>
    </section>
    <section id="argon2-operations"><div class="header-wrapper"><h3 id="x10-4-operations"><bdi class="secno">10.4 </bdi>Operations</h3><a class="self-link" href="#argon2-operations" aria-label="Permalink for Section 10.4"></a></div>
      
      <dl>
        <dt>Derive Bits</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>length</var> is null, or is less than 32 (4*8), then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-Argon2Params-version" class="internalDFN" id="ref-for-dfn-Argon2Params-version-2"><code>version</code></a> member
                of <var>normalizedAlgorithm</var> is present and is not 19 (0x13),
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-Argon2Params-parallelism" class="internalDFN" id="ref-for-dfn-Argon2Params-parallelism-2"><code>parallelism</code></a> member of <var>normalizedAlgorithm</var> is zero,
                or greater than 16777215 (2^24-1),
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-Argon2Params-memory" class="internalDFN" id="ref-for-dfn-Argon2Params-memory-2"><code>memory</code></a> member of <var>normalizedAlgorithm</var> is less than
                8 times the <a data-link-type="idl" href="#dfn-Argon2Params-parallelism" class="internalDFN" id="ref-for-dfn-Argon2Params-parallelism-3"><code>parallelism</code></a> member of <var>normalizedAlgorithm</var>,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If the <a data-link-type="idl" href="#dfn-Argon2Params-passes" class="internalDFN" id="ref-for-dfn-Argon2Params-passes-2"><code>passes</code></a> member of <var>normalizedAlgorithm</var> is zero,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <dl class="switch">
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>Argon2d</code>":
                </dt>
                <dd>
                  Let <var>type</var> be 0.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>Argon2i</code>":
                </dt>
                <dd>
                  Let <var>type</var> be 1.
                </dd>
                <dt>
                  If the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                  <var>normalizedAlgorithm</var> is a case-sensitive string match for
                  "<code>Argon2id</code>":
                </dt>
                <dd>
                  Let <var>type</var> be 2.
                </dd>
              </dl>
            </li>
            <li>
              <p>
                Let <var>secretValue</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-21">the contents of</a> the <a data-link-type="idl" href="#dfn-Argon2Params-secretValue" class="internalDFN" id="ref-for-dfn-Argon2Params-secretValue-2"><code>secretValue</code></a> member of
                <var>normalizedAlgorithm</var>, if present.
              </p>
            </li>
            <li>
              <p>
                Let <var>associatedData</var> be <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-22">the contents of</a> the <a data-link-type="idl" href="#dfn-Argon2Params-associatedData" class="internalDFN" id="ref-for-dfn-Argon2Params-associatedData-2"><code>associatedData</code></a> member of
                <var>normalizedAlgorithm</var>, if present.
              </p>
            </li>
            <li>
              <p>
                Let <var>result</var> be the result of performing the Argon2 function defined
                in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9106" title="Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications">RFC9106</a></cite>] using
                the password represented by <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle">[[handle]]</a> internal slot of <var>key</var>
                as the message, <var>P</var>, <a href="#concept-contents-of-arraybuffer" id="ref-for-concept-contents-of-arraybuffer-23">the
                contents of</a> the <a data-link-type="idl" href="#dfn-Argon2Params-nonce" class="internalDFN" id="ref-for-dfn-Argon2Params-nonce-2"><code>nonce</code></a> attribute of
                <var>normalizedAlgorithm</var> as the nonce, <var>S</var>,
                the value of the <a data-link-type="idl" href="#dfn-Argon2Params-parallelism" class="internalDFN" id="ref-for-dfn-Argon2Params-parallelism-4"><code>parallelism</code></a> attribute
                of <var>normalizedAlgorithm</var> as the degree of parallelism, <var>p</var>,
                the value of the <a data-link-type="idl" href="#dfn-Argon2Params-memory" class="internalDFN" id="ref-for-dfn-Argon2Params-memory-3"><code>memory</code></a> attribute
                of <var>normalizedAlgorithm</var> as the memory size, <var>m</var>,
                the value of the <a data-link-type="idl" href="#dfn-Argon2Params-passes" class="internalDFN" id="ref-for-dfn-Argon2Params-passes-3"><code>passes</code></a> attribute
                of <var>normalizedAlgorithm</var> as the number of passes, <var>t</var>,
                0x13 as the version number, <var>v</var>,
                <var>secretValue</var> (if present) as the secret value, <var>K</var>,
                <var>associatedData</var> (if present) as the associated data, <var>X</var>,
                <var>type</var> as the type, <var>y</var>, and
                <var>length</var> divided by 8 as the tag length, <var>T</var>.
              </p>
            </li>
            <li>
              <p>
                If the key derivation operation fails,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> an
                <a data-link-type="idl" data-lt="OperationError" data-type="exception" href="https://webidl.spec.whatwg.org/#operationerror"><code>OperationError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Return <var>result</var>
              </p>
            </li>
          </ol>
        </dd>
        <dt>Import key</dt>
        <dd>
          <ol>
            <li>
              <p>
                If <var>format</var> is not "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyformat-raw"><code>raw</code></a>", <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="NotSupportedError" data-type="exception" href="https://webidl.spec.whatwg.org/#notsupportederror"><code>NotSupportedError</code></a>
              </p>
            </li>
            <li>
              <p>
                If <var>usages</var> contains a value that is not
                "<code>deriveKey</code>"  or "<code>deriveBits</code>", then
                <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                If <var>extractable</var> is not <code>false</code>,
                then <a data-link-type="dfn|abstract-op" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throw</a> a
                <a data-link-type="idl" data-lt="SyntaxError" data-type="exception" href="https://webidl.spec.whatwg.org/#syntaxerror"><code>SyntaxError</code></a>.
              </p>
            </li>
            <li>
              <p>
                Let <var>key</var> be a new <a data-link-type="idl" data-lt="CryptoKey" data-type="interface" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey"><code>CryptoKey</code></a>
                representing <var>keyData</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type">[[type]]</a> internal slot of
                <var>key</var> to "<a data-link-type="idl" data-type="enum-value" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keytype-secret"><code>secret</code></a>".
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable">[[extractable]]</a> internal slot of
                <var>key</var> to <code>false</code>.
              </p>
            </li>
            <li>
              <p>
                Let <var>algorithm</var> be a new <a data-link-type="idl" data-lt="KeyAlgorithm" data-type="dictionary" href="https://www.w3.org/TR/WebCryptoAPI/#dfn-KeyAlgorithm"><code>KeyAlgorithm</code></a>
                object.
              </p>
            </li>
            <li>
              <p>
                Set the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-keyalgorithm-name"><code>name</code></a> attribute of
                <var>algorithm</var> to the <a data-link-type="idl" data-type="dict-member" href="https://www.w3.org/TR/WebCryptoAPI/#dom-algorithm-name"><code>name</code></a> member of
                <var>normalizedAlgorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Set the <a href="https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm">[[algorithm]]</a> internal
                slot of <var>key</var> to <var>algorithm</var>.
              </p>
            </li>
            <li>
              <p>
                Return <var>key</var>.
              </p>
            </li>
          </ol>
        </dd>
        <dt>Get key length</dt>
        <dd>
          <ol>
            <li>
              <p>
                Return null.
              </p>
            </li>
          </ol>
        </dd>
      </dl>
    </section>
  </section>

  <section id="usage-example"><div class="header-wrapper"><h2 id="x11-usage-example"><bdi class="secno">11. </bdi>Usage Example</h2><a class="self-link" href="#usage-example" aria-label="Permalink for Section 11."></a></div>
    
    <p>
      This example derives a key from a password using Argon2, if available, or PBKDF2, otherwise;
      and then encrypts and decrypts some text with it using AES-OCB, if available, and AES-GCM, otherwise.
    </p>
    <div class="example" id="example-encrypt-some-data-using-a-key-derived-from-a-password">
        <div class="marker">
    <a class="self-link" href="#example-encrypt-some-data-using-a-key-derived-from-a-password">Example<bdi> 1</bdi></a><span class="example-title">: Encrypt some data using a key derived from a password</span>
  </div> <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> password = <span class="hljs-string">'correct horse battery staple'</span>;
<span class="hljs-keyword">const</span> derivationAlg =
  SubtleCrypto.supports?.(<span class="hljs-string">'importKey'</span>, <span class="hljs-string">'Argon2id'</span>) ?
    <span class="hljs-string">'Argon2id'</span> :
    <span class="hljs-string">'PBKDF2'</span>;
<span class="hljs-keyword">const</span> encryptionAlg =
  SubtleCrypto.supports?.(<span class="hljs-string">'importKey'</span>, <span class="hljs-string">'AES-OCB'</span>) ?
    <span class="hljs-string">'AES-OCB'</span> :
    <span class="hljs-string">'AES-GCM'</span>;
<span class="hljs-keyword">const</span> passwordKey = <span class="hljs-keyword">await</span> crypto.subtle.importKey(
  <span class="hljs-string">'raw'</span>,
  <span class="hljs-keyword">new</span> TextEncoder().encode(password),
  derivationAlg,
  <span class="hljs-comment">/* extractable: */</span> <span class="hljs-literal">false</span>,
  [<span class="hljs-string">'deriveKey'</span>]
);
<span class="hljs-keyword">const</span> nonce = crypto.getRandomValues(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">16</span>));
<span class="hljs-keyword">const</span> derivationParams =
  derivationAlg === <span class="hljs-string">'Argon2id'</span> ?
    {
      nonce,
      <span class="hljs-attr">parallelism</span>: <span class="hljs-number">4</span>,
      <span class="hljs-attr">memory</span>: <span class="hljs-number">2</span> ** <span class="hljs-number">21</span>,
      <span class="hljs-attr">passes</span>: <span class="hljs-number">1</span>
    } :
    {
      <span class="hljs-attr">salt</span>: nonce,
      <span class="hljs-attr">iterations</span>: <span class="hljs-number">100_000</span>,
      <span class="hljs-attr">hash</span>: <span class="hljs-string">'SHA-256'</span>
    };
<span class="hljs-keyword">const</span> key = <span class="hljs-keyword">await</span> crypto.subtle.deriveKey(
  {
    <span class="hljs-attr">name</span>: derivationAlg,
    ...derivationParams
  },
  passwordKey,
  {
    <span class="hljs-attr">name</span>: encryptionAlg,
    <span class="hljs-attr">length</span>: <span class="hljs-number">256</span>
  },
  <span class="hljs-comment">/* extractable: */</span> <span class="hljs-literal">false</span>,
  [<span class="hljs-string">'encrypt'</span>, <span class="hljs-string">'decrypt'</span>]
);
<span class="hljs-keyword">const</span> plaintext = <span class="hljs-string">'Hello, world!'</span>;
<span class="hljs-keyword">const</span> iv = crypto.getRandomValues(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">16</span>));
<span class="hljs-keyword">const</span> encrypted = <span class="hljs-keyword">await</span> crypto.subtle.encrypt(
  { <span class="hljs-attr">name</span>: encryptionAlg, iv },
  key,
  <span class="hljs-keyword">new</span> TextEncoder().encode(plaintext)
);
<span class="hljs-comment">// Store the derivation and encryption algorithm and parameters</span>
<span class="hljs-comment">// as well as the ciphertext (e.g. in IndexedDB or a database),</span>
<span class="hljs-comment">// and retrieve them later. Then, derive the key using the</span>
<span class="hljs-comment">// original parameters and the password. Here we immediately</span>
<span class="hljs-comment">// use the same key object to decrypt again.</span>
<span class="hljs-keyword">const</span> decrypted = <span class="hljs-keyword">new</span> TextDecoder().decode(<span class="hljs-keyword">await</span> crypto.subtle.decrypt(
  { <span class="hljs-attr">name</span>: encryptionAlg, iv },
  key,
  encrypted
));</code></pre>
      </div>
  </section>

  <section id="jwk-mapping" class="appendix informative"><div class="header-wrapper"><h2 id="a-mapping-between-json-web-key-json-web-algorithm"><bdi class="secno">A. </bdi>Mapping between JSON Web Key / JSON Web Algorithm</h2><a class="self-link" href="#jwk-mapping" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
    
    <p>
      Refer to algorithm-specific sections for the
      normative requirements of importing and exporting JWK.
    </p>
    <section id="algorithm-mappings"><div class="header-wrapper"><h3 id="a-1-algorithm-mappings"><bdi class="secno">A.1 </bdi>Algorithm mappings</h3><a class="self-link" href="#algorithm-mappings" aria-label="Permalink for Appendix A.1"></a></div>
    <table>
      <thead>
        <tr>
          <th scope="col">JSON Web Key</th>
          <th scope="col">AlgorithmIdentifier</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"A128OCB"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-OCB"</span>,
<span class="hljs-attr">length</span>: <span class="hljs-number">128</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"A192OCB"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-OCB"</span>,
<span class="hljs-attr">length</span>: <span class="hljs-number">192</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"A256OCB"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-OCB"</span>,
<span class="hljs-attr">length</span>: <span class="hljs-number">256</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"CC20P1305"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"ChaCha20-Poly1305"</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"K128"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"KMAC128"</span> }</code></pre>
          </td>
        </tr>
        <tr>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">kty</span>: <span class="hljs-string">"oct"</span>,
<span class="hljs-attr">alg</span>: <span class="hljs-string">"K256"</span> }</code></pre>
          </td>
          <td>
<pre aria-busy="false"><code class="hljs js">{ <span class="hljs-attr">name</span>: <span class="hljs-string">"KMAC256"</span> }</code></pre>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="todo">TODO: register A128OCB, A192OCB, A256OCB, CC20P1305, K128 and K256(?) with IANA in the JSON Web Signature and Encryption Algorithms registry.</div>
  </section></section>

  <section id="conformance"><div class="header-wrapper"><h2 id="b-conformance"><bdi class="secno">B. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section B."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key word <em class="rfc2119">MUST</em> in this document
        is to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="c-references"><bdi class="secno">C. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix C."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="c-1-normative-references"><bdi class="secno">C.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix C.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-fips-202">[FIPS-202]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf"><cite>SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions</cite></a>.  NIST. August 2015. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>
    </dd><dt id="bib-infra">[infra]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-jwa">[JWA]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7518"><cite>JSON Web Algorithms (JWA)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7518">https://www.rfc-editor.org/rfc/rfc7518</a>
    </dd><dt id="bib-jwk">[JWK]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-nist-sp800-185">[NIST-SP800-185]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf"><cite>NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash</cite></a>.  NIST. December 2016. URL: <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc7253">[RFC7253]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7253"><cite>The OCB Authenticated-Encryption Algorithm</cite></a>. T. Krovetz; P. Rogaway.  IETF. May 2014. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc7253">https://www.rfc-editor.org/rfc/rfc7253</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8439">[RFC8439]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8439"><cite>ChaCha20 and Poly1305 for IETF Protocols</cite></a>. Y. Nir; A. Langley.  IETF. June 2018. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8439">https://www.rfc-editor.org/rfc/rfc8439</a>
    </dd><dt id="bib-rfc9106">[RFC9106]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9106"><cite>Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications</cite></a>. A. Biryukov; D. Dinu; D. Khovratovich; S. Josefsson.  IETF. September 2021. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc9106">https://www.rfc-editor.org/rfc/rfc9106</a>
    </dd><dt id="bib-webcryptoapi">[WebCryptoAPI]</dt><dd>
      <a href="https://www.w3.org/TR/WebCryptoAPI/"><cite>Web Cryptography API</cite></a>. Mark Watson.  W3C. 26 January 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/WebCryptoAPI/">https://www.w3.org/TR/WebCryptoAPI/</a>
    </dd><dt id="bib-webidl">[WebIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-octet-string" aria-label="Links in this document to definition: octet string">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-octet-string" aria-label="Permalink for definition: octet string. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-octet-string-1" title="§ 5.4 Operations">§ 5.4 Operations</a> <a href="#ref-for-dfn-octet-string-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-octet-string-3" title="§ 6.3 Operations">§ 6.3 Operations</a> <a href="#ref-for-dfn-octet-string-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-octet-string-5" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-dfn-octet-string-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-concept-contents-of-arraybuffer" aria-label="Links in this document to definition: contents of an ArrayBuffer">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#concept-contents-of-arraybuffer" aria-label="Permalink for definition: contents of an ArrayBuffer. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-concept-contents-of-arraybuffer-1" title="§ 5.4 Operations">§ 5.4 Operations</a> <a href="#ref-for-concept-contents-of-arraybuffer-2" title="Reference 2">(2)</a> <a href="#ref-for-concept-contents-of-arraybuffer-3" title="Reference 3">(3)</a> <a href="#ref-for-concept-contents-of-arraybuffer-4" title="Reference 4">(4)</a> <a href="#ref-for-concept-contents-of-arraybuffer-5" title="Reference 5">(5)</a> <a href="#ref-for-concept-contents-of-arraybuffer-6" title="Reference 6">(6)</a> <a href="#ref-for-concept-contents-of-arraybuffer-7" title="Reference 7">(7)</a> <a href="#ref-for-concept-contents-of-arraybuffer-8" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-concept-contents-of-arraybuffer-9" title="§ 6.3 Operations">§ 6.3 Operations</a> <a href="#ref-for-concept-contents-of-arraybuffer-10" title="Reference 2">(2)</a> <a href="#ref-for-concept-contents-of-arraybuffer-11" title="Reference 3">(3)</a> <a href="#ref-for-concept-contents-of-arraybuffer-12" title="Reference 4">(4)</a> <a href="#ref-for-concept-contents-of-arraybuffer-13" title="Reference 5">(5)</a> <a href="#ref-for-concept-contents-of-arraybuffer-14" title="Reference 6">(6)</a> <a href="#ref-for-concept-contents-of-arraybuffer-15" title="Reference 7">(7)</a> <a href="#ref-for-concept-contents-of-arraybuffer-16" title="Reference 8">(8)</a> 
    </li><li>
      <a href="#ref-for-concept-contents-of-arraybuffer-17" title="§ 8.4 Operations">§ 8.4 Operations</a> <a href="#ref-for-concept-contents-of-arraybuffer-18" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-concept-contents-of-arraybuffer-19" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-concept-contents-of-arraybuffer-20" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-concept-contents-of-arraybuffer-21" title="§ 10.4 Operations">§ 10.4 Operations</a> <a href="#ref-for-concept-contents-of-arraybuffer-22" title="Reference 2">(2)</a> <a href="#ref-for-concept-contents-of-arraybuffer-23" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-supports" aria-label="Links in this document to definition: supports(operation, algorithm, length)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-supports" aria-label="Permalink for definition: supports(operation, algorithm, length). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1336939281">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-supports-1" title="§ 1. Introduction">§ 1. Introduction</a> 
    </li><li>
      <a href="#ref-for-dfn-SubtleCrypto-method-supports-2" title="§ 4. Partial SubtleCrypto interface">§ 4. Partial SubtleCrypto interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-SubtleCrypto-method-supports-additionalAlgorithm" aria-label="Links in this document to definition: supports(operation, algorithm, additionalAlgorithm)">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-SubtleCrypto-method-supports-additionalAlgorithm" aria-label="Permalink for definition: supports(operation, algorithm, additionalAlgorithm). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1336939281">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-SubtleCrypto-method-supports-additionalAlgorithm-1" title="§ 4. Partial SubtleCrypto interface">§ 4. Partial SubtleCrypto interface</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-check-support-for-algorithm" aria-label="Links in this document to definition: check support for an algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-check-support-for-algorithm" aria-label="Permalink for definition: check support for an algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-check-support-for-algorithm-1" title="§ 4.1.1 The supports method">§ 4.1.1 The supports method</a> <a href="#ref-for-dfn-check-support-for-algorithm-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-check-support-for-algorithm-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-check-support-for-algorithm-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-check-support-for-algorithm-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-check-support-for-algorithm-6" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-check-support-for-algorithm-7" title="§ 4.2 Checking support for an algorithm">§ 4.2 Checking support for an algorithm</a> <a href="#ref-for-dfn-check-support-for-algorithm-8" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams" aria-label="Links in this document to definition: AeadParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams" aria-label="Permalink for definition: AeadParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-1" title="§ 5.2 Registration">§ 5.2 Registration</a> <a href="#ref-for-dfn-AeadParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-3" title="§ 5.3 AeadParams dictionary">§ 5.3 AeadParams dictionary</a> <a href="#ref-for-dfn-AeadParams-4" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-5" title="§ 6.2 Registration">§ 6.2 Registration</a> <a href="#ref-for-dfn-AeadParams-6" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams-iv" aria-label="Links in this document to definition: iv">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams-iv" aria-label="Permalink for definition: iv. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-iv-1" title="§ 5.3 AeadParams dictionary">§ 5.3 AeadParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-iv-2" title="§ 5.4 Operations">§ 5.4 Operations</a> <a href="#ref-for-dfn-AeadParams-iv-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-AeadParams-iv-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-AeadParams-iv-5" title="Reference 4">(4)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-iv-6" title="§ 6.3 Operations">§ 6.3 Operations</a> <a href="#ref-for-dfn-AeadParams-iv-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-AeadParams-iv-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-AeadParams-iv-9" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams-additionalData" aria-label="Links in this document to definition: additionalData">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams-additionalData" aria-label="Permalink for definition: additionalData. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-additionalData-1" title="§ 5.3 AeadParams dictionary">§ 5.3 AeadParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-additionalData-2" title="§ 5.4 Operations">§ 5.4 Operations</a> <a href="#ref-for-dfn-AeadParams-additionalData-3" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-additionalData-4" title="§ 6.3 Operations">§ 6.3 Operations</a> <a href="#ref-for-dfn-AeadParams-additionalData-5" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-AeadParams-tagLength" aria-label="Links in this document to definition: tagLength">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-AeadParams-tagLength" aria-label="Permalink for definition: tagLength. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1353594407">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-AeadParams-tagLength-1" title="§ 5.3 AeadParams dictionary">§ 5.3 AeadParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-tagLength-2" title="§ 5.4 Operations">§ 5.4 Operations</a> <a href="#ref-for-dfn-AeadParams-tagLength-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-AeadParams-tagLength-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-AeadParams-tagLength-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-AeadParams-tagLength-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-AeadParams-tagLength-7" title="Reference 6">(6)</a> 
    </li><li>
      <a href="#ref-for-dfn-AeadParams-tagLength-8" title="§ 6.3 Operations">§ 6.3 Operations</a> <a href="#ref-for-dfn-AeadParams-tagLength-9" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams" aria-label="Links in this document to definition: CShakeParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams" aria-label="Permalink for definition: CShakeParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-1" title="§ 8.2 Registration">§ 8.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-2" title="§ 8.3 CShakeParams dictionary">§ 8.3 CShakeParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-length-1" title="§ 8.3 CShakeParams dictionary">§ 8.3 CShakeParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-length-2" title="§ 8.4 Operations">§ 8.4 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams-functionName" aria-label="Links in this document to definition: functionName">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams-functionName" aria-label="Permalink for definition: functionName. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-functionName-1" title="§ 8.3 CShakeParams dictionary">§ 8.3 CShakeParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-functionName-2" title="§ 8.4 Operations">§ 8.4 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-CShakeParams-customization" aria-label="Links in this document to definition: customization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-CShakeParams-customization" aria-label="Permalink for definition: customization. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1097481639">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-CShakeParams-customization-1" title="§ 8.3 CShakeParams dictionary">§ 8.3 CShakeParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-CShakeParams-customization-2" title="§ 8.4 Operations">§ 8.4 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyGenParams" aria-label="Links in this document to definition: KmacKeyGenParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyGenParams" aria-label="Permalink for definition: KmacKeyGenParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1224700284">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyGenParams-1" title="§ 9.2 Registration">§ 9.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyGenParams-2" title="§ 9.3 KmacKeyGenParams dictionary">§ 9.3 KmacKeyGenParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyGenParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyGenParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1224700284">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyGenParams-length-1" title="§ 9.3 KmacKeyGenParams dictionary">§ 9.3 KmacKeyGenParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyGenParams-length-2" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-dfn-KmacKeyGenParams-length-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacImportParams" aria-label="Links in this document to definition: KmacImportParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacImportParams" aria-label="Permalink for definition: KmacImportParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-745655368">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacImportParams-1" title="§ 9.2 Registration">§ 9.2 Registration</a> <a href="#ref-for-dfn-KmacImportParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacImportParams-3" title="§ 9.4 KmacImportParams dictionary">§ 9.4 KmacImportParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacImportParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacImportParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-745655368">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacImportParams-length-1" title="§ 9.4 KmacImportParams dictionary">§ 9.4 KmacImportParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacImportParams-length-2" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-dfn-KmacImportParams-length-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-KmacImportParams-length-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-KmacImportParams-length-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-KmacImportParams-length-6" title="Reference 5">(5)</a> <a href="#ref-for-dfn-KmacImportParams-length-7" title="Reference 6">(6)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyAlgorithm" aria-label="Links in this document to definition: KmacKeyAlgorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyAlgorithm" aria-label="Permalink for definition: KmacKeyAlgorithm. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-28722634">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-1" title="§ 9.5 KmacKeyAlgorithm dictionary">§ 9.5 KmacKeyAlgorithm dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-2" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-dfn-KmacKeyAlgorithm-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacKeyAlgorithm-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacKeyAlgorithm-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-28722634">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-length-1" title="§ 9.5 KmacKeyAlgorithm dictionary">§ 9.5 KmacKeyAlgorithm dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacKeyAlgorithm-length-2" title="§ 9.7 Operations">§ 9.7 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacParams" aria-label="Links in this document to definition: KmacParams">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacParams" aria-label="Permalink for definition: KmacParams. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1848208597">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacParams-1" title="§ 9.2 Registration">§ 9.2 Registration</a> <a href="#ref-for-dfn-KmacParams-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-3" title="§ 9.6 KmacParams dictionary">§ 9.6 KmacParams dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacParams-length" aria-label="Links in this document to definition: length">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacParams-length" aria-label="Permalink for definition: length. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1848208597">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacParams-length-1" title="§ 9.6 KmacParams dictionary">§ 9.6 KmacParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-length-2" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-dfn-KmacParams-length-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-KmacParams-length-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-KmacParams-length-5" title="Reference 4">(4)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-KmacParams-customization" aria-label="Links in this document to definition: customization">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-KmacParams-customization" aria-label="Permalink for definition: customization. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1848208597">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-KmacParams-customization-1" title="§ 9.6 KmacParams dictionary">§ 9.6 KmacParams dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-KmacParams-customization-2" title="§ 9.7 Operations">§ 9.7 Operations</a> <a href="#ref-for-dfn-KmacParams-customization-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params" aria-label="Links in this document to definition: Argon2Params">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params" aria-label="Permalink for definition: Argon2Params. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-1" title="§ 10.2 Registration">§ 10.2 Registration</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-2" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-nonce" aria-label="Links in this document to definition: nonce">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-nonce" aria-label="Permalink for definition: nonce. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-nonce-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-nonce-2" title="§ 10.4 Operations">§ 10.4 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-parallelism" aria-label="Links in this document to definition: parallelism">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-parallelism" aria-label="Permalink for definition: parallelism. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-parallelism-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-parallelism-2" title="§ 10.4 Operations">§ 10.4 Operations</a> <a href="#ref-for-dfn-Argon2Params-parallelism-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-Argon2Params-parallelism-4" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-memory" aria-label="Links in this document to definition: memory">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-memory" aria-label="Permalink for definition: memory. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-memory-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-memory-2" title="§ 10.4 Operations">§ 10.4 Operations</a> <a href="#ref-for-dfn-Argon2Params-memory-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-passes" aria-label="Links in this document to definition: passes">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-passes" aria-label="Permalink for definition: passes. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-passes-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-passes-2" title="§ 10.4 Operations">§ 10.4 Operations</a> <a href="#ref-for-dfn-Argon2Params-passes-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-version" aria-label="Links in this document to definition: version">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-version" aria-label="Permalink for definition: version. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-version-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-version-2" title="§ 10.4 Operations">§ 10.4 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-secretValue" aria-label="Links in this document to definition: secretValue">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-secretValue" aria-label="Permalink for definition: secretValue. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-secretValue-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-secretValue-2" title="§ 10.4 Operations">§ 10.4 Operations</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-Argon2Params-associatedData" aria-label="Links in this document to definition: associatedData">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-Argon2Params-associatedData" aria-label="Permalink for definition: associatedData. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1006558199">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-Argon2Params-associatedData-1" title="§ 10.3 Argon2Params dictionary">§ 10.3 Argon2Params dictionary</a> 
    </li><li>
      <a href="#ref-for-dfn-Argon2Params-associatedData-2" title="§ 10.4 Operations">§ 10.4 Operations</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>